schema: '2.0'
stages:
  data_download_pancreas:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pancreas]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
  preprocess_pancreas:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pancreas]
    deps:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/processed/pancreas_processed.h5ad
      md5: 7af1dfb39e8d77008a94b1c17c9c3858
      size: 424767328
  train_pancreas_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model1]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 7af1dfb39e8d77008a94b1c17c9c3858
      size: 424767328
    - path: train.py
      md5: 82c7d592259acee27c30bdfb5abe1414
      size: 7924
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
    outs:
    - path: models/pancreas_model1/loss_plot.png
      md5: e6b040025b46593fd9676e3d1a47a69f
      size: 12367
    - path: models/pancreas_model1/metrics.json
      md5: fb4f7d8b8f29a0a0f99dbbf32b4e23d6
      size: 156
    - path: models/pancreas_model1/model
      md5: 631b8571669ff6e6f5289920990ec84f.dir
      size: 1159230
      nfiles: 4
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 0543be5444d65de81d16b5d82fbd7a11
      size: 7102321859
    - path: models/pancreas_model1/run_info.json
      md5: 7d48748bc525a065e1b8e8bfbcad0d86
      size: 436
    - path: models/pancreas_model1/trained.h5ad
      md5: f356554ccb853fe47f564701072c8482
      size: 489752168
  data_download_pbmc68k:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pbmc68k]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
  preprocess_pbmc68k:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pbmc68k]
    deps:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 8833461e46bfb395df94f22b1cd02f2e
      size: 1890403966
  train_pbmc68k_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model1]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 8833461e46bfb395df94f22b1cd02f2e
      size: 1890403966
    - path: train.py
      md5: 82c7d592259acee27c30bdfb5abe1414
      size: 7924
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
    outs:
    - path: models/pbmc68k_model1/loss_plot.png
      md5: 7fab7cccb5cfc0381f40651a612cedf7
      size: 18167
    - path: models/pbmc68k_model1/metrics.json
      md5: ab5033bd49ee3c790cac3d47cf6e48ef
      size: 156
    - path: models/pbmc68k_model1/model
      md5: b3880de31516ff7f6a5bbe9e638d78b3.dir
      size: 3384309
      nfiles: 4
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: 6ca1631a7a0e54bb448f333b35f1a9aa
      size: 27836354015
    - path: models/pbmc68k_model1/run_info.json
      md5: 1ccf68b9d248ba3956d4b34cc7654c97
      size: 435
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 853666ff9527ae7f13b96612f05da241
      size: 2461828643
  figure2:
    cmd: python fig2/figure.py
    deps:
    - path: fig2/figure.py
      md5: 6080212435b6cac4ad93d84f67109fb6
      size: 19258
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 0543be5444d65de81d16b5d82fbd7a11
      size: 7102321859
    - path: models/pancreas_model1/trained.h5ad
      md5: f356554ccb853fe47f564701072c8482
      size: 489752168
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: 6ca1631a7a0e54bb448f333b35f1a9aa
      size: 27836354015
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 853666ff9527ae7f13b96612f05da241
      size: 2461828643
    params:
      config.yaml:
        reports.figure2:
          tag: fig2
          path: reports/fig2
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf
          pancreas_model1:
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_markers_phaseportrait.pdf
      md5: d1d703b6dee0b530d350df34c6fb3026
      size: 4547804
    - path: reports/fig2/fig2_markers_selection_scatterplot.tif
      md5: ed4e8ae60f17d8091ded682e38142a52
      size: 6101990
    - path: reports/fig2/fig2_param_uncertainties.pdf
      md5: b63cf59b4c47db4e3a0f3679819c04a4
      size: 80208
    - path: reports/fig2/fig2_raw_gene_selection_model1.svg
      md5: 11ae0af7b9936511cdda7cb6173cefc9
      size: 49470030
    - path: reports/fig2/fig2_raw_gene_selection_model1.tif
      md5: c979f5a6c499af7fdca4af757a2c6d4c
      size: 19732046
  plot_pancreas_model1:
    cmd: python fig2/fig2_pancreas_plot.py
    deps:
    - path: fig2/fig2_pancreas_plot.py
      md5: f0886a59e8ad697ddf7e9afa24d97d5d
      size: 5805
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 0543be5444d65de81d16b5d82fbd7a11
      size: 7102321859
    - path: models/pancreas_model1/trained.h5ad
      md5: f356554ccb853fe47f564701072c8482
      size: 489752168
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.figure2.pancreas_model1:
          shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
          volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
          rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
          vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_pancreas_rainbow.pdf
      md5: 5101f8851becc3e9bdd4dae913002cdd
      size: 660882
    - path: reports/fig2/fig2_pancreas_shared_time.pdf
      md5: bd9c535bd1a2a47eab893b76c66f5cd7
      size: 624140
    - path: reports/fig2/fig2_pancreas_vector_field.pdf
      md5: 79427fbd111585720f14df0d211f2616
      size: 407951
    - path: reports/fig2/fig2_pancreas_volcano.pdf
      md5: 91b10879f0fe35b942e2ef393e538d45
      size: 47004
  data_download_larry:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry:
          data_file: larry.h5ad
          dl_root: data/external
          dl_path: data/external/larry.h5ad
          rel_path: data/external/larry.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: ''
            process_args: {}
            rel_path: data/processed/larry_processed.h5ad
    outs:
    - path: data/external/larry.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
  train_pancreas_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model2]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 7af1dfb39e8d77008a94b1c17c9c3858
      size: 424767328
    - path: train.py
      md5: 82c7d592259acee27c30bdfb5abe1414
      size: 7924
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
    outs:
    - path: models/pancreas_model2/loss_plot.png
      md5: 5eae442d5d4a4f3dd3b1e58f1abdac22
      size: 12183
    - path: models/pancreas_model2/metrics.json
      md5: 10f993ddedb355909388c557452809c6
      size: 155
    - path: models/pancreas_model2/model
      md5: b919de92e4939d9f6e5108d908a085bc.dir
      size: 1735217
      nfiles: 4
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 439bf1f7442d078e2ab76ccfd8944cbe
      size: 6216001966
    - path: models/pancreas_model2/run_info.json
      md5: 2fce72e55383a3e4d8544e39973ac6bd
      size: 436
    - path: models/pancreas_model2/trained.h5ad
      md5: adc4adf43682e215ded3974b57abad44
      size: 489752168
  train_pbmc68k_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model2]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 8833461e46bfb395df94f22b1cd02f2e
      size: 1890403966
    - path: train.py
      md5: 82c7d592259acee27c30bdfb5abe1414
      size: 7924
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
    outs:
    - path: models/pbmc68k_model2/loss_plot.png
      md5: d9e5a09bcde6622ce312cc44f1623a0f
      size: 16107
    - path: models/pbmc68k_model2/metrics.json
      md5: 69693cd033e0b42927bf62f990c8879e
      size: 156
    - path: models/pbmc68k_model2/model
      md5: dd319603edbd20d8371c11b2f534d543.dir
      size: 3510631
      nfiles: 4
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: f58cd6cadb67e55ed0ad777095a02e3b
      size: 24366111782
    - path: models/pbmc68k_model2/run_info.json
      md5: ad61bafce114dc4d237750039b0f9e21
      size: 435
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 742815f11dd23fd5ccfbcac0b07b89b7
      size: 2461836835
  figureS3:
    cmd: python figS3/figure.py
    deps:
    - path: figS3/figure.py
      md5: 60c9ae103d128bd148c505fb92572cc3
      size: 12699
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 439bf1f7442d078e2ab76ccfd8944cbe
      size: 6216001966
    - path: models/pancreas_model2/trained.h5ad
      md5: adc4adf43682e215ded3974b57abad44
      size: 489752168
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: f58cd6cadb67e55ed0ad777095a02e3b
      size: 24366111782
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 742815f11dd23fd5ccfbcac0b07b89b7
      size: 2461836835
    params:
      config.yaml:
        reports.figureS3:
          tag: figS3
          path: reports/figS3
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg
    outs:
    - path: reports/figS3/figS3_raw_gene_selection_model2.svg
      md5: edd264a8f83bca78f9956f784a2f8a7b
      size: 49456029
    - path: reports/figS3/figS3_raw_gene_selection_model2.tif
      md5: 4d6596af91c9a4b15ec776f4df439739
      size: 19533902
  data_download_pons:
    cmd: python data_download.py data_external.sources=[velocyto] data_external.velocyto.download=[pons]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
  preprocess_pons:
    cmd: python preprocess.py data_external.sources=[velocyto] data_external.velocyto.process=[pons]
    deps:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/processed/pons_processed.h5ad
      md5: 068b9403c6855b03b6593953946aa850
      size: 740973882
  train_pons_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model1]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 068b9403c6855b03b6593953946aa850
      size: 740973882
    - path: train.py
      md5: 82c7d592259acee27c30bdfb5abe1414
      size: 7924
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
    outs:
    - path: models/pons_model1/loss_plot.png
      md5: 5075d8bf3c37452961864bb7b64d0e08
      size: 12477
    - path: models/pons_model1/metrics.json
      md5: 42f7b54b2b536e19b7c26025732f490c
      size: 154
    - path: models/pons_model1/model
      md5: bf917ec91aa9ffe9b91539e4cbf01cbd.dir
      size: 1281540
      nfiles: 4
    - path: models/pons_model1/pyrovelocity.pkl
      md5: ae17dbfe1664aca1b6214d1b0e51099d
      size: 12014584796
    - path: models/pons_model1/run_info.json
      md5: 639eb9039a12dffed960bce97c4a4581
      size: 432
    - path: models/pons_model1/trained.h5ad
      md5: 0bd19c893358b7b1a5960cd79ddc0533
      size: 855657974
  train_pons_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model2]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 068b9403c6855b03b6593953946aa850
      size: 740973882
    - path: train.py
      md5: 82c7d592259acee27c30bdfb5abe1414
      size: 7924
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
    outs:
    - path: models/pons_model2/loss_plot.png
      md5: 98da8b480e250d473a6136dd4777c2f6
      size: 12081
    - path: models/pons_model2/metrics.json
      md5: 8d558845e8b6703c1f8fe938ea285bdd
      size: 156
    - path: models/pons_model2/model
      md5: 4eb3aeda4156da1fa56f9cff4da05f09.dir
      size: 1857460
      nfiles: 4
    - path: models/pons_model2/pyrovelocity.pkl
      md5: 9d5e27944812a8ac0b30aa609bbca0f9
      size: 10514584903
    - path: models/pons_model2/run_info.json
      md5: e1d477c585ef8277d95b0f9b1bf97ab0
      size: 432
    - path: models/pons_model2/trained.h5ad
      md5: 5a1f0ede0dc8a6bf26b2ae9a88e86c60
      size: 855656950
  summarize_pancreas_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model1]
    deps:
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 0543be5444d65de81d16b5d82fbd7a11
      size: 7102321859
    - path: models/pancreas_model1/trained.h5ad
      md5: f356554ccb853fe47f564701072c8482
      size: 489752168
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.model_summary.pancreas_model1:
          path: reports/pancreas_model1
          shared_time_plot: reports/pancreas_model1/shared_time.pdf
          volcano_plot: reports/pancreas_model1/volcano.pdf
          rainbow_plot: reports/pancreas_model1/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model1/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pancreas_model1/rainbow.pdf
      md5: 62ba95653cf45eec6858e715ef2f9b7c
      size: 660939
    - path: reports/pancreas_model1/rainbow.pdf.png
      md5: ab8df794f3ccda714058938ba08399dc
      size: 924556
    - path: reports/pancreas_model1/vector_field.pdf
      md5: d6eb64ec759efb4c47f5376e4ad666be
      size: 397587
    - path: reports/pancreas_model1/vector_field.pdf.png
      md5: df1f17c578e1a8b7ab540e8c938a06ac
      size: 701589
    - path: reports/pancreas_model1/volcano.pdf
      md5: f07905892bc4736f6acc5c7c58eb7a72
      size: 46993
  summarize_pancreas_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model2]
    deps:
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 439bf1f7442d078e2ab76ccfd8944cbe
      size: 6216001966
    - path: models/pancreas_model2/trained.h5ad
      md5: adc4adf43682e215ded3974b57abad44
      size: 489752168
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
        reports.model_summary.pancreas_model2:
          path: reports/pancreas_model2
          shared_time_plot: reports/pancreas_model2/shared_time.pdf
          volcano_plot: reports/pancreas_model2/volcano.pdf
          rainbow_plot: reports/pancreas_model2/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model2/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pancreas_model2/rainbow.pdf
      md5: d5d68390e0a42f3161343a5fd5c76ff8
      size: 674040
    - path: reports/pancreas_model2/rainbow.pdf.png
      md5: 6ee9f9d7356916d99c916f154b4bfafe
      size: 1603420
    - path: reports/pancreas_model2/vector_field.pdf
      md5: a0c1135de991e2c373ecd21ec619b8d1
      size: 397568
    - path: reports/pancreas_model2/vector_field.pdf.png
      md5: 41bd83dca5e74c9ce0c2fd9e4fcffe53
      size: 698968
    - path: reports/pancreas_model2/volcano.pdf
      md5: 6f758b3822f7a80a9b7f6b9dd65e7483
      size: 47994
  summarize_pbmc68k_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model1]
    deps:
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: 6ca1631a7a0e54bb448f333b35f1a9aa
      size: 27836354015
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 853666ff9527ae7f13b96612f05da241
      size: 2461828643
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
        reports.model_summary.pbmc68k_model1:
          path: reports/pbmc68k_model1
          shared_time_plot: reports/pbmc68k_model1/shared_time.pdf
          volcano_plot: reports/pbmc68k_model1/volcano.pdf
          rainbow_plot: reports/pbmc68k_model1/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model1/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pbmc68k_model1/rainbow.pdf
      md5: f5deceab13f6493dcc53ddb9dc882a86
      size: 11137957
    - path: reports/pbmc68k_model1/rainbow.pdf.png
      md5: 602e9173f515727e7d359a787981f57b
      size: 1763923
    - path: reports/pbmc68k_model1/vector_field.pdf
      md5: 2f95c3bcf106f5b722aafcccb69f4205
      size: 1033545
    - path: reports/pbmc68k_model1/vector_field.pdf.png
      md5: 4ed286418bc1fac6d8ff60abcd05a0cc
      size: 1196529
    - path: reports/pbmc68k_model1/volcano.pdf
      md5: 97eb5fb07a12f4d4ed888d8dd0f6261e
      size: 24677
  summarize_pbmc68k_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model2]
    deps:
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: f58cd6cadb67e55ed0ad777095a02e3b
      size: 24366111782
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 742815f11dd23fd5ccfbcac0b07b89b7
      size: 2461836835
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
        reports.model_summary.pbmc68k_model2:
          path: reports/pbmc68k_model2
          shared_time_plot: reports/pbmc68k_model2/shared_time.pdf
          volcano_plot: reports/pbmc68k_model2/volcano.pdf
          rainbow_plot: reports/pbmc68k_model2/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model2/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pbmc68k_model2/rainbow.pdf
      md5: b25a2e5c107da99cd9ee9797f4bff048
      size: 11400995
    - path: reports/pbmc68k_model2/rainbow.pdf.png
      md5: 8e9997d9b3d31326522b1a00f2afdcd2
      size: 2265543
    - path: reports/pbmc68k_model2/vector_field.pdf
      md5: 7014be19b5a0ca52d14729aab1577054
      size: 1033595
    - path: reports/pbmc68k_model2/vector_field.pdf.png
      md5: 51da58ab557cde078f50348dcdbc8c76
      size: 1196476
    - path: reports/pbmc68k_model2/volcano.pdf
      md5: 52a0caf238c0d57f8bdb4e202a83d61d
      size: 24695
  summarize_pons_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model1]
    deps:
    - path: models/pons_model1/pyrovelocity.pkl
      md5: ae17dbfe1664aca1b6214d1b0e51099d
      size: 12014584796
    - path: models/pons_model1/trained.h5ad
      md5: 0bd19c893358b7b1a5960cd79ddc0533
      size: 855657974
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
        reports.model_summary.pons_model1:
          path: reports/pons_model1
          shared_time_plot: reports/pons_model1/shared_time.pdf
          volcano_plot: reports/pons_model1/volcano.pdf
          rainbow_plot: reports/pons_model1/rainbow.pdf
          uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf
          vector_field_plot: reports/pons_model1/vector_field.pdf
          biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pons_model1/rainbow.pdf
      md5: 355ed642a1d0c4c15fa5bab13b28dd67
      size: 1065768
    - path: reports/pons_model1/rainbow.pdf.png
      md5: 23348d0bfcb0b5126ad0682a8411c24f
      size: 786428
    - path: reports/pons_model1/vector_field.pdf
      md5: 306171c2eabc18e9fdaced9d112b050c
      size: 377030
    - path: reports/pons_model1/vector_field.pdf.png
      md5: 8db45674194318d7c379c0e4542bbf48
      size: 798327
    - path: reports/pons_model1/volcano.pdf
      md5: ba51afe4f6f148a7803602dc08faff9f
      size: 48529
  summarize_pons_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model2]
    deps:
    - path: models/pons_model2/pyrovelocity.pkl
      md5: 9d5e27944812a8ac0b30aa609bbca0f9
      size: 10514584903
    - path: models/pons_model2/trained.h5ad
      md5: 5a1f0ede0dc8a6bf26b2ae9a88e86c60
      size: 855656950
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
        reports.model_summary.pons_model2:
          path: reports/pons_model2
          shared_time_plot: reports/pons_model2/shared_time.pdf
          volcano_plot: reports/pons_model2/volcano.pdf
          rainbow_plot: reports/pons_model2/rainbow.pdf
          uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf
          vector_field_plot: reports/pons_model2/vector_field.pdf
          biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pons_model2/rainbow.pdf
      md5: 4e8b725989a468209f76832d3a9a0cf6
      size: 1079531
    - path: reports/pons_model2/rainbow.pdf.png
      md5: d5bc05f1e04f4af236e06337e616394c
      size: 966969
    - path: reports/pons_model2/vector_field.pdf
      md5: 90315ef222403ee95d723943035feac8
      size: 377056
    - path: reports/pons_model2/vector_field.pdf.png
      md5: 6639c1e7382a2c3051caacb6706396bd
      size: 797853
    - path: reports/pons_model2/volcano.pdf
      md5: 9e5caf050ff72a5d019c6225fcfedf34
      size: 46268
