schema: '2.0'
stages:
  data_download_pancreas:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pancreas]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
  preprocess_pancreas:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pancreas]
    deps:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/processed/pancreas_processed.h5ad
      md5: 442e63eb9e694ac4d5696bf7a6a93ac0
      size: 424775272
  train_pancreas_model1:
    cmd: python train.py model_training.train=[pancreas_model1]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 442e63eb9e694ac4d5696bf7a6a93ac0
      size: 424775272
    - path: train.py
      md5: 73edd290fb71a62721b22a57035cbef6
      size: 7947
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
    outs:
    - path: models/pancreas_model1/loss_plot.png
      md5: 92574c7781f07bea7769485cbb51b8f0
      size: 12280
    - path: models/pancreas_model1/metrics.json
      md5: 444299e5f8a86bc946ccc543e0f71d96
      size: 153
    - path: models/pancreas_model1/model
      md5: 20f727e916113fd3adb4f1302a2d92f4.dir
      size: 1207977
      nfiles: 2
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: e9e0fd374f4a7662ba52fc865ce4ebca
      size: 7102321859
    - path: models/pancreas_model1/run_info.json
      md5: 3232c19491cbc6624049276564d54d3d
      size: 436
    - path: models/pancreas_model1/trained.h5ad
      md5: c8ffba512fbee703c19c5608539e726a
      size: 489882800
  data_download_pbmc68k:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pbmc68k]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
  preprocess_pbmc68k:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pbmc68k]
    deps:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
  train_pbmc68k_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model1]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
    - path: train.py
      md5: 73edd290fb71a62721b22a57035cbef6
      size: 7947
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
    outs:
    - path: models/pbmc68k_model1/loss_plot.png
      md5: b3611aef38768b4c5e8b367bdc297914
      size: 16571
    - path: models/pbmc68k_model1/metrics.json
      md5: ec0a0ca76be6271d0fbd85880f21c7da
      size: 156
    - path: models/pbmc68k_model1/model
      md5: dfbe996721ded7f799d9cb9835d0640d.dir
      size: 3395241
      nfiles: 2
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: e3ae4282578b6ed42668b57f3b236d8a
      size: 27836354015
    - path: models/pbmc68k_model1/run_info.json
      md5: 5cc9766136f269f58ddd7d5d928659ff
      size: 435
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 3dfa83c8a2fde66d371728f9054859ed
      size: 2465547357
  figure2:
    cmd: python fig2/figure.py
    deps:
    - path: fig2/figure.py
      md5: 6080212435b6cac4ad93d84f67109fb6
      size: 19258
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: e9e0fd374f4a7662ba52fc865ce4ebca
      size: 7102321859
    - path: models/pancreas_model1/trained.h5ad
      md5: c8ffba512fbee703c19c5608539e726a
      size: 489882800
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: e3ae4282578b6ed42668b57f3b236d8a
      size: 27836354015
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 3dfa83c8a2fde66d371728f9054859ed
      size: 2465547357
    params:
      config.yaml:
        reports.figure2:
          tag: fig2
          path: reports/fig2
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf
          pancreas_model1:
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_markers_phaseportrait.pdf
      md5: 67cf0c07d44ced42f566083ae6438723
      size: 4548720
    - path: reports/fig2/fig2_markers_selection_scatterplot.tif
      md5: 62e86f3ca93664484d9fbf99c36cd495
      size: 6054758
    - path: reports/fig2/fig2_param_uncertainties.pdf
      md5: f00187107457ef2c1fd38605e53f50c4
      size: 79873
    - path: reports/fig2/fig2_raw_gene_selection_model1.svg
      md5: 9baa38208dce4bc89e8b552145398d40
      size: 49570334
    - path: reports/fig2/fig2_raw_gene_selection_model1.tif
      md5: ff9a17d6489c507a629fdcb8e4153bb5
      size: 19665998
  plot_pancreas_model1:
    cmd: python fig2/fig2_pancreas_plot.py
    deps:
    - path: fig2/fig2_pancreas_plot.py
      md5: f0886a59e8ad697ddf7e9afa24d97d5d
      size: 5805
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: e9e0fd374f4a7662ba52fc865ce4ebca
      size: 7102321859
    - path: models/pancreas_model1/trained.h5ad
      md5: c8ffba512fbee703c19c5608539e726a
      size: 489882800
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.figure2.pancreas_model1:
          shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
          volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
          rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
          vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_pancreas_rainbow.pdf
      md5: 71166f265166affd0555a10b564a3ec4
      size: 673574
    - path: reports/fig2/fig2_pancreas_shared_time.pdf
      md5: 83969b43a2c08bf26a49b32cf98a8012
      size: 659728
    - path: reports/fig2/fig2_pancreas_vector_field.pdf
      md5: 3572809e2a211ee0d40a7d5d333aae3a
      size: 407981
    - path: reports/fig2/fig2_pancreas_volcano.pdf
      md5: 4bb38d304c1f245c037ae2da30b85073
      size: 46757
  data_download_larry:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry:
          data_file: larry.h5ad
          dl_root: data/external
          dl_path: data/external/larry.h5ad
          rel_path: data/external/larry.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: ''
            process_args: {}
            rel_path: data/processed/larry_processed.h5ad
    outs:
    - path: data/external/larry.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
  train_pancreas_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model2]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 442e63eb9e694ac4d5696bf7a6a93ac0
      size: 424775272
    - path: train.py
      md5: 73edd290fb71a62721b22a57035cbef6
      size: 7947
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
    outs:
    - path: models/pancreas_model2/loss_plot.png
      md5: f69371d94149d20a57c7335780e8b3c4
      size: 12221
    - path: models/pancreas_model2/metrics.json
      md5: 6edf317af2cc739f9b4241631fd37235
      size: 154
    - path: models/pancreas_model2/model
      md5: a8a375a534630d46e725bf30b03c7187.dir
      size: 1783913
      nfiles: 2
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 9c87b62ef7d9909e7847fb7e9a77d616
      size: 6216001966
    - path: models/pancreas_model2/run_info.json
      md5: 76684c70507b7eedfdd6a0982a912d31
      size: 436
    - path: models/pancreas_model2/trained.h5ad
      md5: 11fad54dbd76c586469c2788d60c0633
      size: 489882800
  train_pbmc68k_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model2]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
    - path: train.py
      md5: 73edd290fb71a62721b22a57035cbef6
      size: 7947
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
    outs:
    - path: models/pbmc68k_model2/loss_plot.png
      md5: 020f5dba782c1ca953fd078be78ea5e3
      size: 16215
    - path: models/pbmc68k_model2/metrics.json
      md5: 74f9e76061bb2a9618a6098148f0e0c8
      size: 156
    - path: models/pbmc68k_model2/model
      md5: b0975d993d1bd409f6b675af9f7d6d85.dir
      size: 3521705
      nfiles: 2
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 5be9a7d84eb3a4ca1a36eb763635206d
      size: 24366111782
    - path: models/pbmc68k_model2/run_info.json
      md5: c4a04a29894d61d53a81037bb1cfdc71
      size: 435
    - path: models/pbmc68k_model2/trained.h5ad
      md5: d149ed959b9563c39a4c51c9e1bae04a
      size: 2465547357
  figureS3:
    cmd: python figS3/figure.py
    deps:
    - path: figS3/figure.py
      md5: 60c9ae103d128bd148c505fb92572cc3
      size: 12699
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 9c87b62ef7d9909e7847fb7e9a77d616
      size: 6216001966
    - path: models/pancreas_model2/trained.h5ad
      md5: 11fad54dbd76c586469c2788d60c0633
      size: 489882800
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 5be9a7d84eb3a4ca1a36eb763635206d
      size: 24366111782
    - path: models/pbmc68k_model2/trained.h5ad
      md5: d149ed959b9563c39a4c51c9e1bae04a
      size: 2465547357
    params:
      config.yaml:
        reports.figureS3:
          tag: figS3
          path: reports/figS3
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg
    outs:
    - path: reports/figS3/figS3_raw_gene_selection_model2.svg
      md5: 5583398d855401725652f16b2ea4fc2d
      size: 49447858
    - path: reports/figS3/figS3_raw_gene_selection_model2.tif
      md5: f0873ced4962728cca317140e99badb9
      size: 19533902
  data_download_pons:
    cmd: python data_download.py data_external.sources=[velocyto] data_external.velocyto.download=[pons]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
  preprocess_pons:
    cmd: python preprocess.py data_external.sources=[velocyto] data_external.velocyto.process=[pons]
    deps:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
  train_pons_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model1]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
    - path: train.py
      md5: 73edd290fb71a62721b22a57035cbef6
      size: 7947
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
    outs:
    - path: models/pons_model1/loss_plot.png
      md5: b58e7329e8cc7f2d4d68cae8a6afe19d
      size: 12073
    - path: models/pons_model1/metrics.json
      md5: 2f905b5a886f9f89aff647ad7284c427
      size: 154
    - path: models/pons_model1/model
      md5: 4021869db7890c4d8098a3c2fc3638c7.dir
      size: 1330729
      nfiles: 2
    - path: models/pons_model1/pyrovelocity.pkl
      md5: e1f88c8d84a3526c5de540b5e48cb583
      size: 12014584796
    - path: models/pons_model1/run_info.json
      md5: 8b386599c2eb49b8aa9ff84d78e963f6
      size: 432
    - path: models/pons_model1/trained.h5ad
      md5: 60114281e3463f8074a29c5d085fc616
      size: 855745190
  train_pons_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model2]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
    - path: train.py
      md5: 73edd290fb71a62721b22a57035cbef6
      size: 7947
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
    outs:
    - path: models/pons_model2/loss_plot.png
      md5: 4a0ae00f44c012ab0d90fa82d57a11ec
      size: 12093
    - path: models/pons_model2/metrics.json
      md5: bb3c3bf0a3058adaa77e3ce144a3e801
      size: 156
    - path: models/pons_model2/model
      md5: 25955a4ea40823d67b11a8044c351c4b.dir
      size: 1906729
      nfiles: 2
    - path: models/pons_model2/pyrovelocity.pkl
      md5: 00405f5904b25cde4d3ed7975a066c80
      size: 10514584903
    - path: models/pons_model2/run_info.json
      md5: ce37c30ecb2c4ab0e3853fcb9fa10b6a
      size: 432
    - path: models/pons_model2/trained.h5ad
      md5: fb4e9c1b8682e698a668baed84a7f2ec
      size: 855745190
  summarize_pancreas_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model1]
    deps:
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: e9e0fd374f4a7662ba52fc865ce4ebca
      size: 7102321859
    - path: models/pancreas_model1/trained.h5ad
      md5: c8ffba512fbee703c19c5608539e726a
      size: 489882800
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.model_summary.pancreas_model1:
          path: reports/pancreas_model1
          shared_time_plot: reports/pancreas_model1/shared_time.pdf
          volcano_plot: reports/pancreas_model1/volcano.pdf
          rainbow_plot: reports/pancreas_model1/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model1/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pancreas_model1/rainbow.pdf
      md5: d0529b7629925a7c66cb6a415783a38c
      size: 673574
    - path: reports/pancreas_model1/rainbow.pdf.png
      md5: b7d5256461fdce30a32605f72bafd553
      size: 2076300
    - path: reports/pancreas_model1/vector_field.pdf
      md5: 8ef39c127592522ae6ade28df07c3ed7
      size: 397543
    - path: reports/pancreas_model1/vector_field.pdf.png
      md5: 52b32bae85976453665c5f60b5a575bd
      size: 691091
    - path: reports/pancreas_model1/volcano.pdf
      md5: 263881a8e54b91972a01f040333910a7
      size: 46757
  summarize_pancreas_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model2]
    deps:
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 9c87b62ef7d9909e7847fb7e9a77d616
      size: 6216001966
    - path: models/pancreas_model2/trained.h5ad
      md5: 11fad54dbd76c586469c2788d60c0633
      size: 489882800
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
        reports.model_summary.pancreas_model2:
          path: reports/pancreas_model2
          shared_time_plot: reports/pancreas_model2/shared_time.pdf
          volcano_plot: reports/pancreas_model2/volcano.pdf
          rainbow_plot: reports/pancreas_model2/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model2/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pancreas_model2/rainbow.pdf
      md5: 22d26fdec34dfe7cfd6ac979a19e91bd
      size: 674586
    - path: reports/pancreas_model2/rainbow.pdf.png
      md5: 2e3897c1051879899a0efedec7830636
      size: 1584892
    - path: reports/pancreas_model2/vector_field.pdf
      md5: 2f29d6160f12fbbe74c4cc1d9b05eb0d
      size: 397582
    - path: reports/pancreas_model2/vector_field.pdf.png
      md5: ad145f13c844f6ed3efa05893abed336
      size: 697528
    - path: reports/pancreas_model2/volcano.pdf
      md5: 8c1e4e736a7233d2ea3bccd474bd3dc7
      size: 48007
  summarize_pbmc68k_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model1]
    deps:
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: e3ae4282578b6ed42668b57f3b236d8a
      size: 27836354015
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 3dfa83c8a2fde66d371728f9054859ed
      size: 2465547357
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
        reports.model_summary.pbmc68k_model1:
          path: reports/pbmc68k_model1
          shared_time_plot: reports/pbmc68k_model1/shared_time.pdf
          volcano_plot: reports/pbmc68k_model1/volcano.pdf
          rainbow_plot: reports/pbmc68k_model1/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model1/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pbmc68k_model1/rainbow.pdf
      md5: 6b1fc456e47846823a28ec846da275b6
      size: 11031766
    - path: reports/pbmc68k_model1/rainbow.pdf.png
      md5: 630fbbc2c7d0f54ee8171de02530a41b
      size: 1266166
    - path: reports/pbmc68k_model1/vector_field.pdf
      md5: 9b84fb4cbd49afddafebe04a3e91e8cd
      size: 1033647
    - path: reports/pbmc68k_model1/vector_field.pdf.png
      md5: 3e1f828c00ac521ef2f249a9748dead9
      size: 1202336
    - path: reports/pbmc68k_model1/volcano.pdf
      md5: c19203d05f955a8ac3b640ffd5c98b20
      size: 24783
  summarize_pbmc68k_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model2]
    deps:
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 5be9a7d84eb3a4ca1a36eb763635206d
      size: 24366111782
    - path: models/pbmc68k_model2/trained.h5ad
      md5: d149ed959b9563c39a4c51c9e1bae04a
      size: 2465547357
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
        reports.model_summary.pbmc68k_model2:
          path: reports/pbmc68k_model2
          shared_time_plot: reports/pbmc68k_model2/shared_time.pdf
          volcano_plot: reports/pbmc68k_model2/volcano.pdf
          rainbow_plot: reports/pbmc68k_model2/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model2/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pbmc68k_model2/rainbow.pdf
      md5: 862a25ed102f796a1e193769ccc5fa0d
      size: 11383834
    - path: reports/pbmc68k_model2/rainbow.pdf.png
      md5: 334b3d678da240b30aeeec817c73302e
      size: 2411203
    - path: reports/pbmc68k_model2/vector_field.pdf
      md5: 57981948340a1d22eee4405afe93e590
      size: 1033626
    - path: reports/pbmc68k_model2/vector_field.pdf.png
      md5: d96f59d1c2bc3d28b3d812826ee2a270
      size: 1196949
    - path: reports/pbmc68k_model2/volcano.pdf
      md5: 76d60323ed48b8e41339f665f8d0adee
      size: 24065
  summarize_pons_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model1]
    deps:
    - path: models/pons_model1/pyrovelocity.pkl
      md5: e1f88c8d84a3526c5de540b5e48cb583
      size: 12014584796
    - path: models/pons_model1/trained.h5ad
      md5: 60114281e3463f8074a29c5d085fc616
      size: 855745190
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
        reports.model_summary.pons_model1:
          path: reports/pons_model1
          shared_time_plot: reports/pons_model1/shared_time.pdf
          volcano_plot: reports/pons_model1/volcano.pdf
          rainbow_plot: reports/pons_model1/rainbow.pdf
          uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf
          vector_field_plot: reports/pons_model1/vector_field.pdf
          biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pons_model1/rainbow.pdf
      md5: a0339777931bf5329583072ef390f430
      size: 1055175
    - path: reports/pons_model1/rainbow.pdf.png
      md5: a27917bfbf967a693c53a350d1ffe1f6
      size: 981998
    - path: reports/pons_model1/vector_field.pdf
      md5: 8b1963aa9c7adc8185ab17a26d168729
      size: 376834
    - path: reports/pons_model1/vector_field.pdf.png
      md5: 53e3ce42c92c56c78efe530d4fac5775
      size: 789157
    - path: reports/pons_model1/volcano.pdf
      md5: 2349b2a500f67ea7c42183d138bec36e
      size: 46117
  summarize_pons_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model2]
    deps:
    - path: models/pons_model2/pyrovelocity.pkl
      md5: 00405f5904b25cde4d3ed7975a066c80
      size: 10514584903
    - path: models/pons_model2/trained.h5ad
      md5: fb4e9c1b8682e698a668baed84a7f2ec
      size: 855745190
    - path: summarize.py
      md5: 42746a8362f9b88d961dc7da7614c7dc
      size: 7036
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
        reports.model_summary.pons_model2:
          path: reports/pons_model2
          shared_time_plot: reports/pons_model2/shared_time.pdf
          volcano_plot: reports/pons_model2/volcano.pdf
          rainbow_plot: reports/pons_model2/rainbow.pdf
          uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf
          vector_field_plot: reports/pons_model2/vector_field.pdf
          biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pons_model2/rainbow.pdf
      md5: a7c6c0b20ea544eb7ad87908201b677b
      size: 1078988
    - path: reports/pons_model2/rainbow.pdf.png
      md5: bd073ea0cc3d313a9286b954adfd7ef1
      size: 954742
    - path: reports/pons_model2/vector_field.pdf
      md5: 36c1f16d6393f9f0623bd552223e477a
      size: 377125
    - path: reports/pons_model2/vector_field.pdf.png
      md5: 395a23f79d7e6a5f8a696ac8b1b7f896
      size: 798031
    - path: reports/pons_model2/volcano.pdf
      md5: de1e6f1cedf72d8a60ba9074a54d6981
      size: 46266
