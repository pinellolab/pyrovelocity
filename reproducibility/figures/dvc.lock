schema: '2.0'
stages:
  data_download_pancreas:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pancreas]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
  preprocess_pancreas:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pancreas]
    deps:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/processed/pancreas_processed.h5ad
      md5: 14f5abed25caaaaf7be172657b809b96
      size: 424775272
  train_pancreas_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model1]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 14f5abed25caaaaf7be172657b809b96
      size: 424775272
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
    outs:
    - path: models/pancreas_model1/loss_plot.png
      md5: 5a0d4bd417a02d36b83211a695acf47c
      size: 11561
    - path: models/pancreas_model1/metrics.json
      md5: 37a146281f1d1ea77953a0d03c872367
      size: 160
    - path: models/pancreas_model1/model
      md5: 6cc72f8c267a3d34de818b6aa177fc0b.dir
      size: 635690
      nfiles: 1
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 15a77a1db13b60fa1005201a08f512e7
      size: 65153304
    - path: models/pancreas_model1/run_info.json
      md5: ae30ff0e56cbcb2310e31cf5a5c76ff0
      size: 455
    - path: models/pancreas_model1/trained.h5ad
      md5: 72a05b2966bee39e85c17b16c569733c
      size: 489882800
  data_download_pbmc68k:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pbmc68k]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
  preprocess_pbmc68k:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pbmc68k]
    deps:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 00512e0c632850bdb69625413a97bca6
      size: 1677116165
  train_pbmc68k_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model1]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
    outs:
    - path: models/pbmc68k_model1/loss_plot.png
      md5: fd8a5a047b791aaff6c78ae3f407c2bc
      size: 15992
    - path: models/pbmc68k_model1/metrics.json
      md5: bc752a5244eaea5ddd195aeea4e93e5e
      size: 160
    - path: models/pbmc68k_model1/model
      md5: 3da668a675ae86f927b7c70a46a26dcc.dir
      size: 1705450
      nfiles: 1
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: 4584173130491fd4d3062a2aa108376e
      size: 304527729
    - path: models/pbmc68k_model1/run_info.json
      md5: 5713c070c04592902a1fb6a794926c1f
      size: 454
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 1c8ebe9fa607745d55eb74ab48b00f83
      size: 2465530973
  figure2:
    cmd: python fig2/figure.py
    deps:
    - path: fig2/figure.py
      md5: ff1ac53128478106cf019fc967bd35c4
      size: 19573
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 15a77a1db13b60fa1005201a08f512e7
      size: 65153304
    - path: models/pancreas_model1/trained.h5ad
      md5: 72a05b2966bee39e85c17b16c569733c
      size: 489882800
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: 4584173130491fd4d3062a2aa108376e
      size: 304527729
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 1c8ebe9fa607745d55eb74ab48b00f83
      size: 2465530973
    params:
      config.yaml:
        reports.figure2:
          tag: fig2
          path: reports/fig2
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf
          pancreas_model1:
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_markers_phaseportrait.pdf
      md5: 27397f9d90dc28438e4fb07e3a8fe885
      size: 4548720
    - path: reports/fig2/fig2_markers_selection_scatterplot.tif
      md5: 964cb7b603252f62eeed9c5c311187ee
      size: 6125606
    - path: reports/fig2/fig2_param_uncertainties.pdf
      md5: 9401cac90267d4b0e99587c17c6346be
      size: 79990
    - path: reports/fig2/fig2_raw_gene_selection_model1.svg
      md5: 175a6e56fb0a81e928d68c8eba9986be
      size: 49297217
    - path: reports/fig2/fig2_raw_gene_selection_model1.tif
      md5: 3cf7d72a522d1e216f21f7c089c48cda
      size: 19864142
  plot_pancreas_model1:
    cmd: python fig2/fig2_pancreas_plot.py
    deps:
    - path: fig2/fig2_pancreas_plot.py
      md5: 9760277a8b45c2994e44f0ebc69b26e1
      size: 5816
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 15a77a1db13b60fa1005201a08f512e7
      size: 65153304
    - path: models/pancreas_model1/trained.h5ad
      md5: 72a05b2966bee39e85c17b16c569733c
      size: 489882800
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.figure2.pancreas_model1:
          shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
          volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
          rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
          vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_pancreas_rainbow.pdf
      md5: 82877cd7b900f387a54d19b06be2ba25
      size: 673601
    - path: reports/fig2/fig2_pancreas_shared_time.pdf
      md5: 1ebc59338583fdd967960461f3d8c0b1
      size: 659903
    - path: reports/fig2/fig2_pancreas_vector_field.pdf
      md5: 2a61d276b6797daaf27e971758179dcd
      size: 407981
    - path: reports/fig2/fig2_pancreas_volcano.pdf
      md5: f866f0103c235ecc53db61393aabac17
      size: 21291
  data_download_larry:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry:
          data_file: larry.h5ad
          dl_root: data/external
          dl_path: data/external/larry.h5ad
          rel_path: data/external/larry.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_processed.h5ad
    outs:
    - path: data/external/larry.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
  train_pancreas_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model2]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 14f5abed25caaaaf7be172657b809b96
      size: 424775272
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
    outs:
    - path: models/pancreas_model2/loss_plot.png
      md5: 8a8de154eb3e3ad3c1f11264eadedacd
      size: 11500
    - path: models/pancreas_model2/metrics.json
      md5: bee341290f771daa82fe093995c39428
      size: 158
    - path: models/pancreas_model2/model
      md5: c3f7b719c0522e018ce56fc084fcf525.dir
      size: 923626
      nfiles: 1
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 1eeaa0c042af52c18af112c6c33893c3
      size: 65873440
    - path: models/pancreas_model2/run_info.json
      md5: 057ab39af12d4b1ad667a86eddce52bb
      size: 455
    - path: models/pancreas_model2/trained.h5ad
      md5: 1d4521ada3f003b83c25be30516ef139
      size: 489882800
  train_pbmc68k_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model2]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 00512e0c632850bdb69625413a97bca6
      size: 1677116165
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
    outs:
    - path: models/pbmc68k_model2/loss_plot.png
      md5: fc1be04e249edbfdae852be361a9b65e
      size: 16196
    - path: models/pbmc68k_model2/metrics.json
      md5: 894b58babe8fc61e18a3f4c0475c2d0d
      size: 158
    - path: models/pbmc68k_model2/model
      md5: 1ba516c332528bb3065b0858dd17c63c.dir
      size: 1768618
      nfiles: 1
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 51b6e251fff5481399746326fe165657
      size: 320496178
    - path: models/pbmc68k_model2/run_info.json
      md5: b70d01bfb5333d3f262814ecac0517be
      size: 454
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 7b9d6a7252c60c01a97f9796fcad1925
      size: 2250684777
  figureS3:
    cmd: python figS3/figure.py
    deps:
    - path: figS3/figure.py
      md5: 26fb835fc33be2700fe9e65a9f236c9a
      size: 12921
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 1eeaa0c042af52c18af112c6c33893c3
      size: 65873440
    - path: models/pancreas_model2/trained.h5ad
      md5: 1d4521ada3f003b83c25be30516ef139
      size: 489882800
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 51b6e251fff5481399746326fe165657
      size: 320496178
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 7b9d6a7252c60c01a97f9796fcad1925
      size: 2250684777
    params:
      config.yaml:
        reports.figureS3:
          tag: figS3
          path: reports/figS3
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg
    outs:
    - path: reports/figS3/figS3_raw_gene_selection_model2.svg
      md5: bae3d750bf1c05ccdb5e6fa6cd5c5021
      size: 49272520
    - path: reports/figS3/figS3_raw_gene_selection_model2.tif
      md5: f8b794dfcb39d1aabbc4016eb8455fbe
      size: 19732046
  data_download_pons:
    cmd: python data_download.py data_external.sources=[velocyto] data_external.velocyto.download=[pons]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
  preprocess_pons:
    cmd: python preprocess.py data_external.sources=[velocyto] data_external.velocyto.process=[pons]
    deps:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
  train_pons_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model1]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
    outs:
    - path: models/pons_model1/loss_plot.png
      md5: f9221e79d3feccf2ec2f4df7471f9e43
      size: 11331
    - path: models/pons_model1/metrics.json
      md5: 49ed1b0204730204905b62e8d5fbb104
      size: 159
    - path: models/pons_model1/model
      md5: 2521863977184a84265f2e3b52443f0e.dir
      size: 697386
      nfiles: 1
    - path: models/pons_model1/pyrovelocity.pkl
      md5: 64d1f8a752442cdaf2d1f466b9acf0c9
      size: 108888222
    - path: models/pons_model1/run_info.json
      md5: 26ac35d760dca9ec06a6227a80df6cb1
      size: 451
    - path: models/pons_model1/trained.h5ad
      md5: f1e93db377fd7d323c9dc3b7bd722542
      size: 855745190
  train_pons_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model2]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
    outs:
    - path: models/pons_model2/loss_plot.png
      md5: 4a0ae00f44c012ab0d90fa82d57a11ec
      size: 12093
    - path: models/pons_model2/metrics.json
      md5: a7fbfcc37be877070c4b5bc504c4e237
      size: 156
    - path: models/pons_model2/model
      md5: 4b1b6de73d382224887c26cf2fd18fb0.dir
      size: 985386
      nfiles: 1
    - path: models/pons_model2/pyrovelocity.pkl
      md5: d79e01cfe2e250d48ccf245120d2c043
      size: 109608400
    - path: models/pons_model2/run_info.json
      md5: 165e674b605e6ca5a4122a2ca86213ba
      size: 432
    - path: models/pons_model2/trained.h5ad
      md5: 56ea0f1773ba92f27f1670a486729621
      size: 855745190
  summarize_pancreas_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model1]
    deps:
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 15a77a1db13b60fa1005201a08f512e7
      size: 65153304
    - path: models/pancreas_model1/trained.h5ad
      md5: 72a05b2966bee39e85c17b16c569733c
      size: 489882800
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.model_summary.pancreas_model1:
          path: reports/pancreas_model1
          dataframe_path: data/processed/pancreas_model1_dataframe.pkl.zst
          shared_time_plot: reports/pancreas_model1/shared_time.pdf
          volcano_plot: reports/pancreas_model1/volcano.pdf
          rainbow_plot: reports/pancreas_model1/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model1/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pancreas_model1_dataframe.pkl.zst
      md5: bbff19677beed1c7cf3766506f391723
      size: 12359084
    - path: reports/pancreas_model1/rainbow.pdf
      md5: 12b43945de81be637f8fccfc3c143653
      size: 673601
    - path: reports/pancreas_model1/rainbow.pdf.png
      md5: 48a79de6b0115442d072fb33e2fb27fd
      size: 2086273
    - path: reports/pancreas_model1/shared_time.pdf
      md5: fda3ffc971ba85732ac78ca13b60104e
      size: 437750
    - path: reports/pancreas_model1/vector_field.pdf
      md5: adb1b8c1ecc2c115232d229018a5a472
      size: 397545
    - path: reports/pancreas_model1/vector_field.pdf.png
      md5: e0dd14331806e6f483796f36a26fb551
      size: 692363
    - path: reports/pancreas_model1/volcano.pdf
      md5: 745bdc1ce684948aca9b135c72b6f2f6
      size: 21291
  summarize_pancreas_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model2]
    deps:
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 1eeaa0c042af52c18af112c6c33893c3
      size: 65873440
    - path: models/pancreas_model2/trained.h5ad
      md5: 1d4521ada3f003b83c25be30516ef139
      size: 489882800
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
        reports.model_summary.pancreas_model2:
          path: reports/pancreas_model2
          dataframe_path: data/processed/pancreas_model2_dataframe.pkl.zst
          shared_time_plot: reports/pancreas_model2/shared_time.pdf
          volcano_plot: reports/pancreas_model2/volcano.pdf
          rainbow_plot: reports/pancreas_model2/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model2/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pancreas_model2_dataframe.pkl.zst
      md5: bbff19677beed1c7cf3766506f391723
      size: 12359084
    - path: reports/pancreas_model2/rainbow.pdf
      md5: d672e218564c2820fd3644e8f707cfbe
      size: 674523
    - path: reports/pancreas_model2/rainbow.pdf.png
      md5: a053e9fbf0755a4fa529e92e3ef03f45
      size: 1592710
    - path: reports/pancreas_model2/shared_time.pdf
      md5: e049a8cda952627367f94f7282ac4195
      size: 470124
    - path: reports/pancreas_model2/vector_field.pdf
      md5: 97d61251fa0e07dba158dd2111071600
      size: 397586
    - path: reports/pancreas_model2/vector_field.pdf.png
      md5: 2bff17b5b0187728de366ba4f0b02cd3
      size: 698541
    - path: reports/pancreas_model2/volcano.pdf
      md5: 71ed987363eae5069aae4480b94c09ec
      size: 20335
  summarize_pbmc68k_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model1]
    deps:
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: 4584173130491fd4d3062a2aa108376e
      size: 304527729
    - path: models/pbmc68k_model1/trained.h5ad
      md5: 1c8ebe9fa607745d55eb74ab48b00f83
      size: 2465530973
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
        reports.model_summary.pbmc68k_model1:
          path: reports/pbmc68k_model1
          dataframe_path: data/processed/pbmc68k_model1_dataframe.pkl.zst
          shared_time_plot: reports/pbmc68k_model1/shared_time.pdf
          volcano_plot: reports/pbmc68k_model1/volcano.pdf
          rainbow_plot: reports/pbmc68k_model1/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model1/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pbmc68k_model1_dataframe.pkl.zst
      md5: dc17c1ef835c7500d0b694422481fbd1
      size: 38352654
    - path: reports/pbmc68k_model1/rainbow.pdf
      md5: 57b43ddde943d188c129038fe6a1e890
      size: 11031762
    - path: reports/pbmc68k_model1/rainbow.pdf.png
      md5: b4c31e65e4b6747ceb6991b9bba5db23
      size: 1268122
    - path: reports/pbmc68k_model1/shared_time.pdf
      md5: 2ae71c59540558b904dd1e04f1047ab9
      size: 921075
    - path: reports/pbmc68k_model1/vector_field.pdf
      md5: 0db55c544bc8a8e5365a159b4ac1ca74
      size: 1033522
    - path: reports/pbmc68k_model1/vector_field.pdf.png
      md5: 41968bc3f231c66e155bf787127d08d3
      size: 1201485
    - path: reports/pbmc68k_model1/volcano.pdf
      md5: 75dc018a6c76ab016c13a15c2bb766e0
      size: 22252
  summarize_pbmc68k_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model2]
    deps:
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 51b6e251fff5481399746326fe165657
      size: 320496178
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 7b9d6a7252c60c01a97f9796fcad1925
      size: 2250684777
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
        reports.model_summary.pbmc68k_model2:
          path: reports/pbmc68k_model2
          dataframe_path: data/processed/pbmc68k_model2_dataframe.pkl.zst
          shared_time_plot: reports/pbmc68k_model2/shared_time.pdf
          volcano_plot: reports/pbmc68k_model2/volcano.pdf
          rainbow_plot: reports/pbmc68k_model2/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model2/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pbmc68k_model2_dataframe.pkl.zst
      md5: dc17c1ef835c7500d0b694422481fbd1
      size: 38352654
    - path: reports/pbmc68k_model2/rainbow.pdf
      md5: 2c3e1bfe3ddf42809d069593a0050dc3
      size: 11383839
    - path: reports/pbmc68k_model2/rainbow.pdf.png
      md5: f21a38a0d5f4aafc64a19666e0c6042b
      size: 2414280
    - path: reports/pbmc68k_model2/shared_time.pdf
      md5: 9fde2da702c2e930936a0298dc043a68
      size: 367630
    - path: reports/pbmc68k_model2/vector_field.pdf
      md5: 264be1c77aa69fb9820825dc36692513
      size: 1033559
    - path: reports/pbmc68k_model2/vector_field.pdf.png
      md5: be3e5aed280a9be88c7fdeb478ba2f3d
      size: 1196274
    - path: reports/pbmc68k_model2/volcano.pdf
      md5: d78addbb6bd9c15f0a4fbbb7daacdfb8
      size: 20449
  summarize_pons_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model1]
    deps:
    - path: models/pons_model1/pyrovelocity.pkl
      md5: 64d1f8a752442cdaf2d1f466b9acf0c9
      size: 108888222
    - path: models/pons_model1/trained.h5ad
      md5: f1e93db377fd7d323c9dc3b7bd722542
      size: 855745190
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
        reports.model_summary.pons_model1:
          path: reports/pons_model1
          dataframe_path: data/processed/pons_model1_dataframe.pkl.zst
          shared_time_plot: reports/pons_model1/shared_time.pdf
          volcano_plot: reports/pons_model1/volcano.pdf
          rainbow_plot: reports/pons_model1/rainbow.pdf
          uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf
          vector_field_plot: reports/pons_model1/vector_field.pdf
          biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pons_model1_dataframe.pkl.zst
      md5: b17eb7eaadc357d32ae68e3c30ee33f4
      size: 20173882
    - path: reports/pons_model1/rainbow.pdf
      md5: a87769f9b927c36ebafa57e2f6f8850f
      size: 1055211
    - path: reports/pons_model1/rainbow.pdf.png
      md5: 5849a1d785f56ad9945bef447f1ef384
      size: 988477
    - path: reports/pons_model1/shared_time.pdf
      md5: 9884c77aa4606e5160bf8625ea32383d
      size: 542703
    - path: reports/pons_model1/vector_field.pdf
      md5: f2bf49fcb130e5aa1801acae5e0ba429
      size: 376837
    - path: reports/pons_model1/vector_field.pdf.png
      md5: e0f4266d818388dca780f686c1f8059a
      size: 789252
    - path: reports/pons_model1/volcano.pdf
      md5: ba79b19b6aeed15fe2b6f632903d025f
      size: 20394
  summarize_pons_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model2]
    deps:
    - path: models/pons_model2/pyrovelocity.pkl
      md5: d79e01cfe2e250d48ccf245120d2c043
      size: 109608400
    - path: models/pons_model2/trained.h5ad
      md5: 56ea0f1773ba92f27f1670a486729621
      size: 855745190
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
        reports.model_summary.pons_model2:
          path: reports/pons_model2
          dataframe_path: data/processed/pons_model2_dataframe.pkl.zst
          shared_time_plot: reports/pons_model2/shared_time.pdf
          volcano_plot: reports/pons_model2/volcano.pdf
          rainbow_plot: reports/pons_model2/rainbow.pdf
          uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf
          vector_field_plot: reports/pons_model2/vector_field.pdf
          biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pons_model2_dataframe.pkl.zst
      md5: b17eb7eaadc357d32ae68e3c30ee33f4
      size: 20173882
    - path: reports/pons_model2/rainbow.pdf
      md5: 5494eb55eb669dc5d53d8816f0e56608
      size: 1079005
    - path: reports/pons_model2/rainbow.pdf.png
      md5: bad7afd11e2404c13ce0d65348de117b
      size: 960916
    - path: reports/pons_model2/shared_time.pdf
      md5: 42c6cc1bcf15ff4c94942f738b6ae1d6
      size: 559935
    - path: reports/pons_model2/vector_field.pdf
      md5: 2c95203a5e560cf435db2bcb8bf82ca6
      size: 377124
    - path: reports/pons_model2/vector_field.pdf.png
      md5: 9c9391629c8b3f51712f317fda453394
      size: 798042
    - path: reports/pons_model2/volcano.pdf
      md5: 093c7661b122f8728eb0cc90d5f06375
      size: 21539
  data_download_simulate:
    cmd: python data_download.py data_external.sources=[simulate] data_external.simulate.download=[medium]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.simulate.medium:
          data_file: simulated_medium.h5ad
          dl_root: data/external
          dl_path: data/external/simulated_medium.h5ad
          rel_path: data/external/simulated_medium.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/simulated_medium.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/simulated_medium_processed.h5ad
    outs:
    - path: data/external/simulated_medium.h5ad
      md5: c8483b84bd68f57acb407f715f807f9e
      size: 60248568
  preprocess_simulate:
    cmd: python preprocess.py data_external.sources=[simulate] data_external.simulate.process=[medium]
    deps:
    - path: data/external/simulated_medium.h5ad
      md5: c8483b84bd68f57acb407f715f807f9e
      size: 60248568
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.simulate.medium:
          data_file: simulated_medium.h5ad
          dl_root: data/external
          dl_path: data/external/simulated_medium.h5ad
          rel_path: data/external/simulated_medium.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/simulated_medium.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/simulated_medium_processed.h5ad
    outs:
    - path: data/processed/simulated_medium_processed.h5ad
      md5: a3b043f214bc630880e0882c802ee2f6
      size: 257351792
  train_simulate_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[simulate_model2]
    deps:
    - path: data/processed/simulated_medium_processed.h5ad
      md5: a3b043f214bc630880e0882c802ee2f6
      size: 257351792
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.simulate_model2:
          path: models/medium_model2
          model_path: models/medium_model2/model
          input_data_path: data/processed/simulated_medium_processed.h5ad
          trained_data_path: models/medium_model2/trained.h5ad
          pyrovelocity_data_path: models/medium_model2/pyrovelocity.pkl
          metrics_path: models/medium_model2/metrics.json
          run_info_path: models/medium_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: leiden
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 4000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/medium_model2/loss_plot.png
    outs:
    - path: models/medium_model2/loss_plot.png
      md5: 77cb69bc1f4e1de9ef25957ccb66fe2f
      size: 10825
    - path: models/medium_model2/metrics.json
      md5: 61ba5f01677f579a99991c39fb44d8a7
      size: 158
    - path: models/medium_model2/model
      md5: 353c17d70817f8af85bcdf88e47c0f33.dir
      size: 487274
      nfiles: 1
    - path: models/medium_model2/pyrovelocity.pkl
      md5: 18cc5d038c9acb33fb7a282c537deff3
      size: 28649579
    - path: models/medium_model2/run_info.json
      md5: c06db2d24426378aae87ef1fc97d328b
      size: 455
    - path: models/medium_model2/trained.h5ad
      md5: 0bf8d1aff6d9ad885666b82589d0d78b
      size: 283017032
  train_simulate_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[simulate_model1]
    deps:
    - path: data/processed/simulated_medium_processed.h5ad
      md5: a3b043f214bc630880e0882c802ee2f6
      size: 257351792
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.simulate_model1:
          path: models/medium_model1
          model_path: models/medium_model1/model
          input_data_path: data/processed/simulated_medium_processed.h5ad
          trained_data_path: models/medium_model1/trained.h5ad
          pyrovelocity_data_path: models/medium_model1/pyrovelocity.pkl
          metrics_path: models/medium_model1/metrics.json
          run_info_path: models/medium_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: leiden
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 4000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/medium_model1/loss_plot.png
    outs:
    - path: models/medium_model1/loss_plot.png
      md5: 63f564801f73360c48d0aba7ddd9ab90
      size: 10649
    - path: models/medium_model1/metrics.json
      md5: 763f5ed1f7d6350b2470a3260e6ae697
      size: 156
    - path: models/medium_model1/model
      md5: 04a6d5b29bef623290e36941804d5249.dir
      size: 343338
      nfiles: 1
    - path: models/medium_model1/pyrovelocity.pkl
      md5: 0dc154ecc3da7b0a2702c7c9e9301b37
      size: 28289417
    - path: models/medium_model1/run_info.json
      md5: 2a0a17a345d3141ae8a2188fded82022
      size: 455
    - path: models/medium_model1/trained.h5ad
      md5: 6152df9397b02843f6f61022d9f74bb5
      size: 283016776
  summarize_simulate_model1:
    cmd: python summarize.py reports.model_summary.summarize=[simulate_model1]
    deps:
    - path: models/medium_model1/pyrovelocity.pkl
      md5: 0dc154ecc3da7b0a2702c7c9e9301b37
      size: 28289417
    - path: models/medium_model1/trained.h5ad
      md5: 6152df9397b02843f6f61022d9f74bb5
      size: 283016776
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.simulate_model1:
          path: models/medium_model1
          model_path: models/medium_model1/model
          input_data_path: data/processed/simulated_medium_processed.h5ad
          trained_data_path: models/medium_model1/trained.h5ad
          pyrovelocity_data_path: models/medium_model1/pyrovelocity.pkl
          metrics_path: models/medium_model1/metrics.json
          run_info_path: models/medium_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: leiden
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 4000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/medium_model1/loss_plot.png
        reports.model_summary.simulate_model1:
          path: reports/medium_model1
          dataframe_path: data/processed/medium_model1_dataframe.pkl.zst
          shared_time_plot: reports/medium_model1/shared_time.pdf
          volcano_plot: reports/medium_model1/volcano.pdf
          rainbow_plot: reports/medium_model1/rainbow.pdf
          uncertainty_param_plot: reports/medium_model1/param_uncertainties.pdf
          vector_field_plot: reports/medium_model1/vector_field.pdf
          biomarker_selection_plot: reports/medium_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/medium_model1/markers_phaseportrait.pdf
    outs:
    - path: data/processed/medium_model1_dataframe.pkl.zst
      md5: 12e544a30c6d793d04f0a48245d309c8
      size: 5068789
    - path: reports/medium_model1/rainbow.pdf
      md5: fb55fd30843a4926b68ef32c8fa4d5b3
      size: 415343
    - path: reports/medium_model1/rainbow.pdf.png
      md5: e2a988c1b94ccac347654758176abb1c
      size: 709724
    - path: reports/medium_model1/shared_time.pdf
      md5: de858d0615cb9f683e336d26e11c0568
      size: 193576
    - path: reports/medium_model1/vector_field.pdf
      md5: 10c9c94bb4a16e37f55b39f98068bc84
      size: 202510
    - path: reports/medium_model1/vector_field.pdf.png
      md5: 1e229501f9e65fbca6db66bc2071573d
      size: 497363
    - path: reports/medium_model1/volcano.pdf
      md5: cf257b048eaace8e12da8b974158b32b
      size: 20550
  summarize_simulate_model2:
    cmd: python summarize.py reports.model_summary.summarize=[simulate_model2]
    deps:
    - path: models/medium_model2/pyrovelocity.pkl
      md5: 18cc5d038c9acb33fb7a282c537deff3
      size: 28649579
    - path: models/medium_model2/trained.h5ad
      md5: 0bf8d1aff6d9ad885666b82589d0d78b
      size: 283017032
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.simulate_model2:
          path: models/medium_model2
          model_path: models/medium_model2/model
          input_data_path: data/processed/simulated_medium_processed.h5ad
          trained_data_path: models/medium_model2/trained.h5ad
          pyrovelocity_data_path: models/medium_model2/pyrovelocity.pkl
          metrics_path: models/medium_model2/metrics.json
          run_info_path: models/medium_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: leiden
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 4000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/medium_model2/loss_plot.png
        reports.model_summary.simulate_model2:
          path: reports/medium_model2
          dataframe_path: data/processed/medium_model2_dataframe.pkl.zst
          shared_time_plot: reports/medium_model2/shared_time.pdf
          volcano_plot: reports/medium_model2/volcano.pdf
          rainbow_plot: reports/medium_model2/rainbow.pdf
          uncertainty_param_plot: reports/medium_model2/param_uncertainties.pdf
          vector_field_plot: reports/medium_model2/vector_field.pdf
          biomarker_selection_plot: reports/medium_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/medium_model2/markers_phaseportrait.pdf
    outs:
    - path: data/processed/medium_model2_dataframe.pkl.zst
      md5: 12e544a30c6d793d04f0a48245d309c8
      size: 5068789
    - path: reports/medium_model2/rainbow.pdf
      md5: f6da663c61868df7d1bda33213d548fd
      size: 463594
    - path: reports/medium_model2/rainbow.pdf.png
      md5: e732a7a5a4fb3f7cf695a7883b6563f7
      size: 993907
    - path: reports/medium_model2/shared_time.pdf
      md5: b9b9d6ce619dbfafc11e5b2e3a9b4f63
      size: 205089
    - path: reports/medium_model2/vector_field.pdf
      md5: fc93202f2e4e7debad9b0276df704bdd
      size: 204749
    - path: reports/medium_model2/vector_field.pdf.png
      md5: a17fb5265f36996dd08159e3c96aed5f
      size: 513295
    - path: reports/medium_model2/volcano.pdf
      md5: 6bd31771ffe950164e01ddcf6e5528a8
      size: 19646
  preprocess_larry:
    cmd: python preprocess.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.process=[larry]
    deps:
    - path: data/external/larry.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry:
          data_file: larry.h5ad
          dl_root: data/external
          dl_path: data/external/larry.h5ad
          rel_path: data/external/larry.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_processed.h5ad
    outs:
    - path: data/processed/larry_processed.h5ad
      md5: b560530dc084582b04c57cba7bcb07e7
      size: 5361832686
  train_larry_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[larry_model2]
    deps:
    - path: data/processed/larry_processed.h5ad
      md5: b560530dc084582b04c57cba7bcb07e7
      size: 5361832686
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.larry_model2:
          path: models/larry_model2
          model_path: models/larry_model2/model
          input_data_path: data/processed/larry_processed.h5ad
          trained_data_path: models/larry_model2/trained.h5ad
          pyrovelocity_data_path: models/larry_model2/pyrovelocity.pkl
          metrics_path: models/larry_model2/metrics.json
          run_info_path: models/larry_model2/run_info.json
          vector_field_parameters:
            basis: emb
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: true
            batch_size: 4000
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: state_info
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 1000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/larry_model2/loss_plot.png
    outs:
    - path: models/larry_model2/loss_plot.png
      md5: 079875138c9e1e054494036fa7dd1e9a
      size: 11635
    - path: models/larry_model2/metrics.json
      md5: 2401eb5b4af9f759cf11b9ca98ec522c
      size: 155
    - path: models/larry_model2/model
      md5: db09d839be6d527b9d9ba1b7a6d01211.dir
      size: 2050986
      nfiles: 1
    - path: models/larry_model2/pyrovelocity.pkl
      md5: e5c4f43ab541ed99e34e56cd72803686
      size: 845919686
    - path: models/larry_model2/run_info.json
      md5: dd253da998244fe2fef0d2a6c149f072
      size: 433
    - path: models/larry_model2/trained.h5ad
      md5: 3b213324776dd9b266b21b92c0fd98ca
      size: 6296829206
  data_download_larry_neu:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry_neu]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_neu:
          data_file: larry_neu.h5ad
          dl_root: data/external
          dl_path: data/external/larry_neu.h5ad
          rel_path: data/external/larry_neu.h5ad
          url: https://ndownloader.figshare.com/files/37028575
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_neu_processed.h5ad
    outs:
    - path: data/external/larry_neu.h5ad
      md5: 3192e2fe89d64f5d0d158c0e7d26c79d
      size: 60008807
  preprocess_larry_neu:
    cmd: python preprocess.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.process=[larry_neu]
    deps:
    - path: data/external/larry_neu.h5ad
      md5: 3192e2fe89d64f5d0d158c0e7d26c79d
      size: 60008807
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_neu:
          data_file: larry_neu.h5ad
          dl_root: data/external
          dl_path: data/external/larry_neu.h5ad
          rel_path: data/external/larry_neu.h5ad
          url: https://ndownloader.figshare.com/files/37028575
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_neu_processed.h5ad
    outs:
    - path: data/processed/larry_neu_processed.h5ad
      md5: 8eee7f5b09ca0e0b9b0dc9b336885b9f
      size: 92577960
  data_download_larry_mono:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry_mono]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_mono:
          data_file: larry_mono.h5ad
          dl_root: data/external
          dl_path: data/external/larry_mono.h5ad
          rel_path: data/external/larry_mono.h5ad
          url: https://ndownloader.figshare.com/files/37028572
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_mono_processed.h5ad
    outs:
    - path: data/external/larry_mono.h5ad
      md5: 01f4e084c37482e26800ba4dfa0202bd
      size: 66173538
  preprocess_larry_mono:
    cmd: python preprocess.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.process=[larry_mono]
    deps:
    - path: data/external/larry_mono.h5ad
      md5: 01f4e084c37482e26800ba4dfa0202bd
      size: 66173538
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_mono:
          data_file: larry_mono.h5ad
          dl_root: data/external
          dl_path: data/external/larry_mono.h5ad
          rel_path: data/external/larry_mono.h5ad
          url: https://ndownloader.figshare.com/files/37028572
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_mono_processed.h5ad
    outs:
    - path: data/processed/larry_mono_processed.h5ad
      md5: 4a353550e390ae129fe6303e9e72229b
      size: 112022616
  train_larry_mono_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[larry_mono_model2]
    deps:
    - path: data/processed/larry_mono_processed.h5ad
      md5: 4a353550e390ae129fe6303e9e72229b
      size: 112022616
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.larry_mono_model2:
          path: models/larry_mono_model2
          model_path: models/larry_mono_model2/model
          input_data_path: data/processed/larry_mono_processed.h5ad
          trained_data_path: models/larry_mono_model2/trained.h5ad
          pyrovelocity_data_path: models/larry_mono_model2/pyrovelocity.pkl
          metrics_path: models/larry_mono_model2/metrics.json
          run_info_path: models/larry_mono_model2/run_info.json
          vector_field_parameters:
            basis: emb
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: true
            batch_size: 4000
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: state_info
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 1000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/larry_mono_model2/loss_plot.png
    outs:
    - path: models/larry_mono_model2/loss_plot.png
      md5: f23ab1572ee231091d47932e4f21c2bf
      size: 11422
    - path: models/larry_mono_model2/metrics.json
      md5: 692ec5b6b9e5d697072a4b3345c0eb0c
      size: 160
    - path: models/larry_mono_model2/model
      md5: dbe5ab2b9595349e1ef335aa607221d4.dir
      size: 602090
      nfiles: 1
    - path: models/larry_mono_model2/pyrovelocity.pkl
      md5: 4952098580fa5c337b756b6de4233f24
      size: 16839707
    - path: models/larry_mono_model2/run_info.json
      md5: 633284b7513648e620cef2cc648c8690
      size: 457
    - path: models/larry_mono_model2/trained.h5ad
      md5: 916fe17275039172797fec23a7376670
      size: 127286200
  train_larry_neu_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[larry_neu_model2]
    deps:
    - path: data/processed/larry_neu_processed.h5ad
      md5: 8eee7f5b09ca0e0b9b0dc9b336885b9f
      size: 92577960
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.larry_neu_model2:
          path: models/larry_neu_model2
          model_path: models/larry_neu_model2/model
          input_data_path: data/processed/larry_neu_processed.h5ad
          trained_data_path: models/larry_neu_model2/trained.h5ad
          pyrovelocity_data_path: models/larry_neu_model2/pyrovelocity.pkl
          metrics_path: models/larry_neu_model2/metrics.json
          run_info_path: models/larry_neu_model2/run_info.json
          vector_field_parameters:
            basis: emb
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: true
            batch_size: 4000
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: state_info
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 1000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/larry_neu_model2/loss_plot.png
    outs:
    - path: models/larry_neu_model2/loss_plot.png
      md5: 8bdab9feb9e4abc8c5d69d8837e9b3cd
      size: 11561
    - path: models/larry_neu_model2/metrics.json
      md5: 165765cf41fae2b2145dd9b007014e01
      size: 158
    - path: models/larry_neu_model2/model
      md5: 12d7572af32bbdc46da593692e030443.dir
      size: 554922
      nfiles: 1
    - path: models/larry_neu_model2/pyrovelocity.pkl
      md5: b98215711fa08cc5fbc447f4e8cbe54c
      size: 14187795
    - path: models/larry_neu_model2/run_info.json
      md5: 5d8ef3ceee70dce030409689f287eda4
      size: 456
    - path: models/larry_neu_model2/trained.h5ad
      md5: f174a255e648f1dfbd5c25bc04328170
      size: 105153380
  preprocess_larry_multilineage:
    cmd: python preprocess.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.process=[larry_multilineage]
    deps:
    - path: data/external/larry_mono.h5ad
      md5: 01f4e084c37482e26800ba4dfa0202bd
      size: 66173538
    - path: data/external/larry_neu.h5ad
      md5: 3192e2fe89d64f5d0d158c0e7d26c79d
      size: 60008807
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_multilineage:
          data_file: larry_mono.h5ad
          dl_root: data/external
          dl_path: data/external/larry_mono.h5ad
          rel_path: data/external/larry_mono.h5ad
          url: https://ndownloader.figshare.com/files/37028572
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_multilineage_processed.h5ad
    outs:
    - path: data/processed/larry_multilineage_processed.h5ad
      md5: 4a353550e390ae129fe6303e9e72229b
      size: 112022616
  train_larry_multilineage_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[larry_multilineage_model2]
    deps:
    - path: data/processed/larry_multilineage_processed.h5ad
      md5: 4a353550e390ae129fe6303e9e72229b
      size: 112022616
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.larry_multilineage_model2:
          path: models/larry_multilineage_model2
          model_path: models/larry_multilineage_model2/model
          input_data_path: data/processed/larry_multilineage_processed.h5ad
          trained_data_path: models/larry_multilineage_model2/trained.h5ad
          pyrovelocity_data_path: models/larry_multilineage_model2/pyrovelocity.pkl
          metrics_path: models/larry_multilineage_model2/metrics.json
          run_info_path: models/larry_multilineage_model2/run_info.json
          vector_field_parameters:
            basis: emb
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: true
            batch_size: 4000
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: state_info
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 1000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/larry_multilineage_model2/loss_plot.png
    outs:
    - path: models/larry_multilineage_model2/loss_plot.png
      md5: f23ab1572ee231091d47932e4f21c2bf
      size: 11422
    - path: models/larry_multilineage_model2/metrics.json
      md5: 692ec5b6b9e5d697072a4b3345c0eb0c
      size: 160
    - path: models/larry_multilineage_model2/model
      md5: fd6873cb2fc91d04ec6f5ff32206a028.dir
      size: 602090
      nfiles: 1
    - path: models/larry_multilineage_model2/pyrovelocity.pkl
      md5: 4952098580fa5c337b756b6de4233f24
      size: 16839707
    - path: models/larry_multilineage_model2/run_info.json
      md5: 81d7678008925a029b7e41dd193920cd
      size: 465
    - path: models/larry_multilineage_model2/trained.h5ad
      md5: 398f467dd68812d49c3b38dfbcb8dabf
      size: 127286200
  preprocess_pbmc10k:
    cmd: python preprocess.py data_external.sources=[pyrovelocity] data_external.scvelo.process=[pyrovelocity]
    deps:
    - path: data/external/pbmc10k.h5ad
      md5: 3b64b4cd122454610957f5c6086e2eac
      size: 592149007
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.pbmc10k:
          data_file: pbmc10k.h5ad
          dl_root: data/external
          dl_path: data/external/pbmc10k.h5ad
          rel_path: data/external/pbmc10k.h5ad
          url: https://ndownloader.figshare.com/files/pbmc10k
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc10k_processed.h5ad
    outs:
    - path: data/processed/pbmc10k_processed.h5ad
      md5: 795e204da33aa5a9b2ae7e8cd2668527
      size: 1306068803
  train_pbmc10k_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc10k_model2]
    deps:
    - path: data/processed/pbmc10k_processed.h5ad
      md5: 795e204da33aa5a9b2ae7e8cd2668527
      size: 1306068803
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8684
    params:
      config.yaml:
        model_training.pbmc10k_model2:
          path: models/pbmc10k_model2
          model_path: models/pbmc10k_model2/model
          input_data_path: data/processed/pbmc10k_processed.h5ad
          trained_data_path: models/pbmc10k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc10k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc10k_model2/metrics.json
          run_info_path: models/pbmc10k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: leiden
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc10k_model2/loss_plot.png
    outs:
    - path: models/pbmc10k_model2/loss_plot.png
      md5: 711249964722e4b0434e4c0eeaf5a78e
      size: 11490
    - path: models/pbmc10k_model2/metrics.json
      md5: b99f5e0312a61a9571f184cd3cf9061c
      size: 159
    - path: models/pbmc10k_model2/model
      md5: 4c23ecd93772c8e48f4ebe764fc84fd8.dir
      size: 1156778
      nfiles: 1
    - path: models/pbmc10k_model2/pyrovelocity.pkl
      md5: 2bc59cb5aee3692f2513da3c1a26f7da
      size: 207371037
    - path: models/pbmc10k_model2/run_info.json
      md5: 763c9c78426d7d79ba1c7a66737296b1
      size: 454
    - path: models/pbmc10k_model2/trained.h5ad
      md5: db93fe92311daf0466b3f23f0443f8ee
      size: 1515911759
  figure2_extras:
    cmd: python fig2/figure_extras.py reports.model_summary.summarize=[pbmc10k_model2,larry_tips_model2,pbmc68k_model2]
    deps:
    - path: fig2/figure_extras.py
      md5: 632a9c3472762b91ca0d2d713edd93ab
      size: 6039
    - path: models/larry_tips_model2/pyrovelocity.pkl
      md5: 52d63551f18a58477150a01d48cbb16f
      size: 323695520
    - path: models/pbmc10k_model2/pyrovelocity.pkl
      md5: 2bc59cb5aee3692f2513da3c1a26f7da
      size: 207371037
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 51b6e251fff5481399746326fe165657
      size: 320496178
    params:
      config.yaml:
        reports.figure2:
          tag: fig2
          path: reports/fig2
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf
          pancreas_model1:
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/figure2_extras.pdf
      md5: 6849b13f7417618075f646134241ac6d
      size: 181830
  summarize_pbmc10k_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc10k_model2]
    deps:
    - path: models/pbmc10k_model2/pyrovelocity.pkl
      md5: 2bc59cb5aee3692f2513da3c1a26f7da
      size: 207371037
    - path: models/pbmc10k_model2/trained.h5ad
      md5: db93fe92311daf0466b3f23f0443f8ee
      size: 1515911759
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.pbmc10k_model2:
          path: models/pbmc10k_model2
          model_path: models/pbmc10k_model2/model
          input_data_path: data/processed/pbmc10k_processed.h5ad
          trained_data_path: models/pbmc10k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc10k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc10k_model2/metrics.json
          run_info_path: models/pbmc10k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: leiden
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc10k_model2/loss_plot.png
        reports.model_summary.pbmc10k_model2:
          path: reports/pbmc10k_model2
          dataframe_path: data/processed/pbmc10k_model2_dataframe.pkl.zst
          shared_time_plot: reports/pbmc10k_model2/shared_time.pdf
          volcano_plot: reports/pbmc10k_model2/volcano.pdf
          rainbow_plot: reports/pbmc10k_model2/rainbow.pdf
          uncertainty_param_plot: reports/pbmc10k_model2/param_uncertainties.pdf
          vector_field_plot: reports/pbmc10k_model2/vector_field.pdf
          biomarker_selection_plot: reports/pbmc10k_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc10k_model2/markers_phaseportrait.pdf
    outs:
    - path: data/processed/pbmc10k_model2_dataframe.pkl.zst
      md5: 6464f86c3b2ed5661778d78c7f11c994
      size: 37856415
    - path: reports/pbmc10k_model2/rainbow.pdf
      md5: 73aa31b36a1cbd3e0024acae18790f71
      size: 2046931
    - path: reports/pbmc10k_model2/rainbow.pdf.png
      md5: df3527785c8544b3ef41ef65bb4a62b5
      size: 1587744
    - path: reports/pbmc10k_model2/shared_time.pdf
      md5: b4910fa55df93f22901c8d7a9844bb85
      size: 411751
    - path: reports/pbmc10k_model2/vector_field.pdf
      md5: be4a82aee46d579741e182c0ef57febd
      size: 505124
    - path: reports/pbmc10k_model2/vector_field.pdf.png
      md5: b4c30a3e92048c70a4292c75f5204e0e
      size: 998164
    - path: reports/pbmc10k_model2/volcano.pdf
      md5: 3fa86e7e4dc78d0c5797b835338a762a
      size: 21236
  data_download_pbmc10k:
    cmd: echo "Reference pbmc10k"
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.pbmc10k:
          data_file: pbmc10k.h5ad
          dl_root: data/external
          dl_path: data/external/pbmc10k.h5ad
          rel_path: data/external/pbmc10k.h5ad
          url: https://ndownloader.figshare.com/files/pbmc10k
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc10k_processed.h5ad
    outs:
    - path: data/external/pbmc10k.h5ad
      md5: 3b64b4cd122454610957f5c6086e2eac
      size: 592149007
  data_download_larry_tips:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry_tips]
    deps:
    - path: data_download.py
      md5: 30f38cc794cbf4caad2675ffd88c2467
      size: 3305
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_tips:
          data_file: larry_tips.h5ad
          dl_root: data/external
          dl_path: data/external/larry_tips.h5ad
          rel_path: data/external/larry_tips.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_tips_processed.h5ad
    outs:
    - path: data/external/larry_tips.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
  preprocess_larry_tips:
    cmd: python preprocess.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.process=[larry_tips]
    deps:
    - path: data/external/larry_tips.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry_tips:
          data_file: larry_tips.h5ad
          dl_root: data/external
          dl_path: data/external/larry_tips.h5ad
          rel_path: data/external/larry_tips.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/larry_tips_processed.h5ad
    outs:
    - path: data/processed/larry_tips_processed.h5ad
      md5: 9a776e794d60642f46df5d27864a68f3
      size: 2026603122
  train_larry_tips_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[larry_tips_model2]
    deps:
    - path: data/processed/larry_tips_processed.h5ad
      md5: 9a776e794d60642f46df5d27864a68f3
      size: 2026603122
    - path: train.py
      md5: c866df8072532a9ccd9b9b0a5974fdb4
      size: 8722
    params:
      config.yaml:
        model_training.larry_tips_model2:
          path: models/larry_tips_model2
          model_path: models/larry_tips_model2/model
          input_data_path: data/processed/larry_tips_processed.h5ad
          trained_data_path: models/larry_tips_model2/trained.h5ad
          pyrovelocity_data_path: models/larry_tips_model2/pyrovelocity.pkl
          metrics_path: models/larry_tips_model2/metrics.json
          run_info_path: models/larry_tips_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: true
            batch_size: 4000
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: state_info
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 1000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/larry_tips_model2/loss_plot.png
    outs:
    - path: models/larry_tips_model2/loss_plot.png
      md5: 630c6d0b5bda3a771e19546b23582a18
      size: 13501
    - path: models/larry_tips_model2/metrics.json
      md5: 57eb4e587e844c1f811dd68887e20717
      size: 152
    - path: models/larry_tips_model2/model
      md5: 12352896c442dabc0d58b7246c883954.dir
      size: 1297258
      nfiles: 1
    - path: models/larry_tips_model2/pyrovelocity.pkl
      md5: 52d63551f18a58477150a01d48cbb16f
      size: 323695520
    - path: models/larry_tips_model2/run_info.json
      md5: 4c4f30b7cb0e8cdfe8390154219f282e
      size: 457
    - path: models/larry_tips_model2/trained.h5ad
      md5: 91e6c0f96a69f7e19b40c464bd478b43
      size: 2366818330
  summarize_larry_tips_model2:
    cmd: python summarize.py reports.model_summary.summarize=[larry_tips_model2]
    deps:
    - path: models/larry_tips_model2/pyrovelocity.pkl
      md5: 52d63551f18a58477150a01d48cbb16f
      size: 323695520
    - path: models/larry_tips_model2/trained.h5ad
      md5: 91e6c0f96a69f7e19b40c464bd478b43
      size: 2366818330
    - path: summarize.py
      md5: d395a6eab97f8b322434852832f216d8
      size: 9469
    params:
      config.yaml:
        model_training.larry_tips_model2:
          path: models/larry_tips_model2
          model_path: models/larry_tips_model2/model
          input_data_path: data/processed/larry_tips_processed.h5ad
          trained_data_path: models/larry_tips_model2/trained.h5ad
          pyrovelocity_data_path: models/larry_tips_model2/pyrovelocity.pkl
          metrics_path: models/larry_tips_model2/metrics.json
          run_info_path: models/larry_tips_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: true
            batch_size: 4000
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: state_info
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 1000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/larry_tips_model2/loss_plot.png
        reports.model_summary.larry_tips_model2:
          path: reports/larry_tips_model2
          dataframe_path: data/processed/larry_tips_model2_dataframe.pkl.zst
          shared_time_plot: reports/larry_tips_model2/shared_time.pdf
          volcano_plot: reports/larry_tips_model2/volcano.pdf
          rainbow_plot: reports/larry_tips_model2/rainbow.pdf
          uncertainty_param_plot: reports/larry_tips_model2/param_uncertainties.pdf
          vector_field_plot: reports/larry_tips_model2/vector_field.pdf
          biomarker_selection_plot: reports/larry_tips_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/larry_tips_model2/markers_phaseportrait.pdf
    outs:
    - path: data/processed/larry_tips_model2_dataframe.pkl.zst
      md5: 4baed90a859b857667bf246d3d9ec24c
      size: 50020146
    - path: reports/larry_tips_model2/rainbow.pdf
      md5: 301fef4b42fb7e88f726f1d23ccf13ec
      size: 3100598
    - path: reports/larry_tips_model2/rainbow.pdf.png
      md5: 209553cb237e0e8c1cdda5cbe6014b85
      size: 1456954
    - path: reports/larry_tips_model2/shared_time.pdf
      md5: 2b312c09d59225fe90d1883928ce3a2a
      size: 445510
    - path: reports/larry_tips_model2/vector_field.pdf
      md5: 776bcc0b662fe822d2b9c1d545320961
      size: 224051
    - path: reports/larry_tips_model2/vector_field.pdf.png
      md5: 492ec117609df81723a32f62bebea0a1
      size: 489310
    - path: reports/larry_tips_model2/volcano.pdf
      md5: ffa9f121da6d238c0a600c0e695308ea
      size: 21178
