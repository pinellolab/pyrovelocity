schema: '2.0'
stages:
  data_download_pancreas:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pancreas]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
  preprocess_pancreas:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pancreas]
    deps:
    - path: data/external/endocrinogenesis_day15.h5ad
      md5: 783ec70c72fd895eeea28c07735efc27
      size: 52477898
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pancreas:
          data_file: endocrinogenesis_day15.h5ad
          dl_root: data/Pancreas
          dl_path: data/Pancreas/endocrinogenesis_day15.h5ad
          rel_path: data/external/endocrinogenesis_day15.h5ad
          url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad
          derived:
            process_method: load_data
            process_args:
              process_cytotrace: true
            rel_path: data/processed/pancreas_processed.h5ad
    outs:
    - path: data/processed/pancreas_processed.h5ad
      md5: 14f5abed25caaaaf7be172657b809b96
      size: 424775272
  train_pancreas_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model1]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 14f5abed25caaaaf7be172657b809b96
      size: 424775272
    - path: train.py
      md5: 0e7c46a112eab9290b48ad4f3deecaaa
      size: 8684
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
    outs:
    - path: models/pancreas_model1/loss_plot.png
      md5: 92574c7781f07bea7769485cbb51b8f0
      size: 12280
    - path: models/pancreas_model1/metrics.json
      md5: 8a58d40c3dbf03d1f8ae3d6756987294
      size: 153
    - path: models/pancreas_model1/model
      md5: 01a834cc913bee9b83398cd3c4141edb.dir
      size: 635690
      nfiles: 1
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 12657556fb88c99c401d1dad10806b60
      size: 952193370
    - path: models/pancreas_model1/run_info.json
      md5: 56548d50e9a284ad7fe205fee9a9aac5
      size: 436
    - path: models/pancreas_model1/trained.h5ad
      md5: 2c06a73016cb3473236a168940ce2d36
      size: 489882800
  data_download_pbmc68k:
    cmd: python data_download.py data_external.sources=[scvelo] data_external.scvelo.download=[pbmc68k]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
  preprocess_pbmc68k:
    cmd: python preprocess.py data_external.sources=[scvelo] data_external.scvelo.process=[pbmc68k]
    deps:
    - path: data/external/pbmc68k.h5ad
      md5: ee0953e5fb994bc3cec05d4cf638ac79
      size: 123707283
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.scvelo.pbmc68k:
          data_file: pbmc68k.h5ad
          dl_root: data/PBMC
          dl_path: data/PBMC/pbmc68k.h5ad
          rel_path: data/external/pbmc68k.h5ad
          url: https://ndownloader.figshare.com/files/27686886
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pbmc68k_processed.h5ad
    outs:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
  train_pbmc68k_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model1]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
    - path: train.py
      md5: 0e7c46a112eab9290b48ad4f3deecaaa
      size: 8684
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
    outs:
    - path: models/pbmc68k_model1/loss_plot.png
      md5: b3611aef38768b4c5e8b367bdc297914
      size: 16571
    - path: models/pbmc68k_model1/metrics.json
      md5: 285aa3ff720486f73ca019c503d4da6f
      size: 156
    - path: models/pbmc68k_model1/model
      md5: c4d5fd3ae78eb4f58ecba93c6d37fa67.dir
      size: 1705450
      nfiles: 1
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: ebfaaa9af527a448a9e765bfc5098ab4
      size: 3774928157
    - path: models/pbmc68k_model1/run_info.json
      md5: 04a109058ca8f9e01c32b50d8a56c57d
      size: 435
    - path: models/pbmc68k_model1/trained.h5ad
      md5: d4f921404f59bbbf0eee5414e2b4d50e
      size: 2465547357
  figure2:
    cmd: python fig2/figure.py
    deps:
    - path: fig2/figure.py
      md5: ff1ac53128478106cf019fc967bd35c4
      size: 19573
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 12657556fb88c99c401d1dad10806b60
      size: 952193370
    - path: models/pancreas_model1/trained.h5ad
      md5: 2c06a73016cb3473236a168940ce2d36
      size: 489882800
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: ebfaaa9af527a448a9e765bfc5098ab4
      size: 3774928157
    - path: models/pbmc68k_model1/trained.h5ad
      md5: d4f921404f59bbbf0eee5414e2b4d50e
      size: 2465547357
    params:
      config.yaml:
        reports.figure2:
          tag: fig2
          path: reports/fig2
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf
          pancreas_model1:
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_markers_phaseportrait.pdf
      md5: b65a0f6f1adfd9a7083ace84b42d20be
      size: 4548720
    - path: reports/fig2/fig2_markers_selection_scatterplot.tif
      md5: 2bf4528b73112ead7cbdb1f28362850b
      size: 6125606
    - path: reports/fig2/fig2_param_uncertainties.pdf
      md5: 3a1cd195091c314165daa1f0b9a78bb5
      size: 79990
    - path: reports/fig2/fig2_raw_gene_selection_model1.svg
      md5: d2f16ff9b9fd9aae304a240f17e62320
      size: 49297135
    - path: reports/fig2/fig2_raw_gene_selection_model1.tif
      md5: cc2583c166a244e5e40fa96e57f037ab
      size: 19864142
  plot_pancreas_model1:
    cmd: python fig2/fig2_pancreas_plot.py
    deps:
    - path: fig2/fig2_pancreas_plot.py
      md5: 9760277a8b45c2994e44f0ebc69b26e1
      size: 5816
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 12657556fb88c99c401d1dad10806b60
      size: 952193370
    - path: models/pancreas_model1/trained.h5ad
      md5: 2c06a73016cb3473236a168940ce2d36
      size: 489882800
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.figure2.pancreas_model1:
          shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf
          volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf
          rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf
          vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf
    outs:
    - path: reports/fig2/fig2_pancreas_rainbow.pdf
      md5: 70f2b06cba969b1a584b837b202a5347
      size: 673574
    - path: reports/fig2/fig2_pancreas_shared_time.pdf
      md5: 9854ceb35f296d3aef20d3c0fac1008e
      size: 659903
    - path: reports/fig2/fig2_pancreas_vector_field.pdf
      md5: 1087c334ced8b7a27bad0c41e319856c
      size: 407981
    - path: reports/fig2/fig2_pancreas_volcano.pdf
      md5: c4ba39e4cdcaae03de0e5473d569aa07
      size: 21304
  data_download_larry:
    cmd: python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.pyrovelocity.larry:
          data_file: larry.h5ad
          dl_root: data/external
          dl_path: data/external/larry.h5ad
          rel_path: data/external/larry.h5ad
          url: https://ndownloader.figshare.com/files/37028569
          derived:
            process_method: ''
            process_args: {}
            rel_path: data/processed/larry_processed.h5ad
    outs:
    - path: data/external/larry.h5ad
      md5: d618305c0ee0e41570b1147e63df332a
      size: 1525338690
  train_pancreas_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pancreas_model2]
    deps:
    - path: data/processed/pancreas_processed.h5ad
      md5: 14f5abed25caaaaf7be172657b809b96
      size: 424775272
    - path: train.py
      md5: 0e7c46a112eab9290b48ad4f3deecaaa
      size: 8684
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
    outs:
    - path: models/pancreas_model2/loss_plot.png
      md5: 8a8de154eb3e3ad3c1f11264eadedacd
      size: 11500
    - path: models/pancreas_model2/metrics.json
      md5: 24b5a4137151fdba8a7b470a05355c00
      size: 158
    - path: models/pancreas_model2/model
      md5: b8a6140e59342a7d268932d79fec1cea.dir
      size: 923626
      nfiles: 1
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 9896fb7464045315a83b15ae343d5221
      size: 65873440
    - path: models/pancreas_model2/run_info.json
      md5: 0be3891fab0080142f1b05c27be68b43
      size: 455
    - path: models/pancreas_model2/trained.h5ad
      md5: cbada7aa408196272718a9123ba79b3c
      size: 489882800
  train_pbmc68k_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pbmc68k_model2]
    deps:
    - path: data/processed/pbmc68k_processed.h5ad
      md5: 2ce0431688675264a85a1419bb4726f6
      size: 1890424441
    - path: train.py
      md5: 0e7c46a112eab9290b48ad4f3deecaaa
      size: 8684
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
    outs:
    - path: models/pbmc68k_model2/loss_plot.png
      md5: 020f5dba782c1ca953fd078be78ea5e3
      size: 16215
    - path: models/pbmc68k_model2/metrics.json
      md5: 15f3d70c1d2ff589c7f6a86b0eddafff
      size: 156
    - path: models/pbmc68k_model2/model
      md5: ea06d17a708c8a5e2ca27ef0216903fe.dir
      size: 1768618
      nfiles: 1
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 073d21fa1594648dac0856b73d9f3d68
      size: 304685921
    - path: models/pbmc68k_model2/run_info.json
      md5: bead9e112ce6065ec0b8853653c9f371
      size: 435
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 78e3c7608fa71637865b1853f6efd96e
      size: 2465547357
  figureS3:
    cmd: python figS3/figure.py
    deps:
    - path: figS3/figure.py
      md5: 26fb835fc33be2700fe9e65a9f236c9a
      size: 12921
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 9896fb7464045315a83b15ae343d5221
      size: 65873440
    - path: models/pancreas_model2/trained.h5ad
      md5: cbada7aa408196272718a9123ba79b3c
      size: 489882800
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 073d21fa1594648dac0856b73d9f3d68
      size: 304685921
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 78e3c7608fa71637865b1853f6efd96e
      size: 2465547357
    params:
      config.yaml:
        reports.figureS3:
          tag: figS3
          path: reports/figS3
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg
    outs:
    - path: reports/figS3/figS3_raw_gene_selection_model2.svg
      md5: fa7f43196d7cdc9504f75ccb32a3afe3
      size: 49177027
    - path: reports/figS3/figS3_raw_gene_selection_model2.tif
      md5: 0c9fdafad22013c66f8f86573f8c9c95
      size: 19732046
  data_download_pons:
    cmd: python data_download.py data_external.sources=[velocyto] data_external.velocyto.download=[pons]
    deps:
    - path: data_download.py
      md5: 391e26ebb263cd5e550f9365c4a7f21f
      size: 2881
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
  preprocess_pons:
    cmd: python preprocess.py data_external.sources=[velocyto] data_external.velocyto.process=[pons]
    deps:
    - path: data/external/oligo_lite.h5ad
      md5: 82f5e9f9736e556662f56653d2f927ab
      size: 82166707
    - path: preprocess.py
      md5: bf09c86fc25b1d1a98b9aa1c5fa04361
      size: 2757
    params:
      config.yaml:
        base:
          log_level: INFO
        data_external.velocyto.pons:
          data_file: oligo_lite.h5ad
          dl_root: data/external
          dl_path: data/external/oligo_lite.h5ad
          rel_path: data/external/oligo_lite.h5ad
          url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad
          derived:
            process_method: load_data
            process_args: {}
            rel_path: data/processed/pons_processed.h5ad
    outs:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
  train_pons_model1:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model1]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
    - path: train.py
      md5: 0e7c46a112eab9290b48ad4f3deecaaa
      size: 8684
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
    outs:
    - path: models/pons_model1/loss_plot.png
      md5: b58e7329e8cc7f2d4d68cae8a6afe19d
      size: 12073
    - path: models/pons_model1/metrics.json
      md5: 518a2201bd026b0ba1b8333b7d73087a
      size: 154
    - path: models/pons_model1/model
      md5: dab160ed540f4fc967bdc2306ef131a9.dir
      size: 697386
      nfiles: 1
    - path: models/pons_model1/pyrovelocity.pkl
      md5: a7d463557710d28fbde20b2af18a1aba
      size: 1609608288
    - path: models/pons_model1/run_info.json
      md5: 7fa487fb2f638995cf1e669e9befcda8
      size: 432
    - path: models/pons_model1/trained.h5ad
      md5: 648ab9670db5285c9c17defc92de86ef
      size: 855745190
  train_pons_model2:
    cmd: /usr/bin/time -v python train.py model_training.train=[pons_model2]
    deps:
    - path: data/processed/pons_processed.h5ad
      md5: 5175aab14f09c1a4b50ebbdd631ef083
      size: 740860850
    - path: train.py
      md5: 0e7c46a112eab9290b48ad4f3deecaaa
      size: 8684
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
    outs:
    - path: models/pons_model2/loss_plot.png
      md5: 4a0ae00f44c012ab0d90fa82d57a11ec
      size: 12093
    - path: models/pons_model2/metrics.json
      md5: a7fbfcc37be877070c4b5bc504c4e237
      size: 156
    - path: models/pons_model2/model
      md5: 4b1b6de73d382224887c26cf2fd18fb0.dir
      size: 985386
      nfiles: 1
    - path: models/pons_model2/pyrovelocity.pkl
      md5: d79e01cfe2e250d48ccf245120d2c043
      size: 109608400
    - path: models/pons_model2/run_info.json
      md5: 165e674b605e6ca5a4122a2ca86213ba
      size: 432
    - path: models/pons_model2/trained.h5ad
      md5: 56ea0f1773ba92f27f1670a486729621
      size: 855745190
  summarize_pancreas_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model1]
    deps:
    - path: models/pancreas_model1/pyrovelocity.pkl
      md5: 12657556fb88c99c401d1dad10806b60
      size: 952193370
    - path: models/pancreas_model1/trained.h5ad
      md5: 2c06a73016cb3473236a168940ce2d36
      size: 489882800
    - path: summarize.py
      md5: 4181b7b924bd90c6d4a762e7d5493c41
      size: 6998
    params:
      config.yaml:
        model_training.pancreas_model1:
          path: models/pancreas_model1
          model_path: models/pancreas_model1/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model1/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl
          metrics_path: models/pancreas_model1/metrics.json
          run_info_path: models/pancreas_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model1/loss_plot.png
        reports.model_summary.pancreas_model1:
          path: reports/pancreas_model1
          shared_time_plot: reports/pancreas_model1/shared_time.pdf
          volcano_plot: reports/pancreas_model1/volcano.pdf
          rainbow_plot: reports/pancreas_model1/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model1/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pancreas_model1/rainbow.pdf
      md5: cd47f48fc2dd695ce366381f8a102409
      size: 673574
    - path: reports/pancreas_model1/rainbow.pdf.png
      md5: b7d5256461fdce30a32605f72bafd553
      size: 2076300
    - path: reports/pancreas_model1/vector_field.pdf
      md5: 1747b90fb32304ac7c2774d034824808
      size: 397543
    - path: reports/pancreas_model1/vector_field.pdf.png
      md5: 52b32bae85976453665c5f60b5a575bd
      size: 691091
    - path: reports/pancreas_model1/volcano.pdf
      md5: 91be8f396803006cb2ee179c7c7def9e
      size: 21304
  summarize_pancreas_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pancreas_model2]
    deps:
    - path: models/pancreas_model2/pyrovelocity.pkl
      md5: 9896fb7464045315a83b15ae343d5221
      size: 65873440
    - path: models/pancreas_model2/trained.h5ad
      md5: cbada7aa408196272718a9123ba79b3c
      size: 489882800
    - path: summarize.py
      md5: 4181b7b924bd90c6d4a762e7d5493c41
      size: 6998
    params:
      config.yaml:
        model_training.pancreas_model2:
          path: models/pancreas_model2
          model_path: models/pancreas_model2/model
          input_data_path: data/processed/pancreas_processed.h5ad
          trained_data_path: models/pancreas_model2/trained.h5ad
          pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl
          metrics_path: models/pancreas_model2/metrics.json
          run_info_path: models/pancreas_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: clusters
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pancreas_model2/loss_plot.png
        reports.model_summary.pancreas_model2:
          path: reports/pancreas_model2
          shared_time_plot: reports/pancreas_model2/shared_time.pdf
          volcano_plot: reports/pancreas_model2/volcano.pdf
          rainbow_plot: reports/pancreas_model2/rainbow.pdf
          uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf
          vector_field_plot: reports/pancreas_model2/vector_field.pdf
          biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pancreas_model2/rainbow.pdf
      md5: 4d4cd6d77c201245bf35c2c7375d4934
      size: 674523
    - path: reports/pancreas_model2/rainbow.pdf.png
      md5: a053e9fbf0755a4fa529e92e3ef03f45
      size: 1592710
    - path: reports/pancreas_model2/vector_field.pdf
      md5: c50a8c0607dddbafa4571a7aceeabace
      size: 397586
    - path: reports/pancreas_model2/vector_field.pdf.png
      md5: 2bff17b5b0187728de366ba4f0b02cd3
      size: 698541
    - path: reports/pancreas_model2/volcano.pdf
      md5: e1f1a28bb2989048234c680231602f8d
      size: 20347
  summarize_pbmc68k_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model1]
    deps:
    - path: models/pbmc68k_model1/pyrovelocity.pkl
      md5: ebfaaa9af527a448a9e765bfc5098ab4
      size: 3774928157
    - path: models/pbmc68k_model1/trained.h5ad
      md5: d4f921404f59bbbf0eee5414e2b4d50e
      size: 2465547357
    - path: summarize.py
      md5: 4181b7b924bd90c6d4a762e7d5493c41
      size: 6998
    params:
      config.yaml:
        model_training.pbmc68k_model1:
          path: models/pbmc68k_model1
          model_path: models/pbmc68k_model1/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model1/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model1/metrics.json
          run_info_path: models/pbmc68k_model1/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model1/loss_plot.png
        reports.model_summary.pbmc68k_model1:
          path: reports/pbmc68k_model1
          shared_time_plot: reports/pbmc68k_model1/shared_time.pdf
          volcano_plot: reports/pbmc68k_model1/volcano.pdf
          rainbow_plot: reports/pbmc68k_model1/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model1/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pbmc68k_model1/rainbow.pdf
      md5: 0fe0d4d51deba59cbc3186eeadb4643a
      size: 11031762
    - path: reports/pbmc68k_model1/rainbow.pdf.png
      md5: b4c31e65e4b6747ceb6991b9bba5db23
      size: 1268122
    - path: reports/pbmc68k_model1/vector_field.pdf
      md5: cfdaf0b1692235acb2a834aac7f81aa8
      size: 1033651
    - path: reports/pbmc68k_model1/vector_field.pdf.png
      md5: 78430a988d1f4c4ae7ac8d4ad321f451
      size: 1201689
    - path: reports/pbmc68k_model1/volcano.pdf
      md5: 74f4b4f68b1b54e0888814c28274c991
      size: 22273
  summarize_pbmc68k_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pbmc68k_model2]
    deps:
    - path: models/pbmc68k_model2/pyrovelocity.pkl
      md5: 073d21fa1594648dac0856b73d9f3d68
      size: 304685921
    - path: models/pbmc68k_model2/trained.h5ad
      md5: 78e3c7608fa71637865b1853f6efd96e
      size: 2465547357
    - path: summarize.py
      md5: 4181b7b924bd90c6d4a762e7d5493c41
      size: 6998
    params:
      config.yaml:
        model_training.pbmc68k_model2:
          path: models/pbmc68k_model2
          model_path: models/pbmc68k_model2/model
          input_data_path: data/processed/pbmc68k_processed.h5ad
          trained_data_path: models/pbmc68k_model2/trained.h5ad
          pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl
          metrics_path: models/pbmc68k_model2/metrics.json
          run_info_path: models/pbmc68k_model2/run_info.json
          vector_field_parameters:
            basis: tsne
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pbmc68k_model2/loss_plot.png
        reports.model_summary.pbmc68k_model2:
          path: reports/pbmc68k_model2
          shared_time_plot: reports/pbmc68k_model2/shared_time.pdf
          volcano_plot: reports/pbmc68k_model2/volcano.pdf
          rainbow_plot: reports/pbmc68k_model2/rainbow.pdf
          uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf
          vector_field_plot: reports/pbmc68k_model2/vector_field.pdf
          biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pbmc68k_model2/rainbow.pdf
      md5: 9367ebfe8a89f07f6db969c878639d06
      size: 11383839
    - path: reports/pbmc68k_model2/rainbow.pdf.png
      md5: f21a38a0d5f4aafc64a19666e0c6042b
      size: 2414280
    - path: reports/pbmc68k_model2/vector_field.pdf
      md5: 32185ec82aa2fe893d423336ccc29157
      size: 1033622
    - path: reports/pbmc68k_model2/vector_field.pdf.png
      md5: 813190b1897a4ae2006db59490b6d281
      size: 1196210
    - path: reports/pbmc68k_model2/volcano.pdf
      md5: d4fd9c65f86d724c52c30d44075ffdd5
      size: 20455
  summarize_pons_model1:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model1]
    deps:
    - path: models/pons_model1/pyrovelocity.pkl
      md5: a7d463557710d28fbde20b2af18a1aba
      size: 1609608288
    - path: models/pons_model1/trained.h5ad
      md5: 648ab9670db5285c9c17defc92de86ef
      size: 855745190
    - path: summarize.py
      md5: 4181b7b924bd90c6d4a762e7d5493c41
      size: 6998
    params:
      config.yaml:
        model_training.pons_model1:
          path: models/pons_model1
          model_path: models/pons_model1/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model1/trained.h5ad
          pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl
          metrics_path: models/pons_model1/metrics.json
          run_info_path: models/pons_model1/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto_t0_constraint
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: false
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model1/loss_plot.png
        reports.model_summary.pons_model1:
          path: reports/pons_model1
          shared_time_plot: reports/pons_model1/shared_time.pdf
          volcano_plot: reports/pons_model1/volcano.pdf
          rainbow_plot: reports/pons_model1/rainbow.pdf
          uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf
          vector_field_plot: reports/pons_model1/vector_field.pdf
          biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf
    outs:
    - path: reports/pons_model1/rainbow.pdf
      md5: 65755d1c30ff175e2ddf2b6f9d45ee0d
      size: 1055175
    - path: reports/pons_model1/rainbow.pdf.png
      md5: a27917bfbf967a693c53a350d1ffe1f6
      size: 981998
    - path: reports/pons_model1/vector_field.pdf
      md5: 6c088ff4228da17331189682bb61e68d
      size: 376834
    - path: reports/pons_model1/vector_field.pdf.png
      md5: 53e3ce42c92c56c78efe530d4fac5775
      size: 789157
    - path: reports/pons_model1/volcano.pdf
      md5: 5a295de5b058b29730ceb3572c00f075
      size: 20404
  summarize_pons_model2:
    cmd: python summarize.py reports.model_summary.summarize=[pons_model2]
    deps:
    - path: models/pons_model2/pyrovelocity.pkl
      md5: d79e01cfe2e250d48ccf245120d2c043
      size: 109608400
    - path: models/pons_model2/trained.h5ad
      md5: 56ea0f1773ba92f27f1670a486729621
      size: 855745190
    - path: summarize.py
      md5: 4181b7b924bd90c6d4a762e7d5493c41
      size: 6998
    params:
      config.yaml:
        model_training.pons_model2:
          path: models/pons_model2
          model_path: models/pons_model2/model
          input_data_path: data/processed/pons_processed.h5ad
          trained_data_path: models/pons_model2/trained.h5ad
          pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl
          metrics_path: models/pons_model2/metrics.json
          run_info_path: models/pons_model2/run_info.json
          vector_field_parameters:
            basis: umap
          training_parameters:
            _target_: pyrovelocity.api.train_model
            _partial_: true
            guide_type: auto
            model_type: auto
            svi_train: false
            batch_size: -1
            train_size: 1.0
            use_gpu: 0
            likelihood: Poisson
            num_samples: 30
            log_every: 100
            cell_state: celltype
            patient_improve: 0.0001
            patient_init: 45
            seed: 99
            lr: 0.01
            max_epochs: 2000
            include_prior: true
            library_size: true
            offset: true
            input_type: raw
            cell_specific_kinetics:
            kinetics_num: 2
            loss_plot_path: models/pons_model2/loss_plot.png
        reports.model_summary.pons_model2:
          path: reports/pons_model2
          shared_time_plot: reports/pons_model2/shared_time.pdf
          volcano_plot: reports/pons_model2/volcano.pdf
          rainbow_plot: reports/pons_model2/rainbow.pdf
          uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf
          vector_field_plot: reports/pons_model2/vector_field.pdf
          biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif
          biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf
    outs:
    - path: reports/pons_model2/rainbow.pdf
      md5: 4bc391d34d82a32af9c7e1c23f69db3d
      size: 1078988
    - path: reports/pons_model2/rainbow.pdf.png
      md5: bd073ea0cc3d313a9286b954adfd7ef1
      size: 954742
    - path: reports/pons_model2/vector_field.pdf
      md5: b4011d71c2cb40999c4c576c5fb59588
      size: 377125
    - path: reports/pons_model2/vector_field.pdf.png
      md5: 395a23f79d7e6a5f8a696ac8b1b7f896
      size: 798031
    - path: reports/pons_model2/volcano.pdf
      md5: f0b94256a7cad5fabd1e6b700a6d0079
      size: 21539
