Stage 'data_download_pancreas' didn't change, skipping
Stage 'preprocess_pancreas' didn't change, skipping
Stage 'train_pancreas_model1' didn't change, skipping
Stage 'data_download_simulate' didn't change, skipping
Stage 'preprocess_simulate' didn't change, skipping
Stage 'train_simulate_model1' didn't change, skipping
Stage 'summarize_simulate_model1' didn't change, skipping
Stage 'train_pancreas_model2' didn't change, skipping
Stage 'data_download_larry_neu' didn't change, skipping
Stage 'plot_pancreas_model1' didn't change, skipping
Stage 'data_download_pons' didn't change, skipping
Stage 'preprocess_pons' didn't change, skipping
Stage 'train_pons_model1' didn't change, skipping
Stage 'data_download_pbmc68k' didn't change, skipping
Stage 'preprocess_pbmc68k' didn't change, skipping
Stage 'train_pbmc68k_model2' didn't change, skipping
Stage 'train_pons_model2' didn't change, skipping
Stage 'data_download_larry' didn't change, skipping
Stage 'figureS3' didn't change, skipping
Stage 'preprocess_larry_neu' didn't change, skipping
Stage 'train_pbmc68k_model1' didn't change, skipping
Stage 'summarize_pbmc68k_model1' didn't change, skipping
Stage 'summarize_pancreas_model2' didn't change, skipping
Stage 'train_simulate_model2' didn't change, skipping
Running stage 'data_download_larry_mono':
> python data_download.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.download=[larry_mono]
CONFIG
├── base
│   └── log_level: INFO                                                                                                                                                                                     
│                                                                                                                                                                                                           
├── paths
│   └── data: data                                                                                                                                                                                          
│       models: models                                                                                                                                                                                      
│       reports: reports                                                                                                                                                                                    
│                                                                                                                                                                                                           
├── data_external
│   └── root_path: data/external                                                                                                                                                                            
│       processed_path: data/processed                                                                                                                                                                      
│       sources:                                                                                                                                                                                            
│       - pyrovelocity                                                                                                                                                                                      
│       simulate:                                                                                                                                                                                           
│         download:                                                                                                                                                                                         
│         - medium                                                                                                                                                                                          
│         process:                                                                                                                                                                                          
│         - medium                                                                                                                                                                                          
│         sources:                                                                                                                                                                                          
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data                                                                                                                                  
│         medium:                                                                                                                                                                                           
│           data_file: simulated_medium.h5ad                                                                                                                                                                
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/simulated_medium.h5ad                                                                                                                                                    
│           rel_path: data/external/simulated_medium.h5ad                                                                                                                                                   
│           url: https://storage.googleapis.com/pyrovelocity/data/simulated_medium.h5ad                                                                                                                     
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                      
│       velocyto:                                                                                                                                                                                           
│         download:                                                                                                                                                                                         
│         - pons                                                                                                                                                                                            
│         process:                                                                                                                                                                                          
│         - pons                                                                                                                                                                                            
│         sources:                                                                                                                                                                                          
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data                                                                                                                                  
│         pons:                                                                                                                                                                                             
│           data_file: oligo_lite.h5ad                                                                                                                                                                      
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/oligo_lite.h5ad                                                                                                                                                          
│           rel_path: data/external/oligo_lite.h5ad                                                                                                                                                         
│           url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad                                                                                                                           
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/pons_processed.h5ad                                                                                                                                                  
│       scvelo:                                                                                                                                                                                             
│         download:                                                                                                                                                                                         
│         - pancreas                                                                                                                                                                                        
│         - pbmc68k                                                                                                                                                                                         
│         process:                                                                                                                                                                                          
│         - pancreas                                                                                                                                                                                        
│         - pbmc68k                                                                                                                                                                                         
│         sources:                                                                                                                                                                                          
│           figshare_root_url: https://ndownloader.figshare.com/files                                                                                                                                       
│           scvelo_root_url: https://github.com/theislab/scvelo_notebooks/raw/master                                                                                                                        
│         pancreas:                                                                                                                                                                                         
│           data_file: endocrinogenesis_day15.h5ad                                                                                                                                                          
│           dl_root: data/Pancreas                                                                                                                                                                          
│           dl_path: data/Pancreas/endocrinogenesis_day15.h5ad                                                                                                                                              
│           rel_path: data/external/endocrinogenesis_day15.h5ad                                                                                                                                             
│           url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad                                                                                          
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args:                                                                                                                                                                                 
│               process_cytotrace: true                                                                                                                                                                     
│             rel_path: data/processed/pancreas_processed.h5ad                                                                                                                                              
│         pbmc68k:                                                                                                                                                                                          
│           data_file: pbmc68k.h5ad                                                                                                                                                                         
│           dl_root: data/PBMC                                                                                                                                                                              
│           dl_path: data/PBMC/pbmc68k.h5ad                                                                                                                                                                 
│           rel_path: data/external/pbmc68k.h5ad                                                                                                                                                            
│           url: https://ndownloader.figshare.com/files/27686886                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                               
│       pyrovelocity:                                                                                                                                                                                       
│         download:                                                                                                                                                                                         
│         - larry_mono                                                                                                                                                                                      
│         process: []                                                                                                                                                                                       
│         sources:                                                                                                                                                                                          
│           figshare_root_url: https://ndownloader.figshare.com/files                                                                                                                                       
│         larry:                                                                                                                                                                                            
│           data_file: larry.h5ad                                                                                                                                                                           
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry.h5ad                                                                                                                                                               
│           rel_path: data/external/larry.h5ad                                                                                                                                                              
│           url: https://ndownloader.figshare.com/files/37028569                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_processed.h5ad                                                                                                                                                 
│         larry_mono:                                                                                                                                                                                       
│           data_file: larry_mono.h5ad                                                                                                                                                                      
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry_mono.h5ad                                                                                                                                                          
│           rel_path: data/external/larry_mono.h5ad                                                                                                                                                         
│           url: https://ndownloader.figshare.com/files/37028572                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_mono_processed.h5ad                                                                                                                                            
│         larry_neu:                                                                                                                                                                                        
│           data_file: larry_neu.h5ad                                                                                                                                                                       
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry_neu.h5ad                                                                                                                                                           
│           rel_path: data/external/larry_neu.h5ad                                                                                                                                                          
│           url: https://ndownloader.figshare.com/files/37028575                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_neu_processed.h5ad                                                                                                                                             
│                                                                                                                                                                                                           
├── model_training
│   └── train:                                                                                                                                                                                              
│       - simulate_model1                                                                                                                                                                                   
│       - simulate_model2                                                                                                                                                                                   
│       - pancreas_model1                                                                                                                                                                                   
│       - pancreas_model2                                                                                                                                                                                   
│       - pbmc68k_model1                                                                                                                                                                                    
│       - pbmc68k_model2                                                                                                                                                                                    
│       - pons_model1                                                                                                                                                                                       
│       - pons_model2                                                                                                                                                                                       
│       - larry_model2                                                                                                                                                                                      
│       - larry_mono_model2                                                                                                                                                                                 
│       - larry_neu_model2                                                                                                                                                                                  
│       simulate_model1:                                                                                                                                                                                    
│         path: models/medium_model1                                                                                                                                                                        
│         model_path: models/medium_model1/model                                                                                                                                                            
│         input_data_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                   
│         trained_data_path: models/medium_model1/trained.h5ad                                                                                                                                              
│         pyrovelocity_data_path: models/medium_model1/pyrovelocity.pkl                                                                                                                                     
│         metrics_path: models/medium_model1/metrics.json                                                                                                                                                   
│         run_info_path: models/medium_model1/run_info.json                                                                                                                                                 
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: leiden                                                                                                                                                                              
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 4000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/medium_model1/loss_plot.png                                                                                                                                              
│       simulate_model2:                                                                                                                                                                                    
│         path: models/medium_model2                                                                                                                                                                        
│         model_path: models/medium_model2/model                                                                                                                                                            
│         input_data_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                   
│         trained_data_path: models/medium_model2/trained.h5ad                                                                                                                                              
│         pyrovelocity_data_path: models/medium_model2/pyrovelocity.pkl                                                                                                                                     
│         metrics_path: models/medium_model2/metrics.json                                                                                                                                                   
│         run_info_path: models/medium_model2/run_info.json                                                                                                                                                 
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: leiden                                                                                                                                                                              
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 4000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/medium_model2/loss_plot.png                                                                                                                                              
│       pancreas_model1:                                                                                                                                                                                    
│         path: models/pancreas_model1                                                                                                                                                                      
│         model_path: models/pancreas_model1/model                                                                                                                                                          
│         input_data_path: data/processed/pancreas_processed.h5ad                                                                                                                                           
│         trained_data_path: models/pancreas_model1/trained.h5ad                                                                                                                                            
│         pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl                                                                                                                                   
│         metrics_path: models/pancreas_model1/metrics.json                                                                                                                                                 
│         run_info_path: models/pancreas_model1/run_info.json                                                                                                                                               
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: clusters                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pancreas_model1/loss_plot.png                                                                                                                                            
│       pancreas_model2:                                                                                                                                                                                    
│         path: models/pancreas_model2                                                                                                                                                                      
│         model_path: models/pancreas_model2/model                                                                                                                                                          
│         input_data_path: data/processed/pancreas_processed.h5ad                                                                                                                                           
│         trained_data_path: models/pancreas_model2/trained.h5ad                                                                                                                                            
│         pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl                                                                                                                                   
│         metrics_path: models/pancreas_model2/metrics.json                                                                                                                                                 
│         run_info_path: models/pancreas_model2/run_info.json                                                                                                                                               
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: clusters                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pancreas_model2/loss_plot.png                                                                                                                                            
│       pbmc68k_model1:                                                                                                                                                                                     
│         path: models/pbmc68k_model1                                                                                                                                                                       
│         model_path: models/pbmc68k_model1/model                                                                                                                                                           
│         input_data_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                            
│         trained_data_path: models/pbmc68k_model1/trained.h5ad                                                                                                                                             
│         pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl                                                                                                                                    
│         metrics_path: models/pbmc68k_model1/metrics.json                                                                                                                                                  
│         run_info_path: models/pbmc68k_model1/run_info.json                                                                                                                                                
│         vector_field_parameters:                                                                                                                                                                          
│           basis: tsne                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pbmc68k_model1/loss_plot.png                                                                                                                                             
│       pbmc68k_model2:                                                                                                                                                                                     
│         path: models/pbmc68k_model2                                                                                                                                                                       
│         model_path: models/pbmc68k_model2/model                                                                                                                                                           
│         input_data_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                            
│         trained_data_path: models/pbmc68k_model2/trained.h5ad                                                                                                                                             
│         pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl                                                                                                                                    
│         metrics_path: models/pbmc68k_model2/metrics.json                                                                                                                                                  
│         run_info_path: models/pbmc68k_model2/run_info.json                                                                                                                                                
│         vector_field_parameters:                                                                                                                                                                          
│           basis: tsne                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pbmc68k_model2/loss_plot.png                                                                                                                                             
│       pons_model1:                                                                                                                                                                                        
│         path: models/pons_model1                                                                                                                                                                          
│         model_path: models/pons_model1/model                                                                                                                                                              
│         input_data_path: data/processed/pons_processed.h5ad                                                                                                                                               
│         trained_data_path: models/pons_model1/trained.h5ad                                                                                                                                                
│         pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl                                                                                                                                       
│         metrics_path: models/pons_model1/metrics.json                                                                                                                                                     
│         run_info_path: models/pons_model1/run_info.json                                                                                                                                                   
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pons_model1/loss_plot.png                                                                                                                                                
│       pons_model2:                                                                                                                                                                                        
│         path: models/pons_model2                                                                                                                                                                          
│         model_path: models/pons_model2/model                                                                                                                                                              
│         input_data_path: data/processed/pons_processed.h5ad                                                                                                                                               
│         trained_data_path: models/pons_model2/trained.h5ad                                                                                                                                                
│         pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl                                                                                                                                       
│         metrics_path: models/pons_model2/metrics.json                                                                                                                                                     
│         run_info_path: models/pons_model2/run_info.json                                                                                                                                                   
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pons_model2/loss_plot.png                                                                                                                                                
│       larry_model2:                                                                                                                                                                                       
│         path: models/larry_model2                                                                                                                                                                         
│         model_path: models/larry_model2/model                                                                                                                                                             
│         input_data_path: data/processed/larry_processed.h5ad                                                                                                                                              
│         trained_data_path: models/larry_model2/trained.h5ad                                                                                                                                               
│         pyrovelocity_data_path: models/larry_model2/pyrovelocity.pkl                                                                                                                                      
│         metrics_path: models/larry_model2/metrics.json                                                                                                                                                    
│         run_info_path: models/larry_model2/run_info.json                                                                                                                                                  
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_model2/loss_plot.png                                                                                                                                               
│       larry_mono_model2:                                                                                                                                                                                  
│         path: models/larry_mono_model2                                                                                                                                                                    
│         model_path: models/larry_mono_model2/model                                                                                                                                                        
│         input_data_path: data/processed/larry_mono_processed.h5ad                                                                                                                                         
│         trained_data_path: models/larry_mono_model2/trained.h5ad                                                                                                                                          
│         pyrovelocity_data_path: models/larry_mono_model2/pyrovelocity.pkl                                                                                                                                 
│         metrics_path: models/larry_mono_model2/metrics.json                                                                                                                                               
│         run_info_path: models/larry_mono_model2/run_info.json                                                                                                                                             
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_mono_model2/loss_plot.png                                                                                                                                          
│       larry_neu_model2:                                                                                                                                                                                   
│         path: models/larry_neu_model2                                                                                                                                                                     
│         model_path: models/larry_neu_model2/model                                                                                                                                                         
│         input_data_path: data/processed/larry_neu_processed.h5ad                                                                                                                                          
│         trained_data_path: models/larry_neu_model2/trained.h5ad                                                                                                                                           
│         pyrovelocity_data_path: models/larry_neu_model2/pyrovelocity.pkl                                                                                                                                  
│         metrics_path: models/larry_neu_model2/metrics.json                                                                                                                                                
│         run_info_path: models/larry_neu_model2/run_info.json                                                                                                                                              
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_neu_model2/loss_plot.png                                                                                                                                           
│                                                                                                                                                                                                           
└── reports
    └── model_summary:                                                                                                                                                                                      
          summarize:                                                                                                                                                                                        
          - simulate_model1                                                                                                                                                                                 
          - simulate_model2                                                                                                                                                                                 
          - pancreas_model1                                                                                                                                                                                 
          - pancreas_model2                                                                                                                                                                                 
          - pbmc68k_model1                                                                                                                                                                                  
          - pbmc68k_model2                                                                                                                                                                                  
          - pons_model1                                                                                                                                                                                     
          - pons_model2                                                                                                                                                                                     
          simulate_model1:                                                                                                                                                                                  
            path: reports/medium_model1                                                                                                                                                                     
            dataframe_path: data/processed/medium_model1_dataframe.pkl.zst                                                                                                                                  
            shared_time_plot: reports/medium_model1/shared_time.pdf                                                                                                                                         
            volcano_plot: reports/medium_model1/volcano.pdf                                                                                                                                                 
            rainbow_plot: reports/medium_model1/rainbow.pdf                                                                                                                                                 
            uncertainty_param_plot: reports/medium_model1/param_uncertainties.pdf                                                                                                                           
            vector_field_plot: reports/medium_model1/vector_field.pdf                                                                                                                                       
            biomarker_selection_plot: reports/medium_model1/markers_selection_scatterplot.tif                                                                                                               
            biomarker_phaseportrait_plot: reports/medium_model1/markers_phaseportrait.pdf                                                                                                                   
          simulate_model2:                                                                                                                                                                                  
            path: reports/medium_model2                                                                                                                                                                     
            dataframe_path: data/processed/medium_model2_dataframe.pkl.zst                                                                                                                                  
            shared_time_plot: reports/medium_model2/shared_time.pdf                                                                                                                                         
            volcano_plot: reports/medium_model2/volcano.pdf                                                                                                                                                 
            rainbow_plot: reports/medium_model2/rainbow.pdf                                                                                                                                                 
            uncertainty_param_plot: reports/medium_model2/param_uncertainties.pdf                                                                                                                           
            vector_field_plot: reports/medium_model2/vector_field.pdf                                                                                                                                       
            biomarker_selection_plot: reports/medium_model2/markers_selection_scatterplot.tif                                                                                                               
            biomarker_phaseportrait_plot: reports/medium_model2/markers_phaseportrait.pdf                                                                                                                   
          pancreas_model1:                                                                                                                                                                                  
            path: reports/pancreas_model1                                                                                                                                                                   
            dataframe_path: data/processed/pancreas_model1_dataframe.pkl.zst                                                                                                                                
            shared_time_plot: reports/pancreas_model1/shared_time.pdf                                                                                                                                       
            volcano_plot: reports/pancreas_model1/volcano.pdf                                                                                                                                               
            rainbow_plot: reports/pancreas_model1/rainbow.pdf                                                                                                                                               
            uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf                                                                                                                         
            vector_field_plot: reports/pancreas_model1/vector_field.pdf                                                                                                                                     
            biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif                                                                                                             
            biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf                                                                                                                 
          pancreas_model2:                                                                                                                                                                                  
            path: reports/pancreas_model2                                                                                                                                                                   
            dataframe_path: data/processed/pancreas_model2_dataframe.pkl.zst                                                                                                                                
            shared_time_plot: reports/pancreas_model2/shared_time.pdf                                                                                                                                       
            volcano_plot: reports/pancreas_model2/volcano.pdf                                                                                                                                               
            rainbow_plot: reports/pancreas_model2/rainbow.pdf                                                                                                                                               
            uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf                                                                                                                         
            vector_field_plot: reports/pancreas_model2/vector_field.pdf                                                                                                                                     
            biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif                                                                                                             
            biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf                                                                                                                 
          pbmc68k_model1:                                                                                                                                                                                   
            path: reports/pbmc68k_model1                                                                                                                                                                    
            dataframe_path: data/processed/pbmc68k_model1_dataframe.pkl.zst                                                                                                                                 
            shared_time_plot: reports/pbmc68k_model1/shared_time.pdf                                                                                                                                        
            volcano_plot: reports/pbmc68k_model1/volcano.pdf                                                                                                                                                
            rainbow_plot: reports/pbmc68k_model1/rainbow.pdf                                                                                                                                                
            uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf                                                                                                                          
            vector_field_plot: reports/pbmc68k_model1/vector_field.pdf                                                                                                                                      
            biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif                                                                                                              
            biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf                                                                                                                  
          pbmc68k_model2:                                                                                                                                                                                   
            path: reports/pbmc68k_model2                                                                                                                                                                    
            dataframe_path: data/processed/pbmc68k_model2_dataframe.pkl.zst                                                                                                                                 
            shared_time_plot: reports/pbmc68k_model2/shared_time.pdf                                                                                                                                        
            volcano_plot: reports/pbmc68k_model2/volcano.pdf                                                                                                                                                
            rainbow_plot: reports/pbmc68k_model2/rainbow.pdf                                                                                                                                                
            uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf                                                                                                                          
            vector_field_plot: reports/pbmc68k_model2/vector_field.pdf                                                                                                                                      
            biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif                                                                                                              
            biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf                                                                                                                  
          pons_model1:                                                                                                                                                                                      
            path: reports/pons_model1                                                                                                                                                                       
            dataframe_path: data/processed/pons_model1_dataframe.pkl.zst                                                                                                                                    
            shared_time_plot: reports/pons_model1/shared_time.pdf                                                                                                                                           
            volcano_plot: reports/pons_model1/volcano.pdf                                                                                                                                                   
            rainbow_plot: reports/pons_model1/rainbow.pdf                                                                                                                                                   
            uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf                                                                                                                             
            vector_field_plot: reports/pons_model1/vector_field.pdf                                                                                                                                         
            biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif                                                                                                                 
            biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf                                                                                                                     
          pons_model2:                                                                                                                                                                                      
            path: reports/pons_model2                                                                                                                                                                       
            dataframe_path: data/processed/pons_model2_dataframe.pkl.zst                                                                                                                                    
            shared_time_plot: reports/pons_model2/shared_time.pdf                                                                                                                                           
            volcano_plot: reports/pons_model2/volcano.pdf                                                                                                                                                   
            rainbow_plot: reports/pons_model2/rainbow.pdf                                                                                                                                                   
            uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf                                                                                                                             
            vector_field_plot: reports/pons_model2/vector_field.pdf                                                                                                                                         
            biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif                                                                                                                 
            biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf                                                                                                                     
        figure2:                                                                                                                                                                                            
          tag: fig2                                                                                                                                                                                         
          path: reports/fig2                                                                                                                                                                                
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif                                                                                                                                         
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg                                                                                                                                         
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif                                                                                                                     
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf                                                                                                                         
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf                                                                                                                            
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf                                                                                                                    
          pancreas_model1:                                                                                                                                                                                  
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf                                                                                                                                    
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf                                                                                                                                            
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf                                                                                                                                            
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf                                                                                                                                  
        figureS3:                                                                                                                                                                                           
          tag: figS3                                                                                                                                                                                        
          path: reports/figS3                                                                                                                                                                               
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif                                                                                                                                       
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg                                                                                                                                       
                                                                                                                                                                                                            
{'T': AnnData object with n_obs × n_vars = 23420 × 1594
    obs: 'Accession', 'Chromosome', 'End', 'Start', 'Strand', 'cytotrace', 'cytotrace_corrs'
    var: 'Library', 'Cell barcode', 'time_info', 'Starting population', 'state_info', 'Well', 'SPRING-x', 'SPRING-y', 'gcs', 'cytotrace', 'counts', 'clones', 'clonei', 'time', 'batch'
    varm: 'X_clone', 'X_emb', 'clone_vector_emb'
    layers: 'ambiguous', 'matrix', 'spliced', 'unspliced',
 'X': <1594x23420 sparse matrix of type '<class 'numpy.float32'>'
	with 2344805 stored elements in Compressed Sparse Row format>,
 'file': Backing file manager: no file is set.,
 'filename': None,
 'is_view': False,
 'isbacked': False,
 'isview': False,
 'layers': Layers with keys: ambiguous, matrix, spliced, unspliced,
 'n_obs': 1594,
 'n_vars': 23420,
 'obs':                           Library       Cell barcode  ...  time batch
d6_2_2:AGCGTGGTTCGACGGT-0  d6_2_2  AGCGTGGT-TCGACGGT  ...   NaN     0
d6_2_2:TGGAAAGCGTTCAACT-0  d6_2_2  TGGAAAGC-GTTCAACT  ...   NaN     0
d6_2_2:ACGACGACTTAGGACC-0  d6_2_2  ACGACGAC-TTAGGACC  ...   NaN     0
d6_2_2:AGGACACACAATACTT-0  d6_2_2  AGGACACA-CAATACTT  ...   NaN     0
d6_2_2:TACCCTGCACCACGCT-0  d6_2_2  TACCCTGC-ACCACGCT  ...   NaN     0
...                           ...                ...  ...   ...   ...
1-122-1                       NaN                NaN  ...   4.0     1
2-122-1                       NaN                NaN  ...   6.0     1
0-123-1                       NaN                NaN  ...   2.0     1
1-123-1                       NaN                NaN  ...   4.0     1
2-123-1                       NaN                NaN  ...   6.0     1

[1594 rows x 15 columns],
 'obs_names': Index(['d6_2_2:AGCGTGGTTCGACGGT-0', 'd6_2_2:TGGAAAGCGTTCAACT-0',
       'd6_2_2:ACGACGACTTAGGACC-0', 'd6_2_2:AGGACACACAATACTT-0',
       'd6_2_2:TACCCTGCACCACGCT-0', 'd6_2_2:CGTTGCCTTGGTATGA-0',
       'd6_2_2:GGTTAGGGAGCGCCTT-0', 'd6_2_2:AAAGAGGCTCTCAACC-0',
       'd6_2_2:GGACTTCTTGGTTTCT-0', 'd6_2_2:AGCTCCACCAGTCCCT-0',
       ...
       '2-120-1', '0-121-1', '1-121-1', '2-121-1', '0-122-1', '1-122-1',
       '2-122-1', '0-123-1', '1-123-1', '2-123-1'],
      dtype='object', length=1594),
 'obsm': AxisArrays with keys: X_clone, X_emb, clone_vector_emb,
 'obsp': PairwiseArrays with keys: ,
 'raw': None,
 'shape': (1594, 23420),
 'uns': OverloadedDict, wrapping:
	OrderedDict()
With overloaded keys:
	['neighbors'].,
 'var':         Accession Chromosome       End  ...  Strand cytotrace       cytotrace_corrs
Xkr4         Xkr4          1   3671498  ...       -      True  0.004398419183210533
Rp1           Rp1          1   4409241  ...       -      None                  None
Sox17       Sox17          1   4496413  ...       -      None                  None
Mrpl15     Mrpl15          1   4785726  ...       -      True    0.2110625586691954
Rgs20       Rgs20          1   5070285  ...       -      None                  None
...           ...        ...       ...  ...     ...       ...                   ...
Rbm31y     Rbm31y          Y  17402718  ...       +      None                  None
Gm20831   Gm20831          Y  17967598  ...       +      None                  None
Ssty1       Ssty1          Y  21097715  ...       +      None                  None
Sly           Sly          Y  75222053  ...       +      None                  None
Erdr1       Erdr1          Y  90816465  ...       +      True     0.138787235955999

[23420 rows x 7 columns],
 'var_names': Index(['Xkr4', 'Rp1', 'Sox17', 'Mrpl15', 'Rgs20', 'Npbwr1', 'Sntg1',
       '2610203C22Rik', 'Mybl1', 'Vcpip1',
       ...
       'Gm10256', 'Gm10352', 'Gm4064', 'Gm3376', 'Gm20877', 'Rbm31y',
       'Gm20831', 'Ssty1', 'Sly', 'Erdr1'],
      dtype='object', length=23420),
 'varm': AxisArrays with keys: ,
 'varp': PairwiseArrays with keys: }
AnnData object with n_obs × n_vars = 1594 × 23420
    obs:
        Library,
        Cell barcode,
        time_info,
        Starting population,
        state_info,
        Well,
        SPRING-x,
        SPRING-y,
        gcs,
        cytotrace,
        counts,
        clones,
        clonei,
        time,
        batch,
    var:
        Accession,
        Chromosome,
        End,
        Start,
        Strand,
        cytotrace,
        cytotrace_corrs,
    obsm:
        X_clone,
        X_emb,
        clone_vector_emb,
    layers:
        ambiguous,
        matrix,
        spliced,
        unspliced,
Updating lock file 'dvc.lock'

Running stage 'preprocess_larry_mono':
> python preprocess.py data_external.sources=[pyrovelocity] data_external.pyrovelocity.process=[larry_mono]
CONFIG
├── base
│   └── log_level: INFO                                                                                                                                                                                     
│                                                                                                                                                                                                           
├── paths
│   └── data: data                                                                                                                                                                                          
│       models: models                                                                                                                                                                                      
│       reports: reports                                                                                                                                                                                    
│                                                                                                                                                                                                           
├── data_external
│   └── root_path: data/external                                                                                                                                                                            
│       processed_path: data/processed                                                                                                                                                                      
│       sources:                                                                                                                                                                                            
│       - pyrovelocity                                                                                                                                                                                      
│       simulate:                                                                                                                                                                                           
│         download:                                                                                                                                                                                         
│         - medium                                                                                                                                                                                          
│         process:                                                                                                                                                                                          
│         - medium                                                                                                                                                                                          
│         sources:                                                                                                                                                                                          
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data                                                                                                                                  
│         medium:                                                                                                                                                                                           
│           data_file: simulated_medium.h5ad                                                                                                                                                                
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/simulated_medium.h5ad                                                                                                                                                    
│           rel_path: data/external/simulated_medium.h5ad                                                                                                                                                   
│           url: https://storage.googleapis.com/pyrovelocity/data/simulated_medium.h5ad                                                                                                                     
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                      
│       velocyto:                                                                                                                                                                                           
│         download:                                                                                                                                                                                         
│         - pons                                                                                                                                                                                            
│         process:                                                                                                                                                                                          
│         - pons                                                                                                                                                                                            
│         sources:                                                                                                                                                                                          
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data                                                                                                                                  
│         pons:                                                                                                                                                                                             
│           data_file: oligo_lite.h5ad                                                                                                                                                                      
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/oligo_lite.h5ad                                                                                                                                                          
│           rel_path: data/external/oligo_lite.h5ad                                                                                                                                                         
│           url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad                                                                                                                           
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/pons_processed.h5ad                                                                                                                                                  
│       scvelo:                                                                                                                                                                                             
│         download:                                                                                                                                                                                         
│         - pancreas                                                                                                                                                                                        
│         - pbmc68k                                                                                                                                                                                         
│         process:                                                                                                                                                                                          
│         - pancreas                                                                                                                                                                                        
│         - pbmc68k                                                                                                                                                                                         
│         sources:                                                                                                                                                                                          
│           figshare_root_url: https://ndownloader.figshare.com/files                                                                                                                                       
│           scvelo_root_url: https://github.com/theislab/scvelo_notebooks/raw/master                                                                                                                        
│         pancreas:                                                                                                                                                                                         
│           data_file: endocrinogenesis_day15.h5ad                                                                                                                                                          
│           dl_root: data/Pancreas                                                                                                                                                                          
│           dl_path: data/Pancreas/endocrinogenesis_day15.h5ad                                                                                                                                              
│           rel_path: data/external/endocrinogenesis_day15.h5ad                                                                                                                                             
│           url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad                                                                                          
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args:                                                                                                                                                                                 
│               process_cytotrace: true                                                                                                                                                                     
│             rel_path: data/processed/pancreas_processed.h5ad                                                                                                                                              
│         pbmc68k:                                                                                                                                                                                          
│           data_file: pbmc68k.h5ad                                                                                                                                                                         
│           dl_root: data/PBMC                                                                                                                                                                              
│           dl_path: data/PBMC/pbmc68k.h5ad                                                                                                                                                                 
│           rel_path: data/external/pbmc68k.h5ad                                                                                                                                                            
│           url: https://ndownloader.figshare.com/files/27686886                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                               
│       pyrovelocity:                                                                                                                                                                                       
│         download:                                                                                                                                                                                         
│         - larry                                                                                                                                                                                           
│         process:                                                                                                                                                                                          
│         - larry_mono                                                                                                                                                                                      
│         sources:                                                                                                                                                                                          
│           figshare_root_url: https://ndownloader.figshare.com/files                                                                                                                                       
│         larry:                                                                                                                                                                                            
│           data_file: larry.h5ad                                                                                                                                                                           
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry.h5ad                                                                                                                                                               
│           rel_path: data/external/larry.h5ad                                                                                                                                                              
│           url: https://ndownloader.figshare.com/files/37028569                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_processed.h5ad                                                                                                                                                 
│         larry_mono:                                                                                                                                                                                       
│           data_file: larry_mono.h5ad                                                                                                                                                                      
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry_mono.h5ad                                                                                                                                                          
│           rel_path: data/external/larry_mono.h5ad                                                                                                                                                         
│           url: https://ndownloader.figshare.com/files/37028572                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_mono_processed.h5ad                                                                                                                                            
│         larry_neu:                                                                                                                                                                                        
│           data_file: larry_neu.h5ad                                                                                                                                                                       
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry_neu.h5ad                                                                                                                                                           
│           rel_path: data/external/larry_neu.h5ad                                                                                                                                                          
│           url: https://ndownloader.figshare.com/files/37028575                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_neu_processed.h5ad                                                                                                                                             
│                                                                                                                                                                                                           
├── model_training
│   └── train:                                                                                                                                                                                              
│       - simulate_model1                                                                                                                                                                                   
│       - simulate_model2                                                                                                                                                                                   
│       - pancreas_model1                                                                                                                                                                                   
│       - pancreas_model2                                                                                                                                                                                   
│       - pbmc68k_model1                                                                                                                                                                                    
│       - pbmc68k_model2                                                                                                                                                                                    
│       - pons_model1                                                                                                                                                                                       
│       - pons_model2                                                                                                                                                                                       
│       - larry_model2                                                                                                                                                                                      
│       - larry_mono_model2                                                                                                                                                                                 
│       - larry_neu_model2                                                                                                                                                                                  
│       simulate_model1:                                                                                                                                                                                    
│         path: models/medium_model1                                                                                                                                                                        
│         model_path: models/medium_model1/model                                                                                                                                                            
│         input_data_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                   
│         trained_data_path: models/medium_model1/trained.h5ad                                                                                                                                              
│         pyrovelocity_data_path: models/medium_model1/pyrovelocity.pkl                                                                                                                                     
│         metrics_path: models/medium_model1/metrics.json                                                                                                                                                   
│         run_info_path: models/medium_model1/run_info.json                                                                                                                                                 
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: leiden                                                                                                                                                                              
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 4000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/medium_model1/loss_plot.png                                                                                                                                              
│       simulate_model2:                                                                                                                                                                                    
│         path: models/medium_model2                                                                                                                                                                        
│         model_path: models/medium_model2/model                                                                                                                                                            
│         input_data_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                   
│         trained_data_path: models/medium_model2/trained.h5ad                                                                                                                                              
│         pyrovelocity_data_path: models/medium_model2/pyrovelocity.pkl                                                                                                                                     
│         metrics_path: models/medium_model2/metrics.json                                                                                                                                                   
│         run_info_path: models/medium_model2/run_info.json                                                                                                                                                 
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: leiden                                                                                                                                                                              
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 4000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/medium_model2/loss_plot.png                                                                                                                                              
│       pancreas_model1:                                                                                                                                                                                    
│         path: models/pancreas_model1                                                                                                                                                                      
│         model_path: models/pancreas_model1/model                                                                                                                                                          
│         input_data_path: data/processed/pancreas_processed.h5ad                                                                                                                                           
│         trained_data_path: models/pancreas_model1/trained.h5ad                                                                                                                                            
│         pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl                                                                                                                                   
│         metrics_path: models/pancreas_model1/metrics.json                                                                                                                                                 
│         run_info_path: models/pancreas_model1/run_info.json                                                                                                                                               
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: clusters                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pancreas_model1/loss_plot.png                                                                                                                                            
│       pancreas_model2:                                                                                                                                                                                    
│         path: models/pancreas_model2                                                                                                                                                                      
│         model_path: models/pancreas_model2/model                                                                                                                                                          
│         input_data_path: data/processed/pancreas_processed.h5ad                                                                                                                                           
│         trained_data_path: models/pancreas_model2/trained.h5ad                                                                                                                                            
│         pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl                                                                                                                                   
│         metrics_path: models/pancreas_model2/metrics.json                                                                                                                                                 
│         run_info_path: models/pancreas_model2/run_info.json                                                                                                                                               
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: clusters                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pancreas_model2/loss_plot.png                                                                                                                                            
│       pbmc68k_model1:                                                                                                                                                                                     
│         path: models/pbmc68k_model1                                                                                                                                                                       
│         model_path: models/pbmc68k_model1/model                                                                                                                                                           
│         input_data_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                            
│         trained_data_path: models/pbmc68k_model1/trained.h5ad                                                                                                                                             
│         pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl                                                                                                                                    
│         metrics_path: models/pbmc68k_model1/metrics.json                                                                                                                                                  
│         run_info_path: models/pbmc68k_model1/run_info.json                                                                                                                                                
│         vector_field_parameters:                                                                                                                                                                          
│           basis: tsne                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pbmc68k_model1/loss_plot.png                                                                                                                                             
│       pbmc68k_model2:                                                                                                                                                                                     
│         path: models/pbmc68k_model2                                                                                                                                                                       
│         model_path: models/pbmc68k_model2/model                                                                                                                                                           
│         input_data_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                            
│         trained_data_path: models/pbmc68k_model2/trained.h5ad                                                                                                                                             
│         pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl                                                                                                                                    
│         metrics_path: models/pbmc68k_model2/metrics.json                                                                                                                                                  
│         run_info_path: models/pbmc68k_model2/run_info.json                                                                                                                                                
│         vector_field_parameters:                                                                                                                                                                          
│           basis: tsne                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pbmc68k_model2/loss_plot.png                                                                                                                                             
│       pons_model1:                                                                                                                                                                                        
│         path: models/pons_model1                                                                                                                                                                          
│         model_path: models/pons_model1/model                                                                                                                                                              
│         input_data_path: data/processed/pons_processed.h5ad                                                                                                                                               
│         trained_data_path: models/pons_model1/trained.h5ad                                                                                                                                                
│         pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl                                                                                                                                       
│         metrics_path: models/pons_model1/metrics.json                                                                                                                                                     
│         run_info_path: models/pons_model1/run_info.json                                                                                                                                                   
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pons_model1/loss_plot.png                                                                                                                                                
│       pons_model2:                                                                                                                                                                                        
│         path: models/pons_model2                                                                                                                                                                          
│         model_path: models/pons_model2/model                                                                                                                                                              
│         input_data_path: data/processed/pons_processed.h5ad                                                                                                                                               
│         trained_data_path: models/pons_model2/trained.h5ad                                                                                                                                                
│         pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl                                                                                                                                       
│         metrics_path: models/pons_model2/metrics.json                                                                                                                                                     
│         run_info_path: models/pons_model2/run_info.json                                                                                                                                                   
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pons_model2/loss_plot.png                                                                                                                                                
│       larry_model2:                                                                                                                                                                                       
│         path: models/larry_model2                                                                                                                                                                         
│         model_path: models/larry_model2/model                                                                                                                                                             
│         input_data_path: data/processed/larry_processed.h5ad                                                                                                                                              
│         trained_data_path: models/larry_model2/trained.h5ad                                                                                                                                               
│         pyrovelocity_data_path: models/larry_model2/pyrovelocity.pkl                                                                                                                                      
│         metrics_path: models/larry_model2/metrics.json                                                                                                                                                    
│         run_info_path: models/larry_model2/run_info.json                                                                                                                                                  
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_model2/loss_plot.png                                                                                                                                               
│       larry_mono_model2:                                                                                                                                                                                  
│         path: models/larry_mono_model2                                                                                                                                                                    
│         model_path: models/larry_mono_model2/model                                                                                                                                                        
│         input_data_path: data/processed/larry_mono_processed.h5ad                                                                                                                                         
│         trained_data_path: models/larry_mono_model2/trained.h5ad                                                                                                                                          
│         pyrovelocity_data_path: models/larry_mono_model2/pyrovelocity.pkl                                                                                                                                 
│         metrics_path: models/larry_mono_model2/metrics.json                                                                                                                                               
│         run_info_path: models/larry_mono_model2/run_info.json                                                                                                                                             
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_mono_model2/loss_plot.png                                                                                                                                          
│       larry_neu_model2:                                                                                                                                                                                   
│         path: models/larry_neu_model2                                                                                                                                                                     
│         model_path: models/larry_neu_model2/model                                                                                                                                                         
│         input_data_path: data/processed/larry_neu_processed.h5ad                                                                                                                                          
│         trained_data_path: models/larry_neu_model2/trained.h5ad                                                                                                                                           
│         pyrovelocity_data_path: models/larry_neu_model2/pyrovelocity.pkl                                                                                                                                  
│         metrics_path: models/larry_neu_model2/metrics.json                                                                                                                                                
│         run_info_path: models/larry_neu_model2/run_info.json                                                                                                                                              
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_neu_model2/loss_plot.png                                                                                                                                           
│                                                                                                                                                                                                           
└── reports
    └── model_summary:                                                                                                                                                                                      
          summarize:                                                                                                                                                                                        
          - simulate_model1                                                                                                                                                                                 
          - simulate_model2                                                                                                                                                                                 
          - pancreas_model1                                                                                                                                                                                 
          - pancreas_model2                                                                                                                                                                                 
          - pbmc68k_model1                                                                                                                                                                                  
          - pbmc68k_model2                                                                                                                                                                                  
          - pons_model1                                                                                                                                                                                     
          - pons_model2                                                                                                                                                                                     
          simulate_model1:                                                                                                                                                                                  
            path: reports/medium_model1                                                                                                                                                                     
            dataframe_path: data/processed/medium_model1_dataframe.pkl.zst                                                                                                                                  
            shared_time_plot: reports/medium_model1/shared_time.pdf                                                                                                                                         
            volcano_plot: reports/medium_model1/volcano.pdf                                                                                                                                                 
            rainbow_plot: reports/medium_model1/rainbow.pdf                                                                                                                                                 
            uncertainty_param_plot: reports/medium_model1/param_uncertainties.pdf                                                                                                                           
            vector_field_plot: reports/medium_model1/vector_field.pdf                                                                                                                                       
            biomarker_selection_plot: reports/medium_model1/markers_selection_scatterplot.tif                                                                                                               
            biomarker_phaseportrait_plot: reports/medium_model1/markers_phaseportrait.pdf                                                                                                                   
          simulate_model2:                                                                                                                                                                                  
            path: reports/medium_model2                                                                                                                                                                     
            dataframe_path: data/processed/medium_model2_dataframe.pkl.zst                                                                                                                                  
            shared_time_plot: reports/medium_model2/shared_time.pdf                                                                                                                                         
            volcano_plot: reports/medium_model2/volcano.pdf                                                                                                                                                 
            rainbow_plot: reports/medium_model2/rainbow.pdf                                                                                                                                                 
            uncertainty_param_plot: reports/medium_model2/param_uncertainties.pdf                                                                                                                           
            vector_field_plot: reports/medium_model2/vector_field.pdf                                                                                                                                       
            biomarker_selection_plot: reports/medium_model2/markers_selection_scatterplot.tif                                                                                                               
            biomarker_phaseportrait_plot: reports/medium_model2/markers_phaseportrait.pdf                                                                                                                   
          pancreas_model1:                                                                                                                                                                                  
            path: reports/pancreas_model1                                                                                                                                                                   
            dataframe_path: data/processed/pancreas_model1_dataframe.pkl.zst                                                                                                                                
            shared_time_plot: reports/pancreas_model1/shared_time.pdf                                                                                                                                       
            volcano_plot: reports/pancreas_model1/volcano.pdf                                                                                                                                               
            rainbow_plot: reports/pancreas_model1/rainbow.pdf                                                                                                                                               
            uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf                                                                                                                         
            vector_field_plot: reports/pancreas_model1/vector_field.pdf                                                                                                                                     
            biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif                                                                                                             
            biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf                                                                                                                 
          pancreas_model2:                                                                                                                                                                                  
            path: reports/pancreas_model2                                                                                                                                                                   
            dataframe_path: data/processed/pancreas_model2_dataframe.pkl.zst                                                                                                                                
            shared_time_plot: reports/pancreas_model2/shared_time.pdf                                                                                                                                       
            volcano_plot: reports/pancreas_model2/volcano.pdf                                                                                                                                               
            rainbow_plot: reports/pancreas_model2/rainbow.pdf                                                                                                                                               
            uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf                                                                                                                         
            vector_field_plot: reports/pancreas_model2/vector_field.pdf                                                                                                                                     
            biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif                                                                                                             
            biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf                                                                                                                 
          pbmc68k_model1:                                                                                                                                                                                   
            path: reports/pbmc68k_model1                                                                                                                                                                    
            dataframe_path: data/processed/pbmc68k_model1_dataframe.pkl.zst                                                                                                                                 
            shared_time_plot: reports/pbmc68k_model1/shared_time.pdf                                                                                                                                        
            volcano_plot: reports/pbmc68k_model1/volcano.pdf                                                                                                                                                
            rainbow_plot: reports/pbmc68k_model1/rainbow.pdf                                                                                                                                                
            uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf                                                                                                                          
            vector_field_plot: reports/pbmc68k_model1/vector_field.pdf                                                                                                                                      
            biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif                                                                                                              
            biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf                                                                                                                  
          pbmc68k_model2:                                                                                                                                                                                   
            path: reports/pbmc68k_model2                                                                                                                                                                    
            dataframe_path: data/processed/pbmc68k_model2_dataframe.pkl.zst                                                                                                                                 
            shared_time_plot: reports/pbmc68k_model2/shared_time.pdf                                                                                                                                        
            volcano_plot: reports/pbmc68k_model2/volcano.pdf                                                                                                                                                
            rainbow_plot: reports/pbmc68k_model2/rainbow.pdf                                                                                                                                                
            uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf                                                                                                                          
            vector_field_plot: reports/pbmc68k_model2/vector_field.pdf                                                                                                                                      
            biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif                                                                                                              
            biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf                                                                                                                  
          pons_model1:                                                                                                                                                                                      
            path: reports/pons_model1                                                                                                                                                                       
            dataframe_path: data/processed/pons_model1_dataframe.pkl.zst                                                                                                                                    
            shared_time_plot: reports/pons_model1/shared_time.pdf                                                                                                                                           
            volcano_plot: reports/pons_model1/volcano.pdf                                                                                                                                                   
            rainbow_plot: reports/pons_model1/rainbow.pdf                                                                                                                                                   
            uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf                                                                                                                             
            vector_field_plot: reports/pons_model1/vector_field.pdf                                                                                                                                         
            biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif                                                                                                                 
            biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf                                                                                                                     
          pons_model2:                                                                                                                                                                                      
            path: reports/pons_model2                                                                                                                                                                       
            dataframe_path: data/processed/pons_model2_dataframe.pkl.zst                                                                                                                                    
            shared_time_plot: reports/pons_model2/shared_time.pdf                                                                                                                                           
            volcano_plot: reports/pons_model2/volcano.pdf                                                                                                                                                   
            rainbow_plot: reports/pons_model2/rainbow.pdf                                                                                                                                                   
            uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf                                                                                                                             
            vector_field_plot: reports/pons_model2/vector_field.pdf                                                                                                                                         
            biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif                                                                                                                 
            biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf                                                                                                                     
        figure2:                                                                                                                                                                                            
          tag: fig2                                                                                                                                                                                         
          path: reports/fig2                                                                                                                                                                                
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif                                                                                                                                         
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg                                                                                                                                         
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif                                                                                                                     
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf                                                                                                                         
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf                                                                                                                            
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf                                                                                                                    
          pancreas_model1:                                                                                                                                                                                  
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf                                                                                                                                    
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf                                                                                                                                            
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf                                                                                                                                            
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf                                                                                                                                  
        figureS3:                                                                                                                                                                                           
          tag: figS3                                                                                                                                                                                        
          path: reports/figS3                                                                                                                                                                               
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif                                                                                                                                       
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg                                                                                                                                       
                                                                                                                                                                                                            
AnnData object with n_obs × n_vars = 1594 × 23420
    obs:
        Library,
        Cell barcode,
        time_info,
        Starting population,
        state_info,
        Well,
        SPRING-x,
        SPRING-y,
        gcs,
        cytotrace,
        counts,
        clones,
        clonei,
        time,
        batch,
    var:
        Accession,
        Chromosome,
        End,
        Start,
        Strand,
        cytotrace,
        cytotrace_corrs,
    obsm:
        X_clone,
        X_emb,
        clone_vector_emb,
    layers:
        ambiguous,
        matrix,
        spliced,
        unspliced,
'raw_unspliced', raw unspliced counts (adata.layers)
'raw_spliced', raw spliced counts (adata.layers)
'u_lib_size_raw', unspliced library size (adata.obs)
's_lib_size_raw', spliced library size (adata.obs)
AnnData object with n_obs × n_vars = 1594 × 23420
    obs:
        Library,
        Cell barcode,
        time_info,
        Starting population,
        state_info,
        Well,
        SPRING-x,
        SPRING-y,
        gcs,
        cytotrace,
        counts,
        clones,
        clonei,
        time,
        batch,
        u_lib_size_raw,
        s_lib_size_raw,
    var:
        Accession,
        Chromosome,
        End,
        Start,
        Strand,
        cytotrace,
        cytotrace_corrs,
    obsm:
        X_clone,
        X_emb,
        clone_vector_emb,
    layers:
        ambiguous,
        matrix,
        spliced,
        unspliced,
        raw_unspliced,
        raw_spliced,
Filtered out 22052 genes that are detected 30 counts (shared).
Normalized count data: X, spliced, unspliced.
Skip filtering by dispersion since number of variables are less than `n_top_genes`.
WARNING: Did not modify X as it looks preprocessed already.
WARNING: You seem to have 161 duplicate cells in your data. Consider removing these via pp.remove_duplicate_cells.
computing neighbors
    finished (0:00:06) --> added 
    'distances' and 'connectivities', weighted adjacency matrices (adata.obsp)
computing moments based on connectivities
    finished (0:00:00) --> added 
    'Ms' and 'Mu', moments of un/spliced abundances (adata.layers)
recovering dynamics (using 8/8 cores)
  0%|          | 0/575 [00:00<?, ?gene/s]
    finished (0:00:28) --> added 
    'fit_pars', fitted parameters for splicing dynamics (adata.var)
computing velocities
    finished (0:00:00) --> added 
    'velocity', velocity vectors for each individual cell (adata.layers)
computing velocity graph (using 8/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:02) --> added 
    'velocity_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_emb', embedded velocity vectors (adata.obsm)
computing terminal states
    identified 2 regions of root cells and 1 region of end points .
    finished (0:00:00) --> added
    'root_cells', root cells of Markov diffusion process (adata.obs)
    'end_points', end points of Markov diffusion process (adata.obs)
computing latent time using root_cells as prior
    finished (0:00:00) --> added 
    'latent_time', shared time (adata.obs)
AnnData object with n_obs × n_vars = 1594 × 1368
    obs:
        Library,
        Cell barcode,
        time_info,
        Starting population,
        state_info,
        Well,
        SPRING-x,
        SPRING-y,
        gcs,
        cytotrace,
        counts,
        clones,
        clonei,
        time,
        batch,
        u_lib_size_raw,
        s_lib_size_raw,
        initial_size_unspliced,
        initial_size_spliced,
        initial_size,
        n_counts,
        leiden,
        velocity_self_transition,
        root_cells,
        end_points,
        velocity_pseudotime,
        latent_time,
    var:
        Accession,
        Chromosome,
        End,
        Start,
        Strand,
        cytotrace,
        cytotrace_corrs,
        fit_r2,
        fit_alpha,
        fit_beta,
        fit_gamma,
        fit_t_,
        fit_scaling,
        fit_std_u,
        fit_std_s,
        fit_likelihood,
        fit_u0,
        fit_s0,
        fit_pval_steady,
        fit_steady_u,
        fit_steady_s,
        fit_variance,
        fit_alignment_scaling,
        velocity_genes,
    uns:
        pca,
        neighbors,
        umap,
        leiden,
        recover_dynamics,
        velocity_params,
        velocity_graph,
        velocity_graph_neg,
    obsm:
        X_clone,
        X_emb,
        clone_vector_emb,
        X_pca,
        X_umap,
        velocity_emb,
    varm:
        PCs,
        loss,
    layers:
        ambiguous,
        matrix,
        spliced,
        unspliced,
        raw_unspliced,
        raw_spliced,
        Ms,
        Mu,
        fit_t,
        fit_tau,
        fit_tau_,
        velocity,
        velocity_u,
    obsp:
        distances,
        connectivities,
{'T': AnnData object with n_obs × n_vars = 1368 × 1594
    obs: 'Accession', 'Chromosome', 'End', 'Start', 'Strand', 'cytotrace', 'cytotrace_corrs', 'fit_r2', 'fit_alpha', 'fit_beta', 'fit_gamma', 'fit_t_', 'fit_scaling', 'fit_std_u', 'fit_std_s', 'fit_likelihood', 'fit_u0', 'fit_s0', 'fit_pval_steady', 'fit_steady_u', 'fit_steady_s', 'fit_variance', 'fit_alignment_scaling', 'velocity_genes'
    var: 'Library', 'Cell barcode', 'time_info', 'Starting population', 'state_info', 'Well', 'SPRING-x', 'SPRING-y', 'gcs', 'cytotrace', 'counts', 'clones', 'clonei', 'time', 'batch', 'u_lib_size_raw', 's_lib_size_raw', 'initial_size_unspliced', 'initial_size_spliced', 'initial_size', 'n_counts', 'leiden', 'velocity_self_transition', 'root_cells', 'end_points', 'velocity_pseudotime', 'latent_time'
    uns: 'pca', 'neighbors', 'umap', 'leiden', 'recover_dynamics', 'velocity_params', 'velocity_graph', 'velocity_graph_neg'
    obsm: 'PCs', 'loss'
    varm: 'X_clone', 'X_emb', 'clone_vector_emb', 'X_pca', 'X_umap', 'velocity_emb'
    layers: 'ambiguous', 'matrix', 'spliced', 'unspliced', 'raw_unspliced', 'raw_spliced', 'Ms', 'Mu', 'fit_t', 'fit_tau', 'fit_tau_', 'velocity', 'velocity_u'
    varp: 'distances', 'connectivities',
 'X': <1594x1368 sparse matrix of type '<class 'numpy.float32'>'
	with 732927 stored elements in Compressed Sparse Row format>,
 'file': Backing file manager: no file is set.,
 'filename': None,
 'is_view': False,
 'isbacked': False,
 'isview': False,
 'layers': Layers with keys: ambiguous, matrix, spliced, unspliced, raw_unspliced, raw_spliced, Ms, Mu, fit_t, fit_tau, fit_tau_, velocity, velocity_u,
 'n_obs': 1594,
 'n_vars': 1368,
 'obs':                           Library  ... latent_time
d6_2_2:AGCGTGGTTCGACGGT-0  d6_2_2  ...    0.748073
d6_2_2:TGGAAAGCGTTCAACT-0  d6_2_2  ...    0.655037
d6_2_2:ACGACGACTTAGGACC-0  d6_2_2  ...    0.559884
d6_2_2:AGGACACACAATACTT-0  d6_2_2  ...    0.753587
d6_2_2:TACCCTGCACCACGCT-0  d6_2_2  ...    0.619026
...                           ...  ...         ...
1-122-1                       NaN  ...    0.536133
2-122-1                       NaN  ...    0.764391
0-123-1                       NaN  ...    0.806337
1-123-1                       NaN  ...    0.523133
2-123-1                       NaN  ...    0.426597

[1594 rows x 27 columns],
 'obs_names': Index(['d6_2_2:AGCGTGGTTCGACGGT-0', 'd6_2_2:TGGAAAGCGTTCAACT-0',
       'd6_2_2:ACGACGACTTAGGACC-0', 'd6_2_2:AGGACACACAATACTT-0',
       'd6_2_2:TACCCTGCACCACGCT-0', 'd6_2_2:CGTTGCCTTGGTATGA-0',
       'd6_2_2:GGTTAGGGAGCGCCTT-0', 'd6_2_2:AAAGAGGCTCTCAACC-0',
       'd6_2_2:GGACTTCTTGGTTTCT-0', 'd6_2_2:AGCTCCACCAGTCCCT-0',
       ...
       '2-120-1', '0-121-1', '1-121-1', '2-121-1', '0-122-1', '1-122-1',
       '2-122-1', '0-123-1', '1-123-1', '2-123-1'],
      dtype='object', length=1594),
 'obsm': AxisArrays with keys: X_clone, X_emb, clone_vector_emb, X_pca, X_umap, velocity_emb,
 'obsp': PairwiseArrays with keys: distances, connectivities,
 'raw': None,
 'shape': (1594, 1368),
 'uns': OverloadedDict, wrapping:
	OrderedDict([('pca', {'params': {'zero_center': True, 'use_highly_variable': False}, 'variance': array([1155.256    ,  583.95337  ,  209.45241  ,  114.5976   ,
         83.939156 ,   72.37645  ,   55.009563 ,   47.800194 ,
         40.394455 ,   34.956158 ,   28.58991  ,   26.798145 ,
         25.94646  ,   23.188902 ,   19.967535 ,   18.39412  ,
         14.815965 ,   13.712895 ,   12.997519 ,   12.212259 ,
         11.198759 ,   10.097146 ,    9.958588 ,    9.280665 ,
          9.0628805,    8.764042 ,    8.243987 ,    7.691316 ,
          7.5829105,    7.4634867], dtype=float32), 'variance_ratio': array([0.3392526 , 0.17148381, 0.06150782, 0.03365275, 0.02464958,
       0.02125408, 0.01615411, 0.01403701, 0.01186224, 0.01026523,
       0.00839572, 0.00786955, 0.00761944, 0.00680966, 0.00586367,
       0.00540162, 0.00435086, 0.00402693, 0.00381685, 0.00358625,
       0.00328863, 0.00296513, 0.00292444, 0.00272536, 0.00266141,
       0.00257365, 0.00242093, 0.00225863, 0.0022268 , 0.00219173],
      dtype=float32)}), ('neighbors', {'connectivities_key': 'connectivities', 'distances_key': 'distances', 'indices': array([[   0,   32, 1521, ..., 1359, 1078, 1183],
       [   1, 1236,  333, ...,  865, 1380,  693],
       [   2, 1139, 1058, ..., 1563, 1179, 1161],
       ...,
       [1591,  374,  380, ...,  335,  803,  458],
       [1592,  986, 1027, ..., 1569, 1485,  321],
       [1593,  277,  583, ..., 1529,  655, 1176]]), 'params': {'n_neighbors': 30, 'method': 'umap', 'metric': 'euclidean', 'n_pcs': 30, 'use_rep': 'X_pca'}}), ('umap', {'params': {'a': 0.583030019901822, 'b': 1.3341669931033755}}), ('leiden', {'params': {'resolution': 1, 'random_state': 0, 'n_iterations': -1}}), ('recover_dynamics', {'fit_connected_states': True, 'fit_basal_transcription': None, 'use_raw': False}), ('velocity_params', {'mode': 'dynamical', 'fit_offset': False, 'perc': [5, 95], 'mode_neighbors': 'distances', 'n_recurse_neighbors': 2, 'embeddings': ['emb']}), ('velocity_graph', <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 128484 stored elements in Compressed Sparse Row format>), ('velocity_graph_neg', <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 122479 stored elements in Compressed Sparse Row format>)])
With overloaded keys:
	['neighbors'].,
 'var':         Accession Chromosome  ...  fit_alignment_scaling  velocity_genes
Tram1       Tram1          1  ...               2.675056            True
Kcnq5       Kcnq5          1  ...               4.232887           False
Uggt1       Uggt1          1  ...                    NaN           False
Aff3         Aff3          1  ...               3.202763           False
Tbc1d8     Tbc1d8          1  ...               2.615137            True
...           ...        ...  ...                    ...             ...
Diap2       Diap2          X  ...                    NaN           False
Huwe1       Huwe1          X  ...                    NaN           False
Smc1a       Smc1a          X  ...                    NaN           False
Kdm5c       Kdm5c          X  ...                    NaN           False
Sh3kbp1   Sh3kbp1          X  ...               3.946390            True

[1368 rows x 24 columns],
 'var_names': Index(['Tram1', 'Kcnq5', 'Uggt1', 'Aff3', 'Tbc1d8', 'Rnf149', 'Nab1', 'Stk17b',
       'Ankrd44', 'Orc2',
       ...
       'Ddx26b', 'Nsdhl', 'Msn', 'Cox7b', 'Sh3bgrl', 'Diap2', 'Huwe1', 'Smc1a',
       'Kdm5c', 'Sh3kbp1'],
      dtype='object', length=1368),
 'varm': AxisArrays with keys: PCs, loss,
 'varp': PairwiseArrays with keys: }
Updating lock file 'dvc.lock'

Running stage 'train_larry_mono_model2':
> /usr/bin/time -v python train.py model_training.train=[larry_mono_model2]
CONFIG
├── base
│   └── log_level: INFO                                                                                                                                                                                     
│                                                                                                                                                                                                           
├── paths
│   └── data: data                                                                                                                                                                                          
│       models: models                                                                                                                                                                                      
│       reports: reports                                                                                                                                                                                    
│                                                                                                                                                                                                           
├── data_external
│   └── root_path: data/external                                                                                                                                                                            
│       processed_path: data/processed                                                                                                                                                                      
│       sources:                                                                                                                                                                                            
│       - simulate                                                                                                                                                                                          
│       - velocyto                                                                                                                                                                                          
│       - scvelo                                                                                                                                                                                            
│       - pyrovelocity                                                                                                                                                                                      
│       simulate:                                                                                                                                                                                           
│         download:                                                                                                                                                                                         
│         - medium                                                                                                                                                                                          
│         process:                                                                                                                                                                                          
│         - medium                                                                                                                                                                                          
│         sources:                                                                                                                                                                                          
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data                                                                                                                                  
│         medium:                                                                                                                                                                                           
│           data_file: simulated_medium.h5ad                                                                                                                                                                
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/simulated_medium.h5ad                                                                                                                                                    
│           rel_path: data/external/simulated_medium.h5ad                                                                                                                                                   
│           url: https://storage.googleapis.com/pyrovelocity/data/simulated_medium.h5ad                                                                                                                     
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                      
│       velocyto:                                                                                                                                                                                           
│         download:                                                                                                                                                                                         
│         - pons                                                                                                                                                                                            
│         process:                                                                                                                                                                                          
│         - pons                                                                                                                                                                                            
│         sources:                                                                                                                                                                                          
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data                                                                                                                                  
│         pons:                                                                                                                                                                                             
│           data_file: oligo_lite.h5ad                                                                                                                                                                      
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/oligo_lite.h5ad                                                                                                                                                          
│           rel_path: data/external/oligo_lite.h5ad                                                                                                                                                         
│           url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5ad                                                                                                                           
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/pons_processed.h5ad                                                                                                                                                  
│       scvelo:                                                                                                                                                                                             
│         download:                                                                                                                                                                                         
│         - pancreas                                                                                                                                                                                        
│         - pbmc68k                                                                                                                                                                                         
│         process:                                                                                                                                                                                          
│         - pancreas                                                                                                                                                                                        
│         - pbmc68k                                                                                                                                                                                         
│         sources:                                                                                                                                                                                          
│           figshare_root_url: https://ndownloader.figshare.com/files                                                                                                                                       
│           scvelo_root_url: https://github.com/theislab/scvelo_notebooks/raw/master                                                                                                                        
│         pancreas:                                                                                                                                                                                         
│           data_file: endocrinogenesis_day15.h5ad                                                                                                                                                          
│           dl_root: data/Pancreas                                                                                                                                                                          
│           dl_path: data/Pancreas/endocrinogenesis_day15.h5ad                                                                                                                                              
│           rel_path: data/external/endocrinogenesis_day15.h5ad                                                                                                                                             
│           url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad                                                                                          
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args:                                                                                                                                                                                 
│               process_cytotrace: true                                                                                                                                                                     
│             rel_path: data/processed/pancreas_processed.h5ad                                                                                                                                              
│         pbmc68k:                                                                                                                                                                                          
│           data_file: pbmc68k.h5ad                                                                                                                                                                         
│           dl_root: data/PBMC                                                                                                                                                                              
│           dl_path: data/PBMC/pbmc68k.h5ad                                                                                                                                                                 
│           rel_path: data/external/pbmc68k.h5ad                                                                                                                                                            
│           url: https://ndownloader.figshare.com/files/27686886                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                               
│       pyrovelocity:                                                                                                                                                                                       
│         download:                                                                                                                                                                                         
│         - larry                                                                                                                                                                                           
│         process: []                                                                                                                                                                                       
│         sources:                                                                                                                                                                                          
│           figshare_root_url: https://ndownloader.figshare.com/files                                                                                                                                       
│         larry:                                                                                                                                                                                            
│           data_file: larry.h5ad                                                                                                                                                                           
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry.h5ad                                                                                                                                                               
│           rel_path: data/external/larry.h5ad                                                                                                                                                              
│           url: https://ndownloader.figshare.com/files/37028569                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_processed.h5ad                                                                                                                                                 
│         larry_mono:                                                                                                                                                                                       
│           data_file: larry_mono.h5ad                                                                                                                                                                      
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry_mono.h5ad                                                                                                                                                          
│           rel_path: data/external/larry_mono.h5ad                                                                                                                                                         
│           url: https://ndownloader.figshare.com/files/37028572                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_mono_processed.h5ad                                                                                                                                            
│         larry_neu:                                                                                                                                                                                        
│           data_file: larry_neu.h5ad                                                                                                                                                                       
│           dl_root: data/external                                                                                                                                                                          
│           dl_path: data/external/larry_neu.h5ad                                                                                                                                                           
│           rel_path: data/external/larry_neu.h5ad                                                                                                                                                          
│           url: https://ndownloader.figshare.com/files/37028575                                                                                                                                            
│           derived:                                                                                                                                                                                        
│             process_method: load_data                                                                                                                                                                     
│             process_args: {}                                                                                                                                                                              
│             rel_path: data/processed/larry_neu_processed.h5ad                                                                                                                                             
│                                                                                                                                                                                                           
├── model_training
│   └── train:                                                                                                                                                                                              
│       - larry_mono_model2                                                                                                                                                                                 
│       simulate_model1:                                                                                                                                                                                    
│         path: models/medium_model1                                                                                                                                                                        
│         model_path: models/medium_model1/model                                                                                                                                                            
│         input_data_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                   
│         trained_data_path: models/medium_model1/trained.h5ad                                                                                                                                              
│         pyrovelocity_data_path: models/medium_model1/pyrovelocity.pkl                                                                                                                                     
│         metrics_path: models/medium_model1/metrics.json                                                                                                                                                   
│         run_info_path: models/medium_model1/run_info.json                                                                                                                                                 
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: leiden                                                                                                                                                                              
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 4000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/medium_model1/loss_plot.png                                                                                                                                              
│       simulate_model2:                                                                                                                                                                                    
│         path: models/medium_model2                                                                                                                                                                        
│         model_path: models/medium_model2/model                                                                                                                                                            
│         input_data_path: data/processed/simulated_medium_processed.h5ad                                                                                                                                   
│         trained_data_path: models/medium_model2/trained.h5ad                                                                                                                                              
│         pyrovelocity_data_path: models/medium_model2/pyrovelocity.pkl                                                                                                                                     
│         metrics_path: models/medium_model2/metrics.json                                                                                                                                                   
│         run_info_path: models/medium_model2/run_info.json                                                                                                                                                 
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: leiden                                                                                                                                                                              
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 4000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/medium_model2/loss_plot.png                                                                                                                                              
│       pancreas_model1:                                                                                                                                                                                    
│         path: models/pancreas_model1                                                                                                                                                                      
│         model_path: models/pancreas_model1/model                                                                                                                                                          
│         input_data_path: data/processed/pancreas_processed.h5ad                                                                                                                                           
│         trained_data_path: models/pancreas_model1/trained.h5ad                                                                                                                                            
│         pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl                                                                                                                                   
│         metrics_path: models/pancreas_model1/metrics.json                                                                                                                                                 
│         run_info_path: models/pancreas_model1/run_info.json                                                                                                                                               
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: clusters                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pancreas_model1/loss_plot.png                                                                                                                                            
│       pancreas_model2:                                                                                                                                                                                    
│         path: models/pancreas_model2                                                                                                                                                                      
│         model_path: models/pancreas_model2/model                                                                                                                                                          
│         input_data_path: data/processed/pancreas_processed.h5ad                                                                                                                                           
│         trained_data_path: models/pancreas_model2/trained.h5ad                                                                                                                                            
│         pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl                                                                                                                                   
│         metrics_path: models/pancreas_model2/metrics.json                                                                                                                                                 
│         run_info_path: models/pancreas_model2/run_info.json                                                                                                                                               
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: clusters                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pancreas_model2/loss_plot.png                                                                                                                                            
│       pbmc68k_model1:                                                                                                                                                                                     
│         path: models/pbmc68k_model1                                                                                                                                                                       
│         model_path: models/pbmc68k_model1/model                                                                                                                                                           
│         input_data_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                            
│         trained_data_path: models/pbmc68k_model1/trained.h5ad                                                                                                                                             
│         pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl                                                                                                                                    
│         metrics_path: models/pbmc68k_model1/metrics.json                                                                                                                                                  
│         run_info_path: models/pbmc68k_model1/run_info.json                                                                                                                                                
│         vector_field_parameters:                                                                                                                                                                          
│           basis: tsne                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pbmc68k_model1/loss_plot.png                                                                                                                                             
│       pbmc68k_model2:                                                                                                                                                                                     
│         path: models/pbmc68k_model2                                                                                                                                                                       
│         model_path: models/pbmc68k_model2/model                                                                                                                                                           
│         input_data_path: data/processed/pbmc68k_processed.h5ad                                                                                                                                            
│         trained_data_path: models/pbmc68k_model2/trained.h5ad                                                                                                                                             
│         pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl                                                                                                                                    
│         metrics_path: models/pbmc68k_model2/metrics.json                                                                                                                                                  
│         run_info_path: models/pbmc68k_model2/run_info.json                                                                                                                                                
│         vector_field_parameters:                                                                                                                                                                          
│           basis: tsne                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pbmc68k_model2/loss_plot.png                                                                                                                                             
│       pons_model1:                                                                                                                                                                                        
│         path: models/pons_model1                                                                                                                                                                          
│         model_path: models/pons_model1/model                                                                                                                                                              
│         input_data_path: data/processed/pons_processed.h5ad                                                                                                                                               
│         trained_data_path: models/pons_model1/trained.h5ad                                                                                                                                                
│         pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl                                                                                                                                       
│         metrics_path: models/pons_model1/metrics.json                                                                                                                                                     
│         run_info_path: models/pons_model1/run_info.json                                                                                                                                                   
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto_t0_constraint                                                                                                                                                                  
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: false                                                                                                                                                                                   
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pons_model1/loss_plot.png                                                                                                                                                
│       pons_model2:                                                                                                                                                                                        
│         path: models/pons_model2                                                                                                                                                                          
│         model_path: models/pons_model2/model                                                                                                                                                              
│         input_data_path: data/processed/pons_processed.h5ad                                                                                                                                               
│         trained_data_path: models/pons_model2/trained.h5ad                                                                                                                                                
│         pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl                                                                                                                                       
│         metrics_path: models/pons_model2/metrics.json                                                                                                                                                     
│         run_info_path: models/pons_model2/run_info.json                                                                                                                                                   
│         vector_field_parameters:                                                                                                                                                                          
│           basis: umap                                                                                                                                                                                     
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: false                                                                                                                                                                                
│           batch_size: -1                                                                                                                                                                                  
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: celltype                                                                                                                                                                            
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 2000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/pons_model2/loss_plot.png                                                                                                                                                
│       larry_model2:                                                                                                                                                                                       
│         path: models/larry_model2                                                                                                                                                                         
│         model_path: models/larry_model2/model                                                                                                                                                             
│         input_data_path: data/processed/larry_processed.h5ad                                                                                                                                              
│         trained_data_path: models/larry_model2/trained.h5ad                                                                                                                                               
│         pyrovelocity_data_path: models/larry_model2/pyrovelocity.pkl                                                                                                                                      
│         metrics_path: models/larry_model2/metrics.json                                                                                                                                                    
│         run_info_path: models/larry_model2/run_info.json                                                                                                                                                  
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_model2/loss_plot.png                                                                                                                                               
│       larry_mono_model2:                                                                                                                                                                                  
│         path: models/larry_mono_model2                                                                                                                                                                    
│         model_path: models/larry_mono_model2/model                                                                                                                                                        
│         input_data_path: data/processed/larry_mono_processed.h5ad                                                                                                                                         
│         trained_data_path: models/larry_mono_model2/trained.h5ad                                                                                                                                          
│         pyrovelocity_data_path: models/larry_mono_model2/pyrovelocity.pkl                                                                                                                                 
│         metrics_path: models/larry_mono_model2/metrics.json                                                                                                                                               
│         run_info_path: models/larry_mono_model2/run_info.json                                                                                                                                             
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_mono_model2/loss_plot.png                                                                                                                                          
│       larry_neu_model2:                                                                                                                                                                                   
│         path: models/larry_neu_model2                                                                                                                                                                     
│         model_path: models/larry_neu_model2/model                                                                                                                                                         
│         input_data_path: data/processed/larry_neu_processed.h5ad                                                                                                                                          
│         trained_data_path: models/larry_neu_model2/trained.h5ad                                                                                                                                           
│         pyrovelocity_data_path: models/larry_neu_model2/pyrovelocity.pkl                                                                                                                                  
│         metrics_path: models/larry_neu_model2/metrics.json                                                                                                                                                
│         run_info_path: models/larry_neu_model2/run_info.json                                                                                                                                              
│         vector_field_parameters:                                                                                                                                                                          
│           basis: emb                                                                                                                                                                                      
│         training_parameters:                                                                                                                                                                              
│           _target_: pyrovelocity.api.train_model                                                                                                                                                          
│           _partial_: true                                                                                                                                                                                 
│           guide_type: auto                                                                                                                                                                                
│           model_type: auto                                                                                                                                                                                
│           svi_train: true                                                                                                                                                                                 
│           batch_size: 4000                                                                                                                                                                                
│           train_size: 1.0                                                                                                                                                                                 
│           use_gpu: 0                                                                                                                                                                                      
│           likelihood: Poisson                                                                                                                                                                             
│           num_samples: 30                                                                                                                                                                                 
│           log_every: 100                                                                                                                                                                                  
│           cell_state: state_info                                                                                                                                                                          
│           patient_improve: 0.0001                                                                                                                                                                         
│           patient_init: 45                                                                                                                                                                                
│           seed: 99                                                                                                                                                                                        
│           lr: 0.01                                                                                                                                                                                        
│           max_epochs: 1000                                                                                                                                                                                
│           include_prior: true                                                                                                                                                                             
│           library_size: true                                                                                                                                                                              
│           offset: true                                                                                                                                                                                    
│           input_type: raw                                                                                                                                                                                 
│           cell_specific_kinetics: null                                                                                                                                                                    
│           kinetics_num: 2                                                                                                                                                                                 
│           loss_plot_path: models/larry_neu_model2/loss_plot.png                                                                                                                                           
│                                                                                                                                                                                                           
└── reports
    └── model_summary:                                                                                                                                                                                      
          summarize:                                                                                                                                                                                        
          - simulate_model1                                                                                                                                                                                 
          - simulate_model2                                                                                                                                                                                 
          - pancreas_model1                                                                                                                                                                                 
          - pancreas_model2                                                                                                                                                                                 
          - pbmc68k_model1                                                                                                                                                                                  
          - pbmc68k_model2                                                                                                                                                                                  
          - pons_model1                                                                                                                                                                                     
          - pons_model2                                                                                                                                                                                     
          simulate_model1:                                                                                                                                                                                  
            path: reports/medium_model1                                                                                                                                                                     
            dataframe_path: data/processed/medium_model1_dataframe.pkl.zst                                                                                                                                  
            shared_time_plot: reports/medium_model1/shared_time.pdf                                                                                                                                         
            volcano_plot: reports/medium_model1/volcano.pdf                                                                                                                                                 
            rainbow_plot: reports/medium_model1/rainbow.pdf                                                                                                                                                 
            uncertainty_param_plot: reports/medium_model1/param_uncertainties.pdf                                                                                                                           
            vector_field_plot: reports/medium_model1/vector_field.pdf                                                                                                                                       
            biomarker_selection_plot: reports/medium_model1/markers_selection_scatterplot.tif                                                                                                               
            biomarker_phaseportrait_plot: reports/medium_model1/markers_phaseportrait.pdf                                                                                                                   
          simulate_model2:                                                                                                                                                                                  
            path: reports/medium_model2                                                                                                                                                                     
            dataframe_path: data/processed/medium_model2_dataframe.pkl.zst                                                                                                                                  
            shared_time_plot: reports/medium_model2/shared_time.pdf                                                                                                                                         
            volcano_plot: reports/medium_model2/volcano.pdf                                                                                                                                                 
            rainbow_plot: reports/medium_model2/rainbow.pdf                                                                                                                                                 
            uncertainty_param_plot: reports/medium_model2/param_uncertainties.pdf                                                                                                                           
            vector_field_plot: reports/medium_model2/vector_field.pdf                                                                                                                                       
            biomarker_selection_plot: reports/medium_model2/markers_selection_scatterplot.tif                                                                                                               
            biomarker_phaseportrait_plot: reports/medium_model2/markers_phaseportrait.pdf                                                                                                                   
          pancreas_model1:                                                                                                                                                                                  
            path: reports/pancreas_model1                                                                                                                                                                   
            dataframe_path: data/processed/pancreas_model1_dataframe.pkl.zst                                                                                                                                
            shared_time_plot: reports/pancreas_model1/shared_time.pdf                                                                                                                                       
            volcano_plot: reports/pancreas_model1/volcano.pdf                                                                                                                                               
            rainbow_plot: reports/pancreas_model1/rainbow.pdf                                                                                                                                               
            uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.pdf                                                                                                                         
            vector_field_plot: reports/pancreas_model1/vector_field.pdf                                                                                                                                     
            biomarker_selection_plot: reports/pancreas_model1/markers_selection_scatterplot.tif                                                                                                             
            biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phaseportrait.pdf                                                                                                                 
          pancreas_model2:                                                                                                                                                                                  
            path: reports/pancreas_model2                                                                                                                                                                   
            dataframe_path: data/processed/pancreas_model2_dataframe.pkl.zst                                                                                                                                
            shared_time_plot: reports/pancreas_model2/shared_time.pdf                                                                                                                                       
            volcano_plot: reports/pancreas_model2/volcano.pdf                                                                                                                                               
            rainbow_plot: reports/pancreas_model2/rainbow.pdf                                                                                                                                               
            uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.pdf                                                                                                                         
            vector_field_plot: reports/pancreas_model2/vector_field.pdf                                                                                                                                     
            biomarker_selection_plot: reports/pancreas_model2/markers_selection_scatterplot.tif                                                                                                             
            biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phaseportrait.pdf                                                                                                                 
          pbmc68k_model1:                                                                                                                                                                                   
            path: reports/pbmc68k_model1                                                                                                                                                                    
            dataframe_path: data/processed/pbmc68k_model1_dataframe.pkl.zst                                                                                                                                 
            shared_time_plot: reports/pbmc68k_model1/shared_time.pdf                                                                                                                                        
            volcano_plot: reports/pbmc68k_model1/volcano.pdf                                                                                                                                                
            rainbow_plot: reports/pbmc68k_model1/rainbow.pdf                                                                                                                                                
            uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.pdf                                                                                                                          
            vector_field_plot: reports/pbmc68k_model1/vector_field.pdf                                                                                                                                      
            biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_scatterplot.tif                                                                                                              
            biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phaseportrait.pdf                                                                                                                  
          pbmc68k_model2:                                                                                                                                                                                   
            path: reports/pbmc68k_model2                                                                                                                                                                    
            dataframe_path: data/processed/pbmc68k_model2_dataframe.pkl.zst                                                                                                                                 
            shared_time_plot: reports/pbmc68k_model2/shared_time.pdf                                                                                                                                        
            volcano_plot: reports/pbmc68k_model2/volcano.pdf                                                                                                                                                
            rainbow_plot: reports/pbmc68k_model2/rainbow.pdf                                                                                                                                                
            uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.pdf                                                                                                                          
            vector_field_plot: reports/pbmc68k_model2/vector_field.pdf                                                                                                                                      
            biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_scatterplot.tif                                                                                                              
            biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phaseportrait.pdf                                                                                                                  
          pons_model1:                                                                                                                                                                                      
            path: reports/pons_model1                                                                                                                                                                       
            dataframe_path: data/processed/pons_model1_dataframe.pkl.zst                                                                                                                                    
            shared_time_plot: reports/pons_model1/shared_time.pdf                                                                                                                                           
            volcano_plot: reports/pons_model1/volcano.pdf                                                                                                                                                   
            rainbow_plot: reports/pons_model1/rainbow.pdf                                                                                                                                                   
            uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf                                                                                                                             
            vector_field_plot: reports/pons_model1/vector_field.pdf                                                                                                                                         
            biomarker_selection_plot: reports/pons_model1/markers_selection_scatterplot.tif                                                                                                                 
            biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportrait.pdf                                                                                                                     
          pons_model2:                                                                                                                                                                                      
            path: reports/pons_model2                                                                                                                                                                       
            dataframe_path: data/processed/pons_model2_dataframe.pkl.zst                                                                                                                                    
            shared_time_plot: reports/pons_model2/shared_time.pdf                                                                                                                                           
            volcano_plot: reports/pons_model2/volcano.pdf                                                                                                                                                   
            rainbow_plot: reports/pons_model2/rainbow.pdf                                                                                                                                                   
            uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf                                                                                                                             
            vector_field_plot: reports/pons_model2/vector_field.pdf                                                                                                                                         
            biomarker_selection_plot: reports/pons_model2/markers_selection_scatterplot.tif                                                                                                                 
            biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportrait.pdf                                                                                                                     
        figure2:                                                                                                                                                                                            
          tag: fig2                                                                                                                                                                                         
          path: reports/fig2                                                                                                                                                                                
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif                                                                                                                                         
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg                                                                                                                                         
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterplot.tif                                                                                                                     
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.pdf                                                                                                                         
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf                                                                                                                            
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertainties.pdf                                                                                                                    
          pancreas_model1:                                                                                                                                                                                  
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf                                                                                                                                    
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf                                                                                                                                            
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf                                                                                                                                            
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf                                                                                                                                  
        figureS3:                                                                                                                                                                                           
          tag: figS3                                                                                                                                                                                        
          path: reports/figS3                                                                                                                                                                               
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif                                                                                                                                       
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg                                                                                                                                       
                                                                                                                                                                                                            
{'T': AnnData object with n_obs × n_vars = 1368 × 1594
    obs: 'Accession', 'Chromosome', 'End', 'Start', 'Strand', 'cytotrace', 'cytotrace_corrs', 'fit_r2', 'fit_alpha', 'fit_beta', 'fit_gamma', 'fit_t_', 'fit_scaling', 'fit_std_u', 'fit_std_s', 'fit_likelihood', 'fit_u0', 'fit_s0', 'fit_pval_steady', 'fit_steady_u', 'fit_steady_s', 'fit_variance', 'fit_alignment_scaling', 'velocity_genes'
    var: 'Library', 'Cell barcode', 'time_info', 'Starting population', 'state_info', 'Well', 'SPRING-x', 'SPRING-y', 'gcs', 'cytotrace', 'counts', 'clones', 'clonei', 'time', 'batch', 'u_lib_size_raw', 's_lib_size_raw', 'initial_size_unspliced', 'initial_size_spliced', 'initial_size', 'n_counts', 'leiden', 'velocity_self_transition', 'root_cells', 'end_points', 'velocity_pseudotime', 'latent_time'
    uns: 'leiden', 'neighbors', 'pca', 'recover_dynamics', 'umap', 'velocity_graph', 'velocity_graph_neg', 'velocity_params'
    obsm: 'PCs', 'loss'
    varm: 'X_clone', 'X_emb', 'X_pca', 'X_umap', 'clone_vector_emb', 'velocity_emb'
    layers: 'Ms', 'Mu', 'ambiguous', 'fit_t', 'fit_tau', 'fit_tau_', 'matrix', 'raw_spliced', 'raw_unspliced', 'spliced', 'unspliced', 'velocity', 'velocity_u'
    varp: 'connectivities', 'distances',
 'X': <1594x1368 sparse matrix of type '<class 'numpy.float32'>'
	with 732927 stored elements in Compressed Sparse Row format>,
 'file': Backing file manager: no file is set.,
 'filename': None,
 'is_view': False,
 'isbacked': False,
 'isview': False,
 'layers': Layers with keys: Ms, Mu, ambiguous, fit_t, fit_tau, fit_tau_, matrix, raw_spliced, raw_unspliced, spliced, unspliced, velocity, velocity_u,
 'n_obs': 1594,
 'n_vars': 1368,
 'obs':                           Library  ... latent_time
d6_2_2:AGCGTGGTTCGACGGT-0  d6_2_2  ...    0.748073
d6_2_2:TGGAAAGCGTTCAACT-0  d6_2_2  ...    0.655037
d6_2_2:ACGACGACTTAGGACC-0  d6_2_2  ...    0.559884
d6_2_2:AGGACACACAATACTT-0  d6_2_2  ...    0.753587
d6_2_2:TACCCTGCACCACGCT-0  d6_2_2  ...    0.619026
...                           ...  ...         ...
1-122-1                       NaN  ...    0.536133
2-122-1                       NaN  ...    0.764391
0-123-1                       NaN  ...    0.806337
1-123-1                       NaN  ...    0.523133
2-123-1                       NaN  ...    0.426597

[1594 rows x 27 columns],
 'obs_names': Index(['d6_2_2:AGCGTGGTTCGACGGT-0', 'd6_2_2:TGGAAAGCGTTCAACT-0',
       'd6_2_2:ACGACGACTTAGGACC-0', 'd6_2_2:AGGACACACAATACTT-0',
       'd6_2_2:TACCCTGCACCACGCT-0', 'd6_2_2:CGTTGCCTTGGTATGA-0',
       'd6_2_2:GGTTAGGGAGCGCCTT-0', 'd6_2_2:AAAGAGGCTCTCAACC-0',
       'd6_2_2:GGACTTCTTGGTTTCT-0', 'd6_2_2:AGCTCCACCAGTCCCT-0',
       ...
       '2-120-1', '0-121-1', '1-121-1', '2-121-1', '0-122-1', '1-122-1',
       '2-122-1', '0-123-1', '1-123-1', '2-123-1'],
      dtype='object', length=1594),
 'obsm': AxisArrays with keys: X_clone, X_emb, X_pca, X_umap, clone_vector_emb, velocity_emb,
 'obsp': PairwiseArrays with keys: connectivities, distances,
 'raw': None,
 'shape': (1594, 1368),
 'uns': OverloadedDict, wrapping:
	{'leiden': {'params': {'n_iterations': -1, 'random_state': 0, 'resolution': 1}}, 'neighbors': {'connectivities_key': 'connectivities', 'distances_key': 'distances', 'indices': array([[   0,   32, 1521, ..., 1359, 1078, 1183],
       [   1, 1236,  333, ...,  865, 1380,  693],
       [   2, 1139, 1058, ..., 1563, 1179, 1161],
       ...,
       [1591,  374,  380, ...,  335,  803,  458],
       [1592,  986, 1027, ..., 1569, 1485,  321],
       [1593,  277,  583, ..., 1529,  655, 1176]]), 'params': {'method': 'umap', 'metric': 'euclidean', 'n_neighbors': 30, 'n_pcs': 30, 'use_rep': 'X_pca'}}, 'pca': {'params': {'use_highly_variable': False, 'zero_center': True}, 'variance': array([1155.256    ,  583.95337  ,  209.45241  ,  114.5976   ,
         83.939156 ,   72.37645  ,   55.009563 ,   47.800194 ,
         40.394455 ,   34.956158 ,   28.58991  ,   26.798145 ,
         25.94646  ,   23.188902 ,   19.967535 ,   18.39412  ,
         14.815965 ,   13.712895 ,   12.997519 ,   12.212259 ,
         11.198759 ,   10.097146 ,    9.958588 ,    9.280665 ,
          9.0628805,    8.764042 ,    8.243987 ,    7.691316 ,
          7.5829105,    7.4634867], dtype=float32), 'variance_ratio': array([0.3392526 , 0.17148381, 0.06150782, 0.03365275, 0.02464958,
       0.02125408, 0.01615411, 0.01403701, 0.01186224, 0.01026523,
       0.00839572, 0.00786955, 0.00761944, 0.00680966, 0.00586367,
       0.00540162, 0.00435086, 0.00402693, 0.00381685, 0.00358625,
       0.00328863, 0.00296513, 0.00292444, 0.00272536, 0.00266141,
       0.00257365, 0.00242093, 0.00225863, 0.0022268 , 0.00219173],
      dtype=float32)}, 'recover_dynamics': {'fit_connected_states': True, 'use_raw': False}, 'umap': {'params': {'a': 0.583030019901822, 'b': 1.3341669931033755}}, 'velocity_graph': <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 128484 stored elements in Compressed Sparse Row format>, 'velocity_graph_neg': <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 122479 stored elements in Compressed Sparse Row format>, 'velocity_params': {'embeddings': array(['emb'], dtype=object), 'fit_offset': False, 'mode': 'dynamical', 'mode_neighbors': 'distances', 'n_recurse_neighbors': 2, 'perc': array([ 5, 95])}}
With overloaded keys:
	['neighbors'].,
 'var':         Accession Chromosome  ...  fit_alignment_scaling  velocity_genes
Tram1       Tram1          1  ...               2.675056            True
Kcnq5       Kcnq5          1  ...               4.232887           False
Uggt1       Uggt1          1  ...                    NaN           False
Aff3         Aff3          1  ...               3.202763           False
Tbc1d8     Tbc1d8          1  ...               2.615137            True
...           ...        ...  ...                    ...             ...
Diap2       Diap2          X  ...                    NaN           False
Huwe1       Huwe1          X  ...                    NaN           False
Smc1a       Smc1a          X  ...                    NaN           False
Kdm5c       Kdm5c          X  ...                    NaN           False
Sh3kbp1   Sh3kbp1          X  ...               3.946390            True

[1368 rows x 24 columns],
 'var_names': Index(['Tram1', 'Kcnq5', 'Uggt1', 'Aff3', 'Tbc1d8', 'Rnf149', 'Nab1', 'Stk17b',
       'Ankrd44', 'Orc2',
       ...
       'Ddx26b', 'Nsdhl', 'Msn', 'Cox7b', 'Sh3bgrl', 'Diap2', 'Huwe1', 'Smc1a',
       'Kdm5c', 'Sh3kbp1'],
      dtype='object', length=1368),
 'varm': AxisArrays with keys: PCs, loss,
 'varp': PairwiseArrays with keys: }
0
Active run_id: 62d2603eb6594a8894c11292ac544ba2
[2023-04-26 13:17:12,511][jax._src.xla_bridge][INFO] - Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Interpreter Host CUDA
[2023-04-26 13:17:12,512][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
[2023-04-26 13:17:12,512][jax._src.xla_bridge][INFO] - Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
[2023-04-26 13:17:15,148][pyrovelocity._velocity][INFO] - n_U: 1368
n_cells: 1594
n_vars: 1368

-----------
auto
auto
[2023-04-26 13:17:15,475][pyrovelocity._velocity][INFO] - The model has been initialized
train_faster
TraceEnum
torch.Size([1594])
torch.Size([1594, 1368])
torch.Size([1594])
[2023-04-26 13:17:53,071][root][INFO] - Guessed max_plate_nesting = 2
step    1 loss = 2.30852 patience = 45
step  100 loss = 1.84054 patience = 45
step  200 loss = 1.60564 patience = 45
step  300 loss = 1.42932 patience = 45
step  400 loss = 1.28629 patience = 45
step  500 loss = 1.17806 patience = 45
step  600 loss = 1.0914 patience = 45
step  700 loss = 1.02862 patience = 45
step  800 loss = 0.977255 patience = 45
step  900 loss = 0.93751 patience = 43
step 1000 loss = 0.909293 patience = 44
alpha before 144
gamma before 144
beta before 144
u_offset before 144
s_offset before 144
t0 before 144
u_scale before 144
dt_switching before 144
u_inf before 144
s_inf before 144
switching before 144
cell_time before 191424
u_read_depth before 191424
s_read_depth before 191424
ut before 261671184
st before 261671184
u before 261671184
s before 261671184
alpha:
[[[0.12296037 0.14002255 0.12510543 ... 0.10182295 0.08503076 0.12139162]]

 [[0.12569126 0.1726855  0.11935707 ... 0.10105637 0.0704162  0.13194343]]

 [[0.11348964 0.09966848 0.11384329 ... 0.09893338 0.09994358 0.08277532]]

 ...

 [[0.12830865 0.1478275  0.13469775 ... 0.09848393 0.07702451 0.07814303]]

 [[0.12372071 0.19835891 0.13230956 ... 0.09741753 0.09665646 0.10546857]]

 [[0.12834977 0.12149243 0.09474649 ... 0.09851874 0.07121386 0.10222494]]]

gamma:
[[[ 1.2276464 48.669136   2.3237746 ...  4.681163   5.8809304  2.317782 ]]

 [[ 1.286706  55.730198   2.513493  ...  5.1538997  6.604398   2.1034021]]

 [[ 1.2005153 56.690235   2.348515  ...  4.804541   5.957317   2.09057  ]]

 ...

 [[ 1.2203525 46.40663    2.253614  ...  4.6458893  5.8943696  2.0407684]]

 [[ 1.2521652 51.048405   2.2877073 ...  4.737307   6.2357388  2.1180103]]

 [[ 1.2763367 46.85651    2.242974  ...  5.048375   6.4568944  2.009137 ]]]

beta:
[[[1.155644   1.5162503  0.951435   ... 2.7619984  0.79958665 0.35767227]]

 [[1.1994144  1.6168754  0.9722873  ... 3.161117   0.8417574  0.3973089 ]]

 [[1.1938883  1.5012443  0.87249976 ... 2.9541924  0.83778447 0.3414195 ]]

 ...

 [[1.1059548  1.6373698  0.9930035  ... 2.8036277  0.83204514 0.36117026]]

 [[1.222849   1.6127512  0.96635056 ... 3.1436625  0.76248735 0.33252445]]

 [[1.1153295  1.4775774  0.89261353 ... 3.1080077  0.7308123  0.33815145]]]

u_offset:
[[[1.3981724  3.9269931  0.5401403  ... 7.083818   1.321349   0.5810942 ]]

 [[1.5148207  5.415833   0.49900883 ... 5.7809343  1.1611803  0.6297186 ]]

 [[1.5357141  4.8892846  0.56003726 ... 7.0260983  1.029026   0.5656243 ]]

 ...

 [[1.4707875  4.776654   0.49994752 ... 7.1462474  1.3091599  0.5572494 ]]

 [[1.4090824  4.4712086  0.52364236 ... 6.142092   1.1547862  0.62549704]]

 [[1.3602756  4.146331   0.4833039  ... 5.7446866  1.0836515  0.537521  ]]]

s_offset:
[[[0.85279155 0.45441982 2.0131037  ... 6.450598   0.35297468 0.12827784]]

 [[1.1920763  0.98539007 2.063975   ... 4.829764   0.3963786  0.1943699 ]]

 [[0.6597308  0.59354305 1.4388928  ... 5.8270845  0.8911866  0.16273075]]

 ...

 [[0.818318   0.64194524 1.5386822  ... 4.1951914  0.786115   0.10968632]]

 [[0.78426725 0.8757849  1.9342692  ... 5.4942775  0.63174725 0.23047726]]

 [[0.7459256  0.21946433 1.9613483  ... 5.443697   0.5307322  0.17148389]]]

t0:
[[[-1.0829504  -0.6985491  -0.9650392  ...  1.1094518  -1.3444246
   -1.6765691 ]]

 [[-1.0391313  -0.829747   -0.7851378  ...  1.2985957  -1.3249688
   -1.6993713 ]]

 [[-1.1113943  -0.7554624  -1.0491686  ...  1.1955254  -1.2754058
   -1.6572413 ]]

 ...

 [[-1.0284917  -0.6172104  -1.0798036  ...  1.2867457  -1.0811899
   -1.4621267 ]]

 [[-1.0248557  -0.81056905 -0.8101412  ...  1.2547674  -1.3412102
   -1.6100895 ]]

 [[-1.1685432  -0.788142   -1.1076089  ...  1.4377751  -1.2932359
   -1.415556  ]]]

u_scale:
[[[0.9362802  2.2570455  1.1443781  ... 0.96066874 1.1342587  1.0818673 ]]

 [[0.95557666 2.302729   1.0352812  ... 0.9880319  1.1082739  1.065078  ]]

 [[0.95151174 1.9470298  1.0295341  ... 0.9129202  1.1016535  1.0305288 ]]

 ...

 [[0.88774896 1.8627416  1.1046557  ... 0.85337925 0.9908161  1.0540178 ]]

 [[1.0190911  2.2668157  1.1368008  ... 0.94925445 1.0610982  1.1262894 ]]

 [[0.8640291  2.200829   1.006854   ... 0.7806031  1.1815498  1.1535343 ]]]

dt_switching:
[[[0.10208295 0.07610456 0.41641784 ... 2.9810154  0.11820781 0.42356277]]

 [[0.13268007 0.06845469 0.3329209  ... 2.831857   0.19955914 0.22881225]]

 [[0.13720973 0.0868359  0.31550094 ... 2.6651947  0.24249433 0.32808802]]

 ...

 [[0.14712715 0.08098185 0.31339782 ... 2.630959   0.08128083 0.26086047]]

 [[0.13299027 0.1128445  0.35106224 ... 2.7785656  0.17240745 0.48639053]]

 [[0.15159094 0.08780333 0.36113065 ... 2.678064   0.18836133 0.49380922]]]

u_inf:
[[[1.2544256  3.509076   0.40646133 ... 0.03873728 1.2117699  0.5471161 ]]

 [[1.3073752  4.8595676  0.39496487 ... 0.03271306 0.99456275 0.60385513]]

 [[1.3180321  4.2998195  0.45667002 ... 0.03615123 0.86177135 0.5313771 ]]

 ...

 [[1.267345   4.1946898  0.40252024 ... 0.03957857 1.2296034  0.5265991 ]]

 [[1.2127761  3.7477076  0.41238332 ... 0.03197168 1.0281501  0.5794538 ]]

 [[1.1665809  3.6518395  0.3793757  ... 0.03308523 0.9568231  0.50134826]]]

s_inf:
[[[0.8990806  0.12082869 0.88128513 ... 0.02444194 0.26191968 0.10219242]]

 [[1.2105927  0.16326025 0.98974466 ... 0.02078674 0.20483643 0.16453569]]

 [[0.7741526  0.12026805 0.7830116  ... 0.02482711 0.30938727 0.12623757]]

 ...

 [[0.88687783 0.16420081 0.85818946 ... 0.0279395  0.55488765 0.10388274]]

 [[0.8595405  0.12443483 0.9731113  ... 0.02249062 0.30250427 0.14263897]]

 [[0.80802584 0.12020399 0.96567017 ... 0.02173138 0.23742163 0.11822854]]]

switching:
[[[-0.9808674  -0.6224445  -0.54862136 ...  4.0904675  -1.2262168
   -1.2530063 ]]

 [[-0.9064512  -0.76129234 -0.45221686 ...  4.1304526  -1.1254097
   -1.4705591 ]]

 [[-0.9741846  -0.6686265  -0.7336676  ...  3.8607202  -1.0329114
   -1.3291533 ]]

 ...

 [[-0.8813646  -0.53622854 -0.76640576 ...  3.9177046  -0.99990904
   -1.2012663 ]]

 [[-0.8918655  -0.6977246  -0.45907897 ...  4.033333   -1.1688027
   -1.123699  ]]

 [[-1.0169523  -0.7003387  -0.74647826 ...  4.115839   -1.1048746
   -0.92174673]]]

cell_time:
[[[2.6141608 ]
  [2.6595533 ]
  [1.9804751 ]
  ...
  [0.28705817]
  [0.74867934]
  [1.5554762 ]]

 [[2.452456  ]
  [2.8900237 ]
  [2.1647086 ]
  ...
  [0.7312651 ]
  [3.8802166 ]
  [0.39998075]]

 [[2.7647803 ]
  [2.6933808 ]
  [2.1435027 ]
  ...
  [6.142045  ]
  [9.659205  ]
  [1.0250319 ]]

 ...

 [[2.5670426 ]
  [2.7067173 ]
  [2.0144262 ]
  ...
  [0.37286472]
  [2.233171  ]
  [1.7337936 ]]

 [[2.656464  ]
  [2.9146266 ]
  [2.2376354 ]
  ...
  [0.7268236 ]
  [0.7342502 ]
  [0.9811949 ]]

 [[2.526568  ]
  [2.672363  ]
  [2.0630486 ]
  ...
  [0.9015181 ]
  [0.4815566 ]
  [0.24407323]]]

u_read_depth:
[[[4.83761368e+01]
  [4.18591690e+01]
  [4.75222664e+01]
  ...
  [7.14351516e-03]
  [2.71978043e-02]
  [1.65793389e-01]]

 [[4.45443611e+01]
  [4.67905235e+01]
  [4.19685631e+01]
  ...
  [4.40513402e-01]
  [6.90179020e-02]
  [3.49425785e-02]]

 [[5.47403526e+01]
  [4.60677223e+01]
  [5.73202591e+01]
  ...
  [2.23318245e-02]
  [1.60513353e-02]
  [3.12254846e-01]]

 ...

 [[5.40634308e+01]
  [4.99664230e+01]
  [4.87099380e+01]
  ...
  [7.22104833e-02]
  [2.11577378e-02]
  [5.43460026e-02]]

 [[4.84669914e+01]
  [5.41219864e+01]
  [4.71691360e+01]
  ...
  [1.21428154e-01]
  [1.32414429e-02]
  [1.30093396e-02]]

 [[5.46489372e+01]
  [5.29355812e+01]
  [4.76334686e+01]
  ...
  [8.60933587e-03]
  [2.69679725e-02]
  [7.14064762e-02]]]

s_read_depth:
[[[4.9063976e+01]
  [4.8006344e+01]
  [5.2524471e+01]
  ...
  [1.4752765e-02]
  [5.3034022e-02]
  [4.5844506e-02]]

 [[5.6508305e+01]
  [5.1866386e+01]
  [5.1445461e+01]
  ...
  [1.0161226e-01]
  [7.0789881e-02]
  [2.4547718e-01]]

 [[4.5611652e+01]
  [5.3917515e+01]
  [4.9208385e+01]
  ...
  [2.2193862e-02]
  [1.7954106e-02]
  [3.0644105e-03]]

 ...

 [[5.0250813e+01]
  [4.3896626e+01]
  [4.2893200e+01]
  ...
  [2.3898516e-02]
  [3.6096446e-02]
  [4.9021468e-02]]

 [[5.1078487e+01]
  [5.2049175e+01]
  [4.8826073e+01]
  ...
  [6.1217472e-03]
  [7.8966916e-03]
  [4.2751664e-01]]

 [[5.1625992e+01]
  [4.5733547e+01]
  [4.0793297e+01]
  ...
  [3.3207415e-03]
  [2.8504958e-02]
  [3.4374379e-02]]]

ut:
[[[1.78636853e-02 5.52150793e-02 2.20605023e-02 ... 9.63808522e-02
   6.26848936e-02 1.47344515e-01]
  [1.69740617e-02 5.16741388e-02 2.11643465e-02 ... 9.04136002e-02
   6.04956970e-02 1.45018786e-01]
  [3.61636542e-02 1.37300059e-01 3.89827155e-02 ... 2.67900467e-01
   1.02520324e-01 1.83644116e-01]
  ...
  [2.11859435e-01 1.24178004e+00 1.19386300e-01 ... 1.64245927e+00
   2.98269987e-01 2.68330872e-01]
  [1.40479341e-01 7.21698701e-01 8.50995257e-02 ... 1.00774908e+00
   2.19083086e-01 2.30362326e-01]
  [6.36295155e-02 2.49200091e-01 4.36212942e-02 ... 3.05267125e-01
   1.23229928e-01 1.73294306e-01]]

 [[2.13417038e-02 5.81398569e-02 2.30460577e-02 ... 9.38031971e-02
   5.29971831e-02 1.34284183e-01]
  [1.28101660e-02 2.93026157e-02 1.53349284e-02 ... 5.22458330e-02
   3.69685441e-02 1.13165468e-01]
  [2.97376476e-02 9.06850770e-02 2.99811643e-02 ... 1.52743697e-01
   6.70109019e-02 1.50162920e-01]
  ...
  [1.49404079e-01 1.09833705e+00 8.36041644e-02 ... 1.24428880e+00
   2.13352755e-01 5.64355791e-01]
  [5.18609723e-03 1.06922053e-02 5.14999265e-03 ... 5.41252317e-03
   1.86811183e-02 1.28346711e-01]
  [2.79396266e-01 1.17093623e+00 1.06473386e-01 ... 1.72600150e+00
   2.66593367e-01 3.80812705e-01]]

 [[1.40454667e-02 4.60893959e-02 2.16438621e-02 ... 6.59801960e-02
   3.86908464e-02 1.34579733e-01]
  [1.52638359e-02 5.11262715e-02 2.29914300e-02 ... 7.26878569e-02
   4.10200246e-02 1.37843579e-01]
  [2.87993085e-02 1.12546250e-01 3.64150070e-02 ... 1.78015903e-01
   6.40979558e-02 1.65584713e-01]
  ...
  [3.35240125e-04 6.93515700e-04 9.06183501e-04 ... 2.16440039e-05
   4.69729584e-03 6.12065382e-02]
  [6.25264693e-06 6.00782641e-06 3.84958475e-05 ... 1.00015677e-06
   3.18896113e-04 2.08951104e-02]
  [1.20804854e-01 7.06239045e-01 8.15065950e-02 ... 1.05291009e+00
   2.15908527e-01 2.83624262e-01]]

 ...

 [[2.39808280e-02 4.51741777e-02 1.56804342e-02 ... 1.14226162e-01
   6.12031929e-02 1.41148120e-01]
  [2.06401777e-02 3.62714157e-02 1.37109384e-02 ... 9.17104930e-02
   5.46511449e-02 1.34347290e-01]
  [4.31007929e-02 1.06085271e-01 2.64755134e-02 ... 2.91324645e-01
   9.53260586e-02 1.71302766e-01]
  ...
  [2.52555162e-01 1.25408733e+00 1.25455901e-01 ... 1.90008092e+00
   3.13971281e-01 3.18522930e-01]
  [2.29938515e-02 7.80788884e-02 2.87577286e-02 ... 1.37712643e-01
   8.86491314e-02 1.90676749e-01]
  [4.05445546e-02 1.64076775e-01 4.38575484e-02 ... 3.42189848e-01
   1.26685798e-01 2.19999135e-01]]

 [[1.55783705e-02 3.59614417e-02 2.21440941e-02 ... 6.48434907e-02
   5.80710620e-02 1.84291855e-01]
  [1.14503410e-02 2.40117889e-02 1.74177773e-02 ... 4.75994982e-02
   4.78723384e-02 1.69417873e-01]
  [2.55429205e-02 6.87052980e-02 3.24978977e-02 ... 1.26601860e-01
   7.92489350e-02 2.11020261e-01]
  ...
  [1.11474171e-01 5.04440665e-01 7.65154287e-02 ... 1.38207197e+00
   3.00231248e-01 3.08791935e-01]
  [1.10633977e-01 4.99435633e-01 7.60474354e-02 ... 1.37069941e+00
   2.26691678e-01 3.08028519e-01]
  [8.56218636e-02 3.55650783e-01 6.17325641e-02 ... 1.01876771e+00
   1.91748947e-01 2.83354133e-01]]

 [[1.87605452e-02 2.44287983e-01 1.98985264e-02 ... 8.61231610e-02
   7.80583546e-02 1.78305611e-01]
  [1.60132311e-02 5.23831435e-02 1.75481010e-02 ... 6.82104900e-02
   7.03491867e-02 1.69968858e-01]
  [3.08884885e-02 1.23758100e-01 2.95286700e-02 ... 1.93313941e-01
   1.08328320e-01 4.31548268e-01]
  ...
  [1.32469133e-01 6.21937811e-01 1.81057006e-01 ... 1.32422662e+00
   1.88350588e-01 2.41246060e-01]
  [1.97371736e-01 1.25539267e+00 1.02572478e-01 ... 2.04825187e+00
   2.58477420e-01 2.74837673e-01]
  [3.34453732e-01 1.59706807e+00 1.22157186e-01 ... 2.49109578e+00
   3.06409448e-01 2.95060605e-01]]]

st:
[[[8.08310956e-02 7.87633006e-04 1.37152299e-02 ... 1.11814968e-01
   8.69722571e-03 2.48533245e-02]
  [7.74860233e-02 7.37185357e-04 1.31385988e-02 ... 1.03078514e-01
   8.39351490e-03 2.44610198e-02]
  [1.43141940e-01 1.95709476e-03 2.50231698e-02 ... 3.57783556e-01
   1.42236510e-02 3.09767891e-02]
  ...
  [5.46958268e-01 1.71097554e-02 1.06594168e-01 ... 3.11471128e+00
   4.11598198e-02 7.07645863e-02]
  [4.11231399e-01 9.94427409e-03 6.91187531e-02 ... 2.06293893e+00
   3.02288104e-02 6.04749061e-02]
  [2.25163385e-01 3.43436957e-03 3.17331143e-02 ... 6.79980993e-01
   1.70032624e-02 4.53270935e-02]]

 [[9.40435901e-02 7.55390152e-04 1.44809484e-02 ... 1.16754733e-01
   6.98594330e-03 2.93676388e-02]
  [6.11058362e-02 3.81207850e-04 9.49741714e-03 ... 5.23221195e-02
   4.87335492e-03 2.47465223e-02]
  [1.23794898e-01 1.17768592e-03 1.91327706e-02 ... 2.05997631e-01
   8.83296411e-03 3.28443088e-02]
  ...
  [4.15222675e-01 1.16759706e-02 8.21570382e-02 ... 2.15915275e+00
   3.29816714e-02 8.68097097e-02]
  [2.75362507e-02 1.15399111e-04 3.74079915e-03 ... 9.31134261e-03
   2.88856705e-03 2.28768922e-02]
  [5.64612448e-01 1.25303585e-02 1.15015052e-01 ... 2.81591558e+00
   4.12148759e-02 6.78568259e-02]]

 [[7.39396960e-02 6.44899264e-04 1.25567727e-02 ... 8.13648701e-02
   5.74816996e-03 2.54956223e-02]
  [7.90552720e-02 7.15269300e-04 1.33533189e-02 ... 9.27213281e-02
   6.09415676e-03 2.61144824e-02]
  [1.30441293e-01 1.57336541e-03 2.14330107e-02 ... 2.66763985e-01
   9.52226110e-03 3.13789286e-02]
  ...
  [2.02170387e-03 1.20535897e-05 6.17700571e-04 ... 5.29217978e-05
   7.47158483e-04 1.25290779e-02]
  [4.07525768e-05 1.07993242e-06 2.65371727e-05 ... 1.00040904e-06
   5.15080756e-05 4.27776296e-03]
  [3.32693994e-01 1.12736179e-02 7.02462718e-02 ... 2.01011825e+00
   3.43069285e-02 5.84572926e-02]]

 ...

 [[9.84514058e-02 8.87941278e-04 1.14549827e-02 ... 1.65885970e-01
   1.01534501e-02 2.87928227e-02]
  [8.68923515e-02 7.13142334e-04 9.97882336e-03 ... 1.27969921e-01
   9.06657148e-03 2.74063554e-02]
  [1.58667043e-01 2.08388455e-03 1.97765399e-02 ... 4.51010436e-01
   1.58138834e-02 3.49366665e-02]
  ...
  [5.54222524e-01 1.94798913e-02 1.04663089e-01 ... 3.80495262e+00
   3.97536643e-02 5.72672263e-02]
  [1.14616871e-01 1.22239813e-03 1.84863843e-02 ... 3.13848913e-01
   1.12235686e-02 3.39598507e-02]
  [1.77976683e-01 2.56769150e-03 2.91031878e-02 ... 7.95807481e-01
   1.60388891e-02 3.92123125e-02]]

 [[7.32256547e-02 5.18530549e-04 1.47343222e-02 ... 9.11522135e-02
   7.62501918e-03 3.04854400e-02]
  [5.68716489e-02 3.46555142e-04 1.14821363e-02 ... 5.72399423e-02
   6.28602831e-03 2.80213747e-02]
  [1.09030418e-01 9.89768887e-04 2.21174918e-02 ... 2.08650962e-01
   1.04054632e-02 3.49202193e-02]
  ...
  [3.65313292e-01 6.41351426e-03 7.69622102e-02 ... 2.60298967e+00
   3.81804369e-02 6.12535626e-02]
  [3.63465935e-01 6.34988910e-03 7.63364062e-02 ... 2.58450675e+00
   2.99053378e-02 6.11005872e-02]
  [3.04929644e-01 4.52207401e-03 5.82333431e-02 ... 1.99140036e+00
   2.52955481e-02 5.61657399e-02]]

 [[7.42422566e-02 3.53075587e-03 1.34903910e-02 ... 1.41929492e-01
   8.43260251e-03 3.12967114e-02]
  [6.48388565e-02 7.75984372e-04 1.18318330e-02 ... 1.06689051e-01
   7.59987300e-03 2.98303608e-02]
  [1.12879366e-01 1.83196389e-03 2.05358863e-02 ... 3.47185314e-01
   1.17023056e-02 6.54749796e-02]
  ...
  [3.51990044e-01 7.73882307e-03 1.09174654e-01 ... 2.76935816e+00
   2.62623224e-02 5.05615175e-02]
  [4.62982774e-01 1.55572500e-02 1.07419096e-01 ... 4.14822388e+00
   3.60433161e-02 5.78036271e-02]
  [5.92313349e-01 1.98082011e-02 1.38145193e-01 ... 4.95400381e+00
   4.27349545e-02 6.22448139e-02]]]

u:
[[[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 1.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 ...

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 1.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]]

s:
[[[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 ...

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]

 [[0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  ...
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]
  [0. 0. 0. ... 0. 0. 0.]]]

                        MAE
label                      
Poisson all cells  0.296007
WARNING: You seem to have 161 duplicate cells in your data. Consider removing these via pp.remove_duplicate_cells.
computing neighbors
    finished (0:00:02) --> added 
    'distances' and 'connectivities', weighted adjacency matrices (adata.obsp)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:17) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:10) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
WARNING: You seem to have 161 duplicate cells in your data. Consider removing these via pp.remove_duplicate_cells.
computing neighbors
    finished (0:00:00) --> added 
    'distances' and 'connectivities', weighted adjacency matrices (adata.obsp)
computing velocity graph (using 6/8 cores)
  0%|          | 0/1594 [00:00<?, ?cells/s]
    finished (0:00:11) --> added 
    'velocity_pyro_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pyro_emb', embedded velocity vectors (adata.obsm)
train
(30, 1594)
alpha:
[[[0.12296037 0.14002255 0.12510543 ... 0.10182295 0.08503076 0.12139162]]

 [[0.12569126 0.1726855  0.11935707 ... 0.10105637 0.0704162  0.13194343]]

 [[0.11348964 0.09966848 0.11384329 ... 0.09893338 0.09994358 0.08277532]]

 ...

 [[0.12830865 0.1478275  0.13469775 ... 0.09848393 0.07702451 0.07814303]]

 [[0.12372071 0.19835891 0.13230956 ... 0.09741753 0.09665646 0.10546857]]

 [[0.12834977 0.12149243 0.09474649 ... 0.09851874 0.07121386 0.10222494]]]

gamma:
[[[ 1.2276464 48.669136   2.3237746 ...  4.681163   5.8809304  2.317782 ]]

 [[ 1.286706  55.730198   2.513493  ...  5.1538997  6.604398   2.1034021]]

 [[ 1.2005153 56.690235   2.348515  ...  4.804541   5.957317   2.09057  ]]

 ...

 [[ 1.2203525 46.40663    2.253614  ...  4.6458893  5.8943696  2.0407684]]

 [[ 1.2521652 51.048405   2.2877073 ...  4.737307   6.2357388  2.1180103]]

 [[ 1.2763367 46.85651    2.242974  ...  5.048375   6.4568944  2.009137 ]]]

beta:
[[[1.155644   1.5162503  0.951435   ... 2.7619984  0.79958665 0.35767227]]

 [[1.1994144  1.6168754  0.9722873  ... 3.161117   0.8417574  0.3973089 ]]

 [[1.1938883  1.5012443  0.87249976 ... 2.9541924  0.83778447 0.3414195 ]]

 ...

 [[1.1059548  1.6373698  0.9930035  ... 2.8036277  0.83204514 0.36117026]]

 [[1.222849   1.6127512  0.96635056 ... 3.1436625  0.76248735 0.33252445]]

 [[1.1153295  1.4775774  0.89261353 ... 3.1080077  0.7308123  0.33815145]]]

u_offset:
[[[1.3981724  3.9269931  0.5401403  ... 7.083818   1.321349   0.5810942 ]]

 [[1.5148207  5.415833   0.49900883 ... 5.7809343  1.1611803  0.6297186 ]]

 [[1.5357141  4.8892846  0.56003726 ... 7.0260983  1.029026   0.5656243 ]]

 ...

 [[1.4707875  4.776654   0.49994752 ... 7.1462474  1.3091599  0.5572494 ]]

 [[1.4090824  4.4712086  0.52364236 ... 6.142092   1.1547862  0.62549704]]

 [[1.3602756  4.146331   0.4833039  ... 5.7446866  1.0836515  0.537521  ]]]

s_offset:
[[[0.85279155 0.45441982 2.0131037  ... 6.450598   0.35297468 0.12827784]]

 [[1.1920763  0.98539007 2.063975   ... 4.829764   0.3963786  0.1943699 ]]

 [[0.6597308  0.59354305 1.4388928  ... 5.8270845  0.8911866  0.16273075]]

 ...

 [[0.818318   0.64194524 1.5386822  ... 4.1951914  0.786115   0.10968632]]

 [[0.78426725 0.8757849  1.9342692  ... 5.4942775  0.63174725 0.23047726]]

 [[0.7459256  0.21946433 1.9613483  ... 5.443697   0.5307322  0.17148389]]]

t0:
[[[-1.0829504  -0.6985491  -0.9650392  ...  1.1094518  -1.3444246
   -1.6765691 ]]

 [[-1.0391313  -0.829747   -0.7851378  ...  1.2985957  -1.3249688
   -1.6993713 ]]

 [[-1.1113943  -0.7554624  -1.0491686  ...  1.1955254  -1.2754058
   -1.6572413 ]]

 ...

 [[-1.0284917  -0.6172104  -1.0798036  ...  1.2867457  -1.0811899
   -1.4621267 ]]

 [[-1.0248557  -0.81056905 -0.8101412  ...  1.2547674  -1.3412102
   -1.6100895 ]]

 [[-1.1685432  -0.788142   -1.1076089  ...  1.4377751  -1.2932359
   -1.415556  ]]]

u_scale:
[[[0.9362802  2.2570455  1.1443781  ... 0.96066874 1.1342587  1.0818673 ]]

 [[0.95557666 2.302729   1.0352812  ... 0.9880319  1.1082739  1.065078  ]]

 [[0.95151174 1.9470298  1.0295341  ... 0.9129202  1.1016535  1.0305288 ]]

 ...

 [[0.88774896 1.8627416  1.1046557  ... 0.85337925 0.9908161  1.0540178 ]]

 [[1.0190911  2.2668157  1.1368008  ... 0.94925445 1.0610982  1.1262894 ]]

 [[0.8640291  2.200829   1.006854   ... 0.7806031  1.1815498  1.1535343 ]]]

dt_switching:
[[[0.10208295 0.07610456 0.41641784 ... 2.9810154  0.11820781 0.42356277]]

 [[0.13268007 0.06845469 0.3329209  ... 2.831857   0.19955914 0.22881225]]

 [[0.13720973 0.0868359  0.31550094 ... 2.6651947  0.24249433 0.32808802]]

 ...

 [[0.14712715 0.08098185 0.31339782 ... 2.630959   0.08128083 0.26086047]]

 [[0.13299027 0.1128445  0.35106224 ... 2.7785656  0.17240745 0.48639053]]

 [[0.15159094 0.08780333 0.36113065 ... 2.678064   0.18836133 0.49380922]]]

u_inf:
[[[1.2544256  3.509076   0.40646133 ... 0.03873728 1.2117699  0.5471161 ]]

 [[1.3073752  4.8595676  0.39496487 ... 0.03271306 0.99456275 0.60385513]]

 [[1.3180321  4.2998195  0.45667002 ... 0.03615123 0.86177135 0.5313771 ]]

 ...

 [[1.267345   4.1946898  0.40252024 ... 0.03957857 1.2296034  0.5265991 ]]

 [[1.2127761  3.7477076  0.41238332 ... 0.03197168 1.0281501  0.5794538 ]]

 [[1.1665809  3.6518395  0.3793757  ... 0.03308523 0.9568231  0.50134826]]]

s_inf:
[[[0.8990806  0.12082869 0.88128513 ... 0.02444194 0.26191968 0.10219242]]

 [[1.2105927  0.16326025 0.98974466 ... 0.02078674 0.20483643 0.16453569]]

 [[0.7741526  0.12026805 0.7830116  ... 0.02482711 0.30938727 0.12623757]]

 ...

 [[0.88687783 0.16420081 0.85818946 ... 0.0279395  0.55488765 0.10388274]]

 [[0.8595405  0.12443483 0.9731113  ... 0.02249062 0.30250427 0.14263897]]

 [[0.80802584 0.12020399 0.96567017 ... 0.02173138 0.23742163 0.11822854]]]

switching:
[[[-0.9808674  -0.6224445  -0.54862136 ...  4.0904675  -1.2262168
   -1.2530063 ]]

 [[-0.9064512  -0.76129234 -0.45221686 ...  4.1304526  -1.1254097
   -1.4705591 ]]

 [[-0.9741846  -0.6686265  -0.7336676  ...  3.8607202  -1.0329114
   -1.3291533 ]]

 ...

 [[-0.8813646  -0.53622854 -0.76640576 ...  3.9177046  -0.99990904
   -1.2012663 ]]

 [[-0.8918655  -0.6977246  -0.45907897 ...  4.033333   -1.1688027
   -1.123699  ]]

 [[-1.0169523  -0.7003387  -0.74647826 ...  4.115839   -1.1048746
   -0.92174673]]]

cell_time:
[[[2.6141608 ]
  [2.6595533 ]
  [1.9804751 ]
  ...
  [0.28705817]
  [0.74867934]
  [1.5554762 ]]

 [[2.452456  ]
  [2.8900237 ]
  [2.1647086 ]
  ...
  [0.7312651 ]
  [3.8802166 ]
  [0.39998075]]

 [[2.7647803 ]
  [2.6933808 ]
  [2.1435027 ]
  ...
  [6.142045  ]
  [9.659205  ]
  [1.0250319 ]]

 ...

 [[2.5670426 ]
  [2.7067173 ]
  [2.0144262 ]
  ...
  [0.37286472]
  [2.233171  ]
  [1.7337936 ]]

 [[2.656464  ]
  [2.9146266 ]
  [2.2376354 ]
  ...
  [0.7268236 ]
  [0.7342502 ]
  [0.9811949 ]]

 [[2.526568  ]
  [2.672363  ]
  [2.0630486 ]
  ...
  [0.9015181 ]
  [0.4815566 ]
  [0.24407323]]]

u_read_depth:
[[[4.83761368e+01]
  [4.18591690e+01]
  [4.75222664e+01]
  ...
  [7.14351516e-03]
  [2.71978043e-02]
  [1.65793389e-01]]

 [[4.45443611e+01]
  [4.67905235e+01]
  [4.19685631e+01]
  ...
  [4.40513402e-01]
  [6.90179020e-02]
  [3.49425785e-02]]

 [[5.47403526e+01]
  [4.60677223e+01]
  [5.73202591e+01]
  ...
  [2.23318245e-02]
  [1.60513353e-02]
  [3.12254846e-01]]

 ...

 [[5.40634308e+01]
  [4.99664230e+01]
  [4.87099380e+01]
  ...
  [7.22104833e-02]
  [2.11577378e-02]
  [5.43460026e-02]]

 [[4.84669914e+01]
  [5.41219864e+01]
  [4.71691360e+01]
  ...
  [1.21428154e-01]
  [1.32414429e-02]
  [1.30093396e-02]]

 [[5.46489372e+01]
  [5.29355812e+01]
  [4.76334686e+01]
  ...
  [8.60933587e-03]
  [2.69679725e-02]
  [7.14064762e-02]]]

s_read_depth:
[[[4.9063976e+01]
  [4.8006344e+01]
  [5.2524471e+01]
  ...
  [1.4752765e-02]
  [5.3034022e-02]
  [4.5844506e-02]]

 [[5.6508305e+01]
  [5.1866386e+01]
  [5.1445461e+01]
  ...
  [1.0161226e-01]
  [7.0789881e-02]
  [2.4547718e-01]]

 [[4.5611652e+01]
  [5.3917515e+01]
  [4.9208385e+01]
  ...
  [2.2193862e-02]
  [1.7954106e-02]
  [3.0644105e-03]]

 ...

 [[5.0250813e+01]
  [4.3896626e+01]
  [4.2893200e+01]
  ...
  [2.3898516e-02]
  [3.6096446e-02]
  [4.9021468e-02]]

 [[5.1078487e+01]
  [5.2049175e+01]
  [4.8826073e+01]
  ...
  [6.1217472e-03]
  [7.8966916e-03]
  [4.2751664e-01]]

 [[5.1625992e+01]
  [4.5733547e+01]
  [4.0793297e+01]
  ...
  [3.3207415e-03]
  [2.8504958e-02]
  [3.4374379e-02]]]

gene_ranking:
        mean_mae  time_correlation  ...  rank_product  selected genes
genes                               ...                              
Lgals3 -0.984737          0.820358  ...        6655.0               1
Gpnmb  -0.994896          0.798934  ...       31458.0               1
Mrc1   -0.994065          0.778325  ...       47553.0               1
Mmp12  -1.002568          0.766972  ...      117925.0               1
H2-Aa  -1.003382          0.741506  ...      179550.0               0
...          ...               ...  ...           ...             ...
Anxa2  -0.987791         -0.898471  ...         375.0               0
Csf2rb -0.990917         -0.899375  ...         396.0               0
Fcer1g -0.983045         -0.909613  ...         117.0               0
Sirpa  -0.983612         -0.920651  ...          86.0               0
S100a4 -0.988734         -0.927321  ...          82.0               0

[300 rows x 6 columns]

genes:
Index(['Lgals3', 'Gpnmb', 'Mrc1', 'Mmp12'], dtype='object', name='genes')

vector_field_posterior_samples:
[[[  3.51019757  11.82360021]
  [ 26.00808087   4.24597801]
  [ 20.82953782   2.95446767]
  ...
  [  1.29150341   1.59490022]
  [ 33.11859575   7.44107373]
  [-27.36202392 -13.54683178]]

 [[ 13.03779843 -27.46554686]
  [ 10.78996844   3.88928709]
  [ 32.03933296  17.73267983]
  ...
  [ -3.13884379  -7.90210303]
  [ 47.50992064   7.17854623]
  [ 24.28607849   3.42072888]]

 [[ -1.14890868 -30.15388884]
  [ 37.841898     9.53390673]
  [ 11.49050446  -7.7574505 ]
  ...
  [-39.33242967   5.17394933]
  [-14.53718116   2.94763974]
  [ 75.54577767   1.70260944]]

 ...

 [[  8.53231105  59.88719766]
  [ 44.34703234  22.20458016]
  [ 15.25454765  -4.19913927]
  ...
  [ -2.22332733  -5.09004429]
  [ 44.17395486   8.69019931]
  [ 33.73984859   9.22253787]]

 [[ -3.17488024  16.80285869]
  [ 10.04898573   9.62094105]
  [ 13.75489063   3.30846918]
  ...
  [  5.64425828  -5.0826635 ]
  [ 28.80817774   6.79931176]
  [ 55.67736977  12.20677952]]

 [[ -0.55791027  14.4940934 ]
  [ 22.40279668   1.34513538]
  [ 15.3583907   -1.61538485]
  ...
  [  5.25869629  -3.61377373]
  [ 31.75572678   6.37039765]
  [ 17.40084799  -3.75767571]]]

vector_field_posterior_mean:
[[20.41216517 41.34911076]
 [ 9.00596388  7.90575609]
 [25.72303372 17.19591579]
 ...
 [ 0.39461807  0.72496857]
 [22.0029213   3.41718973]
 [ 9.57061672 -0.35173076]]

fdri:
[8.81089589e-01 2.06010118e-08 2.84706674e-10 ... 9.48771051e-01
 1.31121145e-08 8.92704519e-09]

embeds_magnitude:
[1148.1489729  1159.51659354 1124.72962019 1134.32135105 1122.75289276
 1155.79623159 1191.72224403 1156.40443277 1175.51293454 1155.33009435
 1127.52770337 1159.99234138 1165.79512206 1140.53678947 1166.9407913
 1188.65010381 1173.2140797  1135.56350482 1171.2088863  1138.25007158
 1144.48788006 1150.07609919 1132.07216298 1189.97404323 1159.09426416
 1141.01100129 1099.32719376 1159.99392777 1130.92377177 1163.49621225]

embeds_angle:
[[ 1.28220381  0.16182847  0.1409004  ...  0.890126    0.22100949
  -2.68187584]
 [-1.12759566  0.34595742  0.50550031 ... -1.94890062  0.1499614
   0.13993091]
 [-1.60887941  0.24680418 -0.59383097 ...  3.01079951  2.94153932
   0.02253364]
 ...
 [ 1.42927571  0.46420783 -0.26861843 ... -1.98261841  0.19424625
   0.26682469]
 [ 1.75754352  0.76364022  0.23604642 ... -0.73309215  0.23177854
   0.21582653]
 [ 1.60926958  0.05997119 -0.104794   ... -0.6020833   0.19797844
  -0.21268195]]

ut_mean:
[[0.02039236 0.0592244  0.02439594 ... 0.07070643 0.05619092 0.16135338]
 [0.02051898 0.04217314 0.02277124 ... 0.06090769 0.04964031 0.14667314]
 [0.03500735 0.13447805 0.03870214 ... 0.17658949 0.08249322 0.20333484]
 ...
 [0.1380321  0.6400858  0.10547317 ... 1.0799083  0.20231251 0.27471405]
 [0.11942399 0.5830594  0.07819352 ... 1.0064969  0.17354532 0.24154036]
 [0.17111176 0.80002564 0.10527311 ... 1.2796841  0.22953264 0.26784265]]

st_mean:
[[8.54519308e-02 8.17974680e-04 1.55638177e-02 ... 1.01573773e-01
  7.84322619e-03 3.08952890e-02]
 [7.66946003e-02 5.79549698e-04 1.38834445e-02 ... 8.13660249e-02
  6.92291604e-03 2.82549802e-02]
 [1.33603290e-01 1.89054268e-03 2.46179346e-02 ... 2.92178154e-01
  1.15086026e-02 3.82627435e-02]
 ...
 [3.40169311e-01 8.53461958e-03 8.02722275e-02 ... 1.89410722e+00
  2.76002288e-02 5.20588234e-02]
 [3.00329685e-01 7.67128495e-03 6.98734075e-02 ... 1.76439238e+00
  2.38093734e-02 4.56273891e-02]
 [3.87156665e-01 1.05205309e-02 8.80778730e-02 ... 2.16023517e+00
  3.19238268e-02 5.24066910e-02]]

dict_keys(['alpha', 'gamma', 'beta', 'u_offset', 's_offset', 't0', 'u_scale', 'dt_switching', 'u_inf', 's_inf', 'switching', 'cell_time', 'u_read_depth', 's_read_depth', 'gene_ranking', 'genes', 'vector_field_posterior_samples', 'vector_field_posterior_mean', 'fdri', 'embeds_magnitude', 'embeds_angle', 'ut_mean', 'st_mean'])
alpha after 144
gamma after 144
beta after 144
u_offset after 144
s_offset after 144
t0 after 144
u_scale after 144
dt_switching after 144
u_inf after 144
s_inf after 144
switching after 144
cell_time after 191424
u_read_depth after 191424
s_read_depth after 191424
gene_ranking after 31843
genes after 264
vector_field_posterior_samples after 765264
vector_field_posterior_mean after 25632
fdri after 12864
embeds_magnitude after 352
embeds_angle after 382688
ut_mean after 8722496
st_mean after 8722496
run_id: 62d2603eb6594a8894c11292ac544ba2
artifacts: []
params: {'seed': '99', '_partial_': 'True', '_target_': 'pyrovelocity.api.train_model', 'likelihood': 'Poisson', 'num_samples': '30', 'guide_type': 'auto', 'log_every': '100', 'train_size': '1.0', 'use_gpu': '0', 'model_type': 'auto', 'include_prior': 'True', 'lr': '0.01', 'max_epochs': '1000', 'batch_size': '4000', 'patient_init': '45', 'offset': 'True', 'kinetics_num': '2', 'patient_improve': '0.0001', 'cell_specific_kinetics': 'None', 'cell_state': 'state_info', 'library_size': 'True', 'loss_plot_path': 'models/larry_mono_model2/loss_plot.png', 'svi_train': 'True', 'input_type': 'raw'}
metrics: {'-ELBO': -0.9092934969035932, 'MAE': 0.29600671132732154, 'FDR_HMP': 7.114115202502107e-10, 'FDR_sig_frac': 0.831, 'real_epochs': 1000.0}
tags: {}
{'T': AnnData object with n_obs × n_vars = 1368 × 1594
    obs: 'Accession', 'Chromosome', 'End', 'Start', 'Strand', 'cytotrace', 'cytotrace_corrs', 'fit_r2', 'fit_alpha', 'fit_beta', 'fit_gamma', 'fit_t_', 'fit_scaling', 'fit_std_u', 'fit_std_s', 'fit_likelihood', 'fit_u0', 'fit_s0', 'fit_pval_steady', 'fit_steady_u', 'fit_steady_s', 'fit_variance', 'fit_alignment_scaling', 'velocity_genes'
    var: 'Library', 'Cell barcode', 'time_info', 'Starting population', 'state_info', 'Well', 'SPRING-x', 'SPRING-y', 'gcs', 'cytotrace', 'counts', 'clones', 'clonei', 'time', 'batch', 'u_lib_size_raw', 's_lib_size_raw', 'initial_size_unspliced', 'initial_size_spliced', 'initial_size', 'n_counts', 'leiden', 'velocity_self_transition', 'root_cells', 'end_points', 'velocity_pseudotime', 'latent_time', 'u_lib_size', 's_lib_size', 'u_lib_size_mean', 's_lib_size_mean', 'u_lib_size_scale', 's_lib_size_scale', 'ind_x', 'velocity_pyro_self_transition'
    uns: 'leiden', 'neighbors', 'pca', 'recover_dynamics', 'umap', 'velocity_graph', 'velocity_graph_neg', 'velocity_params', '_scvi_uuid', '_scvi_manager_uuid', 'velocity_pyro_graph', 'velocity_pyro_graph_neg', 'velocity_pyro_params'
    obsm: 'PCs', 'loss'
    varm: 'X_clone', 'X_emb', 'X_pca', 'X_umap', 'clone_vector_emb', 'velocity_emb', 'velocity_pyro_emb'
    layers: 'Ms', 'Mu', 'ambiguous', 'fit_t', 'fit_tau', 'fit_tau_', 'matrix', 'raw_spliced', 'raw_unspliced', 'spliced', 'unspliced', 'velocity', 'velocity_u', 'spliced_pyro', 'velocity_pyro'
    varp: 'connectivities', 'distances',
 'X': <1594x1368 sparse matrix of type '<class 'numpy.float32'>'
	with 732927 stored elements in Compressed Sparse Row format>,
 'file': Backing file manager: no file is set.,
 'filename': None,
 'is_view': False,
 'isbacked': False,
 'isview': False,
 'layers': Layers with keys: Ms, Mu, ambiguous, fit_t, fit_tau, fit_tau_, matrix, raw_spliced, raw_unspliced, spliced, unspliced, velocity, velocity_u, spliced_pyro, velocity_pyro,
 'n_obs': 1594,
 'n_vars': 1368,
 'obs':                           Library  ... velocity_pyro_self_transition
d6_2_2:AGCGTGGTTCGACGGT-0  d6_2_2  ...                      0.172103
d6_2_2:TGGAAAGCGTTCAACT-0  d6_2_2  ...                      0.590669
d6_2_2:ACGACGACTTAGGACC-0  d6_2_2  ...                      0.291113
d6_2_2:AGGACACACAATACTT-0  d6_2_2  ...                      0.272496
d6_2_2:TACCCTGCACCACGCT-0  d6_2_2  ...                      0.171739
...                           ...  ...                           ...
1-122-1                       NaN  ...                      0.000066
2-122-1                       NaN  ...                      0.000000
0-123-1                       NaN  ...                      0.127663
1-123-1                       NaN  ...                      0.006045
2-123-1                       NaN  ...                      0.001428

[1594 rows x 35 columns],
 'obs_names': Index(['d6_2_2:AGCGTGGTTCGACGGT-0', 'd6_2_2:TGGAAAGCGTTCAACT-0',
       'd6_2_2:ACGACGACTTAGGACC-0', 'd6_2_2:AGGACACACAATACTT-0',
       'd6_2_2:TACCCTGCACCACGCT-0', 'd6_2_2:CGTTGCCTTGGTATGA-0',
       'd6_2_2:GGTTAGGGAGCGCCTT-0', 'd6_2_2:AAAGAGGCTCTCAACC-0',
       'd6_2_2:GGACTTCTTGGTTTCT-0', 'd6_2_2:AGCTCCACCAGTCCCT-0',
       ...
       '2-120-1', '0-121-1', '1-121-1', '2-121-1', '0-122-1', '1-122-1',
       '2-122-1', '0-123-1', '1-123-1', '2-123-1'],
      dtype='object', length=1594),
 'obsm': AxisArrays with keys: X_clone, X_emb, X_pca, X_umap, clone_vector_emb, velocity_emb, velocity_pyro_emb,
 'obsp': PairwiseArrays with keys: connectivities, distances,
 'raw': None,
 'shape': (1594, 1368),
 'uns': OverloadedDict, wrapping:
	{'leiden': {'params': {'n_iterations': -1, 'random_state': 0, 'resolution': 1}}, 'neighbors': {'connectivities_key': 'connectivities', 'distances_key': 'distances', 'indices': array([[   0,   32, 1521, ..., 1359, 1078, 1183],
       [   1, 1236,  333, ...,  865, 1380,  693],
       [   2, 1139, 1058, ..., 1563, 1179, 1161],
       ...,
       [1591,  374,  380, ...,  335,  803,  458],
       [1592,  986, 1027, ..., 1569, 1485,  321],
       [1593,  277,  583, ..., 1529,  655, 1176]]), 'params': {'n_neighbors': 30, 'method': 'umap', 'metric': 'euclidean', 'n_pcs': None, 'use_rep': 'X_pca'}}, 'pca': {'params': {'use_highly_variable': False, 'zero_center': True}, 'variance': array([1155.256    ,  583.95337  ,  209.45241  ,  114.5976   ,
         83.939156 ,   72.37645  ,   55.009563 ,   47.800194 ,
         40.394455 ,   34.956158 ,   28.58991  ,   26.798145 ,
         25.94646  ,   23.188902 ,   19.967535 ,   18.39412  ,
         14.815965 ,   13.712895 ,   12.997519 ,   12.212259 ,
         11.198759 ,   10.097146 ,    9.958588 ,    9.280665 ,
          9.0628805,    8.764042 ,    8.243987 ,    7.691316 ,
          7.5829105,    7.4634867], dtype=float32), 'variance_ratio': array([0.3392526 , 0.17148381, 0.06150782, 0.03365275, 0.02464958,
       0.02125408, 0.01615411, 0.01403701, 0.01186224, 0.01026523,
       0.00839572, 0.00786955, 0.00761944, 0.00680966, 0.00586367,
       0.00540162, 0.00435086, 0.00402693, 0.00381685, 0.00358625,
       0.00328863, 0.00296513, 0.00292444, 0.00272536, 0.00266141,
       0.00257365, 0.00242093, 0.00225863, 0.0022268 , 0.00219173],
      dtype=float32)}, 'recover_dynamics': {'fit_connected_states': True, 'use_raw': False}, 'umap': {'params': {'a': 0.583030019901822, 'b': 1.3341669931033755}}, 'velocity_graph': <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 128484 stored elements in Compressed Sparse Row format>, 'velocity_graph_neg': <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 122479 stored elements in Compressed Sparse Row format>, 'velocity_params': {'embeddings': array(['emb'], dtype=object), 'fit_offset': False, 'mode': 'dynamical', 'mode_neighbors': 'distances', 'n_recurse_neighbors': 2, 'perc': array([ 5, 95])}, '_scvi_uuid': '45b42a8a-6721-4c97-8460-03581ed3beb2', '_scvi_manager_uuid': '4d96b175-9e11-40b1-ba2a-4bae236b55b0', 'velocity_pyro_graph': <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 100385 stored elements in Compressed Sparse Row format>, 'velocity_pyro_graph_neg': <1594x1594 sparse matrix of type '<class 'numpy.float32'>'
	with 150187 stored elements in Compressed Sparse Row format>, 'velocity_pyro_params': {'mode_neighbors': 'distances', 'n_recurse_neighbors': 2, 'embeddings': ['emb']}}
With overloaded keys:
	['neighbors'].,
 'var':         Accession Chromosome  ...  fit_alignment_scaling  velocity_genes
Tram1       Tram1          1  ...               2.675056            True
Kcnq5       Kcnq5          1  ...               4.232887            True
Uggt1       Uggt1          1  ...                    NaN            True
Aff3         Aff3          1  ...               3.202763            True
Tbc1d8     Tbc1d8          1  ...               2.615137            True
...           ...        ...  ...                    ...             ...
Diap2       Diap2          X  ...                    NaN            True
Huwe1       Huwe1          X  ...                    NaN            True
Smc1a       Smc1a          X  ...                    NaN            True
Kdm5c       Kdm5c          X  ...                    NaN            True
Sh3kbp1   Sh3kbp1          X  ...               3.946390            True

[1368 rows x 24 columns],
 'var_names': Index(['Tram1', 'Kcnq5', 'Uggt1', 'Aff3', 'Tbc1d8', 'Rnf149', 'Nab1', 'Stk17b',
       'Ankrd44', 'Orc2',
       ...
       'Ddx26b', 'Nsdhl', 'Msn', 'Cox7b', 'Sh3bgrl', 'Diap2', 'Huwe1', 'Smc1a',
       'Kdm5c', 'Sh3kbp1'],
      dtype='object', length=1368),
 'varm': AxisArrays with keys: PCs, loss,
 'varp': PairwiseArrays with keys: }
Updating lock file 'dvc.lock'

Stage 'summarize_pons_model2' didn't change, skipping
Stage 'preprocess_larry' didn't change, skipping
Running stage 'train_larry_model2':
> /usr/bin/time -v python train.py model_training.train=[larry_model2]
CONFIG
├── base
│   └── log_level: INFO                                                         
│                                                                               
├── paths
│   └── data: data                                                              
│       models: models                                                          
│       reports: reports                                                        
│                                                                               
├── data_external
│   └── root_path: data/external                                                
│       processed_path: data/processed                                          
│       sources:                                                                
│       - simulate                                                              
│       - velocyto                                                              
│       - scvelo                                                                
│       - pyrovelocity                                                          
│       simulate:                                                               
│         download:                                                             
│         - medium                                                              
│         process:                                                              
│         - medium                                                              
│         sources:                                                              
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data      
│         medium:                                                               
│           data_file: simulated_medium.h5ad                                    
│           dl_root: data/external                                              
│           dl_path: data/external/simulated_medium.h5ad                        
│           rel_path: data/external/simulated_medium.h5ad                       
│           url: https://storage.googleapis.com/pyrovelocity/data/simulated_medi
│           derived:                                                            
│             process_method: load_data                                         
│             process_args: {}                                                  
│             rel_path: data/processed/simulated_medium_processed.h5ad          
│       velocyto:                                                               
│         download:                                                             
│         - pons                                                                
│         process:                                                              
│         - pons                                                                
│         sources:                                                              
│           gcs_root_url: https://storage.googleapis.com/pyrovelocity/data      
│         pons:                                                                 
│           data_file: oligo_lite.h5ad                                          
│           dl_root: data/external                                              
│           dl_path: data/external/oligo_lite.h5ad                              
│           rel_path: data/external/oligo_lite.h5ad                             
│           url: https://storage.googleapis.com/pyrovelocity/data/oligo_lite.h5a
│           derived:                                                            
│             process_method: load_data                                         
│             process_args: {}                                                  
│             rel_path: data/processed/pons_processed.h5ad                      
│       scvelo:                                                                 
│         download:                                                             
│         - pancreas                                                            
│         - pbmc68k                                                             
│         process:                                                              
│         - pancreas                                                            
│         - pbmc68k                                                             
│         sources:                                                              
│           figshare_root_url: https://ndownloader.figshare.com/files           
│           scvelo_root_url: https://github.com/theislab/scvelo_notebooks/raw/ma
│         pancreas:                                                             
│           data_file: endocrinogenesis_day15.h5ad                              
│           dl_root: data/Pancreas                                              
│           dl_path: data/Pancreas/endocrinogenesis_day15.h5ad                  
│           rel_path: data/external/endocrinogenesis_day15.h5ad                 
│           url: https://github.com/theislab/scvelo_notebooks/raw/master/data/Pa
│           derived:                                                            
│             process_method: load_data                                         
│             process_args:                                                     
│               process_cytotrace: true                                         
│             rel_path: data/processed/pancreas_processed.h5ad                  
│         pbmc68k:                                                              
│           data_file: pbmc68k.h5ad                                             
│           dl_root: data/PBMC                                                  
│           dl_path: data/PBMC/pbmc68k.h5ad                                     
│           rel_path: data/external/pbmc68k.h5ad                                
│           url: https://ndownloader.figshare.com/files/27686886                
│           derived:                                                            
│             process_method: load_data                                         
│             process_args: {}                                                  
│             rel_path: data/processed/pbmc68k_processed.h5ad                   
│       pyrovelocity:                                                           
│         download:                                                             
│         - larry                                                               
│         process: []                                                           
│         sources:                                                              
│           figshare_root_url: https://ndownloader.figshare.com/files           
│         larry:                                                                
│           data_file: larry.h5ad                                               
│           dl_root: data/external                                              
│           dl_path: data/external/larry.h5ad                                   
│           rel_path: data/external/larry.h5ad                                  
│           url: https://ndownloader.figshare.com/files/37028569                
│           derived:                                                            
│             process_method: load_data                                         
│             process_args: {}                                                  
│             rel_path: data/processed/larry_processed.h5ad                     
│         larry_mono:                                                           
│           data_file: larry_mono.h5ad                                          
│           dl_root: data/external                                              
│           dl_path: data/external/larry_mono.h5ad                              
│           rel_path: data/external/larry_mono.h5ad                             
│           url: https://ndownloader.figshare.com/files/37028572                
│           derived:                                                            
│             process_method: load_data                                         
│             process_args: {}                                                  
│             rel_path: data/processed/larry_mono_processed.h5ad                
│         larry_neu:                                                            
│           data_file: larry_neu.h5ad                                           
│           dl_root: data/external                                              
│           dl_path: data/external/larry_neu.h5ad                               
│           rel_path: data/external/larry_neu.h5ad                              
│           url: https://ndownloader.figshare.com/files/37028575                
│           derived:                                                            
│             process_method: load_data                                         
│             process_args: {}                                                  
│             rel_path: data/processed/larry_neu_processed.h5ad                 
│                                                                               
├── model_training
│   └── train:                                                                  
│       - larry_model2                                                          
│       simulate_model1:                                                        
│         path: models/medium_model1                                            
│         model_path: models/medium_model1/model                                
│         input_data_path: data/processed/simulated_medium_processed.h5ad       
│         trained_data_path: models/medium_model1/trained.h5ad                  
│         pyrovelocity_data_path: models/medium_model1/pyrovelocity.pkl         
│         metrics_path: models/medium_model1/metrics.json                       
│         run_info_path: models/medium_model1/run_info.json                     
│         vector_field_parameters:                                              
│           basis: umap                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto_t0_constraint                                      
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: leiden                                                  
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 4000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: false                                                       
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/medium_model1/loss_plot.png                  
│       simulate_model2:                                                        
│         path: models/medium_model2                                            
│         model_path: models/medium_model2/model                                
│         input_data_path: data/processed/simulated_medium_processed.h5ad       
│         trained_data_path: models/medium_model2/trained.h5ad                  
│         pyrovelocity_data_path: models/medium_model2/pyrovelocity.pkl         
│         metrics_path: models/medium_model2/metrics.json                       
│         run_info_path: models/medium_model2/run_info.json                     
│         vector_field_parameters:                                              
│           basis: umap                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: leiden                                                  
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 4000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/medium_model2/loss_plot.png                  
│       pancreas_model1:                                                        
│         path: models/pancreas_model1                                          
│         model_path: models/pancreas_model1/model                              
│         input_data_path: data/processed/pancreas_processed.h5ad               
│         trained_data_path: models/pancreas_model1/trained.h5ad                
│         pyrovelocity_data_path: models/pancreas_model1/pyrovelocity.pkl       
│         metrics_path: models/pancreas_model1/metrics.json                     
│         run_info_path: models/pancreas_model1/run_info.json                   
│         vector_field_parameters:                                              
│           basis: umap                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto_t0_constraint                                      
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: clusters                                                
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 2000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: false                                                       
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/pancreas_model1/loss_plot.png                
│       pancreas_model2:                                                        
│         path: models/pancreas_model2                                          
│         model_path: models/pancreas_model2/model                              
│         input_data_path: data/processed/pancreas_processed.h5ad               
│         trained_data_path: models/pancreas_model2/trained.h5ad                
│         pyrovelocity_data_path: models/pancreas_model2/pyrovelocity.pkl       
│         metrics_path: models/pancreas_model2/metrics.json                     
│         run_info_path: models/pancreas_model2/run_info.json                   
│         vector_field_parameters:                                              
│           basis: umap                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: clusters                                                
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 2000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/pancreas_model2/loss_plot.png                
│       pbmc68k_model1:                                                         
│         path: models/pbmc68k_model1                                           
│         model_path: models/pbmc68k_model1/model                               
│         input_data_path: data/processed/pbmc68k_processed.h5ad                
│         trained_data_path: models/pbmc68k_model1/trained.h5ad                 
│         pyrovelocity_data_path: models/pbmc68k_model1/pyrovelocity.pkl        
│         metrics_path: models/pbmc68k_model1/metrics.json                      
│         run_info_path: models/pbmc68k_model1/run_info.json                    
│         vector_field_parameters:                                              
│           basis: tsne                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto_t0_constraint                                      
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: celltype                                                
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 2000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: false                                                       
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/pbmc68k_model1/loss_plot.png                 
│       pbmc68k_model2:                                                         
│         path: models/pbmc68k_model2                                           
│         model_path: models/pbmc68k_model2/model                               
│         input_data_path: data/processed/pbmc68k_processed.h5ad                
│         trained_data_path: models/pbmc68k_model2/trained.h5ad                 
│         pyrovelocity_data_path: models/pbmc68k_model2/pyrovelocity.pkl        
│         metrics_path: models/pbmc68k_model2/metrics.json                      
│         run_info_path: models/pbmc68k_model2/run_info.json                    
│         vector_field_parameters:                                              
│           basis: tsne                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: celltype                                                
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 2000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/pbmc68k_model2/loss_plot.png                 
│       pons_model1:                                                            
│         path: models/pons_model1                                              
│         model_path: models/pons_model1/model                                  
│         input_data_path: data/processed/pons_processed.h5ad                   
│         trained_data_path: models/pons_model1/trained.h5ad                    
│         pyrovelocity_data_path: models/pons_model1/pyrovelocity.pkl           
│         metrics_path: models/pons_model1/metrics.json                         
│         run_info_path: models/pons_model1/run_info.json                       
│         vector_field_parameters:                                              
│           basis: umap                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto_t0_constraint                                      
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: celltype                                                
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 2000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: false                                                       
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/pons_model1/loss_plot.png                    
│       pons_model2:                                                            
│         path: models/pons_model2                                              
│         model_path: models/pons_model2/model                                  
│         input_data_path: data/processed/pons_processed.h5ad                   
│         trained_data_path: models/pons_model2/trained.h5ad                    
│         pyrovelocity_data_path: models/pons_model2/pyrovelocity.pkl           
│         metrics_path: models/pons_model2/metrics.json                         
│         run_info_path: models/pons_model2/run_info.json                       
│         vector_field_parameters:                                              
│           basis: umap                                                         
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: false                                                    
│           batch_size: -1                                                      
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: celltype                                                
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 2000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/pons_model2/loss_plot.png                    
│       larry_model2:                                                           
│         path: models/larry_model2                                             
│         model_path: models/larry_model2/model                                 
│         input_data_path: data/processed/larry_processed.h5ad                  
│         trained_data_path: models/larry_model2/trained.h5ad                   
│         pyrovelocity_data_path: models/larry_model2/pyrovelocity.pkl          
│         metrics_path: models/larry_model2/metrics.json                        
│         run_info_path: models/larry_model2/run_info.json                      
│         vector_field_parameters:                                              
│           basis: emb                                                          
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: true                                                     
│           batch_size: 4000                                                    
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: state_info                                              
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 1000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/larry_model2/loss_plot.png                   
│       larry_mono_model2:                                                      
│         path: models/larry_mono_model2                                        
│         model_path: models/larry_mono_model2/model                            
│         input_data_path: data/processed/larry_mono_processed.h5ad             
│         trained_data_path: models/larry_mono_model2/trained.h5ad              
│         pyrovelocity_data_path: models/larry_mono_model2/pyrovelocity.pkl     
│         metrics_path: models/larry_mono_model2/metrics.json                   
│         run_info_path: models/larry_mono_model2/run_info.json                 
│         vector_field_parameters:                                              
│           basis: emb                                                          
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: true                                                     
│           batch_size: 4000                                                    
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: state_info                                              
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 1000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/larry_mono_model2/loss_plot.png              
│       larry_neu_model2:                                                       
│         path: models/larry_neu_model2                                         
│         model_path: models/larry_neu_model2/model                             
│         input_data_path: data/processed/larry_neu_processed.h5ad              
│         trained_data_path: models/larry_neu_model2/trained.h5ad               
│         pyrovelocity_data_path: models/larry_neu_model2/pyrovelocity.pkl      
│         metrics_path: models/larry_neu_model2/metrics.json                    
│         run_info_path: models/larry_neu_model2/run_info.json                  
│         vector_field_parameters:                                              
│           basis: emb                                                          
│         training_parameters:                                                  
│           _target_: pyrovelocity.api.train_model                              
│           _partial_: true                                                     
│           guide_type: auto                                                    
│           model_type: auto                                                    
│           svi_train: true                                                     
│           batch_size: 4000                                                    
│           train_size: 1.0                                                     
│           use_gpu: 0                                                          
│           likelihood: Poisson                                                 
│           num_samples: 30                                                     
│           log_every: 100                                                      
│           cell_state: state_info                                              
│           patient_improve: 0.0001                                             
│           patient_init: 45                                                    
│           seed: 99                                                            
│           lr: 0.01                                                            
│           max_epochs: 1000                                                    
│           include_prior: true                                                 
│           library_size: true                                                  
│           offset: true                                                        
│           input_type: raw                                                     
│           cell_specific_kinetics: null                                        
│           kinetics_num: 2                                                     
│           loss_plot_path: models/larry_neu_model2/loss_plot.png               
│                                                                               
└── reports
    └── model_summary:                                                          
          summarize:                                                            
          - simulate_model1                                                     
          - simulate_model2                                                     
          - pancreas_model1                                                     
          - pancreas_model2                                                     
          - pbmc68k_model1                                                      
          - pbmc68k_model2                                                      
          - pons_model1                                                         
          - pons_model2                                                         
          simulate_model1:                                                      
            path: reports/medium_model1                                         
            dataframe_path: data/processed/medium_model1_dataframe.pkl.zst      
            shared_time_plot: reports/medium_model1/shared_time.pdf             
            volcano_plot: reports/medium_model1/volcano.pdf                     
            rainbow_plot: reports/medium_model1/rainbow.pdf                     
            uncertainty_param_plot: reports/medium_model1/param_uncertainties.pd
            vector_field_plot: reports/medium_model1/vector_field.pdf           
            biomarker_selection_plot: reports/medium_model1/markers_selection_sc
            biomarker_phaseportrait_plot: reports/medium_model1/markers_phasepor
          simulate_model2:                                                      
            path: reports/medium_model2                                         
            dataframe_path: data/processed/medium_model2_dataframe.pkl.zst      
            shared_time_plot: reports/medium_model2/shared_time.pdf             
            volcano_plot: reports/medium_model2/volcano.pdf                     
            rainbow_plot: reports/medium_model2/rainbow.pdf                     
            uncertainty_param_plot: reports/medium_model2/param_uncertainties.pd
            vector_field_plot: reports/medium_model2/vector_field.pdf           
            biomarker_selection_plot: reports/medium_model2/markers_selection_sc
            biomarker_phaseportrait_plot: reports/medium_model2/markers_phasepor
          pancreas_model1:                                                      
            path: reports/pancreas_model1                                       
            dataframe_path: data/processed/pancreas_model1_dataframe.pkl.zst    
            shared_time_plot: reports/pancreas_model1/shared_time.pdf           
            volcano_plot: reports/pancreas_model1/volcano.pdf                   
            rainbow_plot: reports/pancreas_model1/rainbow.pdf                   
            uncertainty_param_plot: reports/pancreas_model1/param_uncertainties.
            vector_field_plot: reports/pancreas_model1/vector_field.pdf         
            biomarker_selection_plot: reports/pancreas_model1/markers_selection_
            biomarker_phaseportrait_plot: reports/pancreas_model1/markers_phasep
          pancreas_model2:                                                      
            path: reports/pancreas_model2                                       
            dataframe_path: data/processed/pancreas_model2_dataframe.pkl.zst    
            shared_time_plot: reports/pancreas_model2/shared_time.pdf           
            volcano_plot: reports/pancreas_model2/volcano.pdf                   
            rainbow_plot: reports/pancreas_model2/rainbow.pdf                   
            uncertainty_param_plot: reports/pancreas_model2/param_uncertainties.
            vector_field_plot: reports/pancreas_model2/vector_field.pdf         
            biomarker_selection_plot: reports/pancreas_model2/markers_selection_
            biomarker_phaseportrait_plot: reports/pancreas_model2/markers_phasep
          pbmc68k_model1:                                                       
            path: reports/pbmc68k_model1                                        
            dataframe_path: data/processed/pbmc68k_model1_dataframe.pkl.zst     
            shared_time_plot: reports/pbmc68k_model1/shared_time.pdf            
            volcano_plot: reports/pbmc68k_model1/volcano.pdf                    
            rainbow_plot: reports/pbmc68k_model1/rainbow.pdf                    
            uncertainty_param_plot: reports/pbmc68k_model1/param_uncertainties.p
            vector_field_plot: reports/pbmc68k_model1/vector_field.pdf          
            biomarker_selection_plot: reports/pbmc68k_model1/markers_selection_s
            biomarker_phaseportrait_plot: reports/pbmc68k_model1/markers_phasepo
          pbmc68k_model2:                                                       
            path: reports/pbmc68k_model2                                        
            dataframe_path: data/processed/pbmc68k_model2_dataframe.pkl.zst     
            shared_time_plot: reports/pbmc68k_model2/shared_time.pdf            
            volcano_plot: reports/pbmc68k_model2/volcano.pdf                    
            rainbow_plot: reports/pbmc68k_model2/rainbow.pdf                    
            uncertainty_param_plot: reports/pbmc68k_model2/param_uncertainties.p
            vector_field_plot: reports/pbmc68k_model2/vector_field.pdf          
            biomarker_selection_plot: reports/pbmc68k_model2/markers_selection_s
            biomarker_phaseportrait_plot: reports/pbmc68k_model2/markers_phasepo
          pons_model1:                                                          
            path: reports/pons_model1                                           
            dataframe_path: data/processed/pons_model1_dataframe.pkl.zst        
            shared_time_plot: reports/pons_model1/shared_time.pdf               
            volcano_plot: reports/pons_model1/volcano.pdf                       
            rainbow_plot: reports/pons_model1/rainbow.pdf                       
            uncertainty_param_plot: reports/pons_model1/param_uncertainties.pdf 
            vector_field_plot: reports/pons_model1/vector_field.pdf             
            biomarker_selection_plot: reports/pons_model1/markers_selection_scat
            biomarker_phaseportrait_plot: reports/pons_model1/markers_phaseportr
          pons_model2:                                                          
            path: reports/pons_model2                                           
            dataframe_path: data/processed/pons_model2_dataframe.pkl.zst        
            shared_time_plot: reports/pons_model2/shared_time.pdf               
            volcano_plot: reports/pons_model2/volcano.pdf                       
            rainbow_plot: reports/pons_model2/rainbow.pdf                       
            uncertainty_param_plot: reports/pons_model2/param_uncertainties.pdf 
            vector_field_plot: reports/pons_model2/vector_field.pdf             
            biomarker_selection_plot: reports/pons_model2/markers_selection_scat
            biomarker_phaseportrait_plot: reports/pons_model2/markers_phaseportr
        figure2:                                                                
          tag: fig2                                                             
          path: reports/fig2                                                    
          tif_path: reports/fig2/fig2_raw_gene_selection_model1.tif             
          svg_path: reports/fig2/fig2_raw_gene_selection_model1.svg             
          biomarker_selection_path: reports/fig2/fig2_markers_selection_scatterp
          biomarker_phaseportrait_path: reports/fig2/fig2_markers_phaseportrait.
          uncertainty_param_plot_path: reports/fig2/fig2_param_uncertainties.pdf
          uncertainty_magnitude_plot_path: reports/fig2/fig2_magnitude_uncertain
          pancreas_model1:                                                      
            shared_time_plot: reports/fig2/fig2_pancreas_shared_time.pdf        
            volcano_plot: reports/fig2/fig2_pancreas_volcano.pdf                
            rainbow_plot: reports/fig2/fig2_pancreas_rainbow.pdf                
            vector_field_plot: reports/fig2/fig2_pancreas_vector_field.pdf      
        figureS3:                                                               
          tag: figS3                                                            
          path: reports/figS3                                                   
          tif_path: reports/figS3/figS3_raw_gene_selection_model2.tif           
          svg_path: reports/figS3/figS3_raw_gene_selection_model2.svg           
                                                                                
{'T': AnnData object with n_obs × n_vars = 2000 × 49302
    obs: 'Accession', 'Chromosome', 'End', 'Start', 'Strand', 'gene_count_corr', 'means', 'dispersions', 'dispersions_norm', 'highly_variable', 'fit_r2', 'fit_alpha', 'fit_beta', 'fit_gamma', 'fit_t_', 'fit_scaling', 'fit_std_u', 'fit_std_s', 'fit_likelihood', 'fit_u0', 'fit_s0', 'fit_pval_steady', 'fit_steady_u', 'fit_steady_s', 'fit_variance', 'fit_alignment_scaling', 'velocity_genes'
    var: 'Library', 'Cell barcode', 'time_info', 'Starting population', 'state_info', 'Well', 'SPRING-x', 'SPRING-y', 'u_lib_size_raw', 's_lib_size_raw', 'initial_size_unspliced', 'initial_size_spliced', 'initial_size', 'n_counts', 'leiden', 'velocity_self_transition', 'root_cells', 'end_points', 'velocity_pseudotime', 'latent_time'
    uns: 'data_des', 'leiden', 'neighbors', 'pca', 'recover_dynamics', 'umap', 'velocity_graph', 'velocity_graph_neg', 'velocity_params'
    obsm: 'PCs', 'loss'
    varm: 'X_clone', 'X_emb', 'X_pca', 'X_umap', 'velocity_umap'
    layers: 'Ms', 'Mu', 'ambiguous', 'fit_t', 'fit_tau', 'fit_tau_', 'matrix', 'raw_spliced', 'raw_unspliced', 'spliced', 'unspliced', 'velocity', 'velocity_u'
    varp: 'connectivities', 'distances',
 'X': <49302x2000 sparse matrix of type '<class 'numpy.float32'>'
	with 12027122 stored elements in Compressed Sparse Row format>,
 'file': Backing file manager: no file is set.,
 'filename': None,
 'is_view': False,
 'isbacked': False,
 'isview': False,
 'layers': Layers with keys: Ms, Mu, ambiguous, fit_t, fit_tau, fit_tau_, matrix, raw_spliced, raw_unspliced, spliced, unspliced, velocity, velocity_u,
 'n_obs': 49302,
 'n_vars': 2000,
 'obs':                                 Library  ... latent_time
d6_2_2:GCGTGCAAAGAAGTTA          d6_2_2  ...    0.535396
d6_2_2:AAGGGACCCTCGATGC          d6_2_2  ...    0.380577
d6_2_2:CGTACCGAAGCGCCTT          d6_2_2  ...    0.156036
d6_2_2:CCGTAGCTAGGCAGTT          d6_2_2  ...    0.518251
d6_2_2:TAGGCTTTCGTGGATA          d6_2_2  ...    0.346481
...                                 ...  ...         ...
LSK_d6_1_3:AGGCGTTTCCTATTCA  LSK_d6_1_3  ...    0.500818
LSK_d6_1_3:CGTGCAACTGGCCTGT  LSK_d6_1_3  ...    0.480362
LSK_d6_1_3:CCCTTGCAAGTGAAAG  LSK_d6_1_3  ...    0.298480
LSK_d6_1_3:TCCGCTGTGACAGATA  LSK_d6_1_3  ...    0.235889
LSK_d6_1_3:AGTCACAATGTGTCCT  LSK_d6_1_3  ...    0.429079

[49302 rows x 20 columns],
 'obs_names': Index(['d6_2_2:GCGTGCAAAGAAGTTA', 'd6_2_2:AAGGGACCCTCGATGC',
       'd6_2_2:CGTACCGAAGCGCCTT', 'd6_2_2:CCGTAGCTAGGCAGTT',
       'd6_2_2:TAGGCTTTCGTGGATA', 'd6_2_2:AAGTCGGGGGCCTAAG',
       'd6_2_2:ATCCTAGTAATCGGGT', 'd6_2_2:AGGGACTGATATACCT',
       'd6_2_2:AGACGAGGGTCTCTCT', 'd6_2_2:GTCAGACCAAGATTGT',
       ...
       'LSK_d6_1_3:CTAGACTAGAAGCACT', 'LSK_d6_1_3:GATTGGGATCTCAACC',
       'LSK_d6_1_3:GATTACTTGATTTACC', 'LSK_d6_1_3:CACAACCTCTACTTGT',
       'LSK_d6_1_3:CTGTGACCTGCTATTT', 'LSK_d6_1_3:AGGCGTTTCCTATTCA',
       'LSK_d6_1_3:CGTGCAACTGGCCTGT', 'LSK_d6_1_3:CCCTTGCAAGTGAAAG',
       'LSK_d6_1_3:TCCGCTGTGACAGATA', 'LSK_d6_1_3:AGTCACAATGTGTCCT'],
      dtype='object', length=49302),
 'obsm': AxisArrays with keys: X_clone, X_emb, X_pca, X_umap, velocity_umap,
 'obsp': PairwiseArrays with keys: connectivities, distances,
 'raw': None,
 'shape': (49302, 2000),
 'uns': OverloadedDict, wrapping:
	{'data_des': array(['LARRY'], dtype=object), 'leiden': {'params': {'n_iterations': -1, 'random_state': 0, 'resolution': 1}}, 'neighbors': {'connectivities_key': 'connectivities', 'distances_key': 'distances', 'indices': array([[    0,  5699, 43067, ...,  1868, 44346,  6447],
       [    1, 27427, 44423, ...,  6184, 42656, 26834],
       [    2, 10704,  1430, ...,  1464,   449,  1473],
       ...,
       [49299, 27004, 47903, ..., 42653, 43026, 23384],
       [49300,  2487, 29442, ..., 42761,  3490, 23367],
       [49301, 24353, 36845, ..., 32281, 33482, 35318]], dtype=int32), 'params': {'method': 'umap', 'metric': 'euclidean', 'n_neighbors': 30, 'n_pcs': 30, 'use_rep': 'X_pca'}}, 'pca': {'params': {'use_highly_variable': True, 'zero_center': True}, 'variance': array([16.366768  , 12.720622  ,  9.492328  ,  3.9908793 ,  1.8691813 ,
        1.7604183 ,  1.6556491 ,  1.3595381 ,  1.0997918 ,  0.9233939 ,
        0.8525895 ,  0.74440175,  0.6884651 ,  0.6447264 ,  0.5600774 ,
        0.5192873 ,  0.5124592 ,  0.48382255,  0.46072283,  0.41604787,
        0.40567023,  0.4014533 ,  0.3968364 ,  0.3830292 ,  0.37394065,
        0.36092463,  0.35199717,  0.34572285,  0.34309807,  0.3291231 ],
      dtype=float32), 'variance_ratio': array([0.098325  , 0.07642041, 0.05702611, 0.02397561, 0.01122929,
       0.01057589, 0.00994648, 0.00816756, 0.00660711, 0.00554738,
       0.00512202, 0.00447207, 0.00413602, 0.00387326, 0.00336472,
       0.00311967, 0.00307865, 0.00290661, 0.00276784, 0.00249945,
       0.0024371 , 0.00241177, 0.00238403, 0.00230109, 0.00224649,
       0.00216829, 0.00211466, 0.00207696, 0.0020612 , 0.00197724],
      dtype=float32)}, 'recover_dynamics': {'fit_connected_states': True, 'use_raw': False}, 'umap': {'params': {'a': 0.583030019901822, 'b': 1.3341669931033755}}, 'velocity_graph': <49302x49302 sparse matrix of type '<class 'numpy.float32'>'
	with 10200614 stored elements in Compressed Sparse Row format>, 'velocity_graph_neg': <49302x49302 sparse matrix of type '<class 'numpy.float32'>'
	with 7539327 stored elements in Compressed Sparse Row format>, 'velocity_params': {'embeddings': array(['umap'], dtype=object), 'fit_offset': False, 'mode': 'dynamical', 'mode_neighbors': 'distances', 'n_recurse_neighbors': 2, 'perc': array([ 5, 95])}}
With overloaded keys:
	['neighbors'].,
 'var':                    Accession Chromosome  ...  fit_alignment_scaling  velocity_genes
Eya1                    Eya1          1  ...                    NaN           False
Smap1                  Smap1          1  ...               2.696528            True
Neurl3                Neurl3          1  ...               1.561064            True
Actr1b                Actr1b          1  ...                    NaN           False
2010300C02Rik  2010300C02Rik          1  ...               1.403672           False
...                      ...        ...  ...                    ...             ...
Fam120c              Fam120c          X  ...                    NaN           False
Phf8                    Phf8          X  ...                    NaN           False
Iqsec2                Iqsec2          X  ...                    NaN           False
Ctps2                  Ctps2          X  ...                    NaN           False
Arhgap6              Arhgap6          X  ...               1.833858            True

[2000 rows x 27 columns],
 'var_names': Index(['Eya1', 'Smap1', 'Neurl3', 'Actr1b', '2010300C02Rik', 'Aff3', 'Tbc1d8',
       'Rnf149', 'Slc40a1', 'Nabp1',
       ...
       'Nhsl2', 'Tlr13', 'Gprasp1', 'D330045A20Rik', 'Rnf128', 'Fam120c',
       'Phf8', 'Iqsec2', 'Ctps2', 'Arhgap6'],
      dtype='object', length=2000),
 'varm': AxisArrays with keys: PCs, loss,
 'varp': PairwiseArrays with keys: }
0
Active run_id: e118a75c17dc4881a67c084b3af7c53c
[2023-04-26 13:26:06,326][jax._src.xla_bridge][INFO] - Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Interpreter CUDA Host
[2023-04-26 13:26:06,327][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
[2023-04-26 13:26:06,327][jax._src.xla_bridge][INFO] - Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
[2023-04-26 13:26:06,374][pyrovelocity._velocity][INFO] - n_U: 2000
n_cells: 49302
n_vars: 2000

-----------
auto
auto
[2023-04-26 13:26:06,417][pyrovelocity._velocity][INFO] - The model has been initialized
train_faster_with_batch
[2023-04-26 13:26:08,433][root][INFO] - Guessed max_plate_nesting = 2
