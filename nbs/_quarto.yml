project:
  type: website
  output-dir: _site
  # type: docusaurus
  # output-dir: ../mdx
  # type: default
  # output-dir: ../md
  preview:
    port: 7562

format:
  # docusaurus-md:
  #   html-math-method: mathjax
  # gfm:
  #   html-math-method:
  #     method: mathjax
  html:
    highlight-style: gruvbox
    theme:
      dark: [darkly, cdark.scss]
      light: [cosmo, clight.scss]
    include-in-header: include.html
    css: styles.css
    grid:
      sidebar-width: 300px
      body-width: 900px
      margin-width: 300px
      gutter-width: 1.5rem
    toc: true

execute:
  warning: false
  error: false
  # freeze: true

filters:
  - interlinks

interlinks:
  fast: true
  sources:
    python:
      url: https://docs.python.org/3/
    anndata:
      url: https://anndata.readthedocs.io/en/latest/
    beartype:
      url: https://beartype.readthedocs.io/en/latest/
    diffrax:
      url: https://docs.kidger.site/diffrax/
    jaxtyping:
      url: https://docs.kidger.site/jaxtyping/
    matplotlib:
      url: https://matplotlib.org/stable/
    numpy:
      url: https://numpy.org/doc/stable/
    numpyro:
      url: https://num.pyro.ai/en/latest/
    pyro:
      url: https://docs.pyro.ai/en/stable/
    scanpy:
      url: https://scanpy.readthedocs.io/en/stable/
    scvelo:
      url: https://scvelo.readthedocs.io/en/stable/
    scvi:
      url: https://docs.scvi-tools.org/en/stable/
    torch:
      url: https://pytorch.org/docs/stable/

website:
  title: "Pyro&thinsp;-Velocity"
  site-url: https://pinellolab.github.io/pyrovelocity
  description: "A probabilistic framework for multi-modal transcriptomics"
  favicon: _static/logo/favicon.ico
  back-to-top-navigation: false
  page-navigation: true

  page-footer:
    border: false
    left: ""
    right:
      - icon: github
        href: https://github.com/pinellolab/pyrovelocity

  search:
    type: overlay

  navbar:
    background: primary
    logo: _static/logo.png
    tools:
      - icon: github
        url: https://github.com/pinellolab/pyrovelocity
        # menu:
        #   - text: "Repository"
        #     url: https://github.com/pinellolab/pyrovelocity
        #   - text: "Start a discussion"
        #     url: https://github.com/pinellolab/pyrovelocity/discussions/new/choose
        #   - text: "Create an issue"
        #     url: https://github.com/pinellolab/pyrovelocity/issues/new/choose
    left:
      - sidebar:documentation
      - sidebar:tutorials
      - sidebar:guides
      - sidebar:concepts
      - href: reference
        text: Reference
      # - sidebar:reference
      - sidebar:development
      - sidebar:about

  sidebar:
    - id: ""
    - id: concepts
      title: "Concepts"
      style: "floating"
      contents:
        - text: "Overview"
          href: concepts/overview.qmd
        - text: "Multi-modal transcriptomics"
          href: concepts/multimodaltranscriptomics.qmd
        - text: "Dynamical systems theory"
          href: concepts/dynamicalsystems.qmd
        - text: "Probabilistic inference"
          href: concepts/probabilisticinference.qmd
        - text: "Models of gene expression"
          href: concepts/geneexpression.qmd
        - text: "Inference in dynamical systems"
          href: concepts/inferenceindynamicalsystems/index.qmd
    - id: guides
      title: "Guides"
      style: "floating"
      contents:
        - text: "Installation"
          href: guides/installation.qmd
        - text: "Interactive review"
          href: guides/interactive/interactive.qmd
        - text: "Data Access"
          href: guides/data.qmd
        - text: "Preprocessing"
          href: guides/preprocessing/preprocessing.qmd
        - text: "Inference"
          href: guides/inference.qmd
        - text: "Modular Components"
          href: guides/model_components.qmd
        - text: "Postprocessing"
          href: guides/postprocessing.qmd
        - text: "Model summary"
          href: guides/summarization.qmd
    - id: tutorials
      title: "Tutorials"
      style: "floating"
      contents:
        - section: "Introduction"
          contents:
            - text: "Getting Started"
              href: tutorials/introduction.qmd
            - text: "Modular Implementation"
              href: tutorials/models.qmd
            - text: "Usage example"
              href: templates/user_example/user_example.qmd
            - text: "v0.1.3 Getting Started"
              href: tutorials/introduction_v013.qmd
        - section: "Preprocessing"
          contents:
            - text: "Pancreatic endocrinogenesis"
              href: tutorials/pancreas/preprocessing/pancreas.qmd
            - text: "Pons development"
              href: tutorials/pons.qmd
            - section: "Blood physiology"
              contents:
                - text: "68k PBMCs"
                  href: tutorials/pbmc68k.qmd
                - text: "10k PBMCs"
                  href: tutorials/pbmc10k.qmd
                - text: "5k PBMCs"
                  href: tutorials/pbmc5k.qmd
            - text: "Mouse hematopoiesis"
              href: tutorials/mousehematopoiesis.qmd
            - text: "Lineage tracing"
              href: tutorials/lineagetracing.qmd
        - section: "Results"
          contents:
            - text: "Pancreatic endocrinogenesis"
              href: tutorials/pancreas/results/pancreas.qmd
    - id: documentation
      title: "Contents"
      style: "floating"
      contents:
        - section: "Tutorials"
          contents:
            - section: "Introduction"
              contents:
                - text: "Getting Started"
                  href: tutorials/introduction.qmd
                - text: "Modular Implementation"
                  href: tutorials/models.qmd
                - text: "Usage example"
                  href: templates/user_example/user_example.qmd
                - text: "v0.1.3 Getting Started"
                  href: tutorials/introduction_v013.qmd
            - section: "Preprocessing"
              contents:
                - text: "Pancreatic endocrinogenesis"
                  href: tutorials/pancreas/preprocessing/pancreas.qmd
                - text: "Pons development"
                  href: tutorials/pons.qmd
                - section: "Blood physiology"
                  contents:
                    - text: "68k PBMCs"
                      href: tutorials/pbmc68k.qmd
                    - text: "10k PBMCs"
                      href: tutorials/pbmc10k.qmd
                    - text: "5k PBMCs"
                      href: tutorials/pbmc5k.qmd
                - text: "Mouse hematopoiesis"
                  href: tutorials/mousehematopoiesis.qmd
                - text: "Lineage tracing"
                  href: tutorials/lineagetracing.qmd
            - section: "Results"
              contents:
                - text: "Pancreatic endocrinogenesis"
                  href: tutorials/pancreas/results/pancreas.qmd
        - section: "Guides"
          contents:
            - text: "Installation"
              href: guides/installation.qmd
            - text: "Interactive review"
              href: guides/interactive/interactive.qmd
            - text: "Data Access"
              href: guides/data.qmd
            - text: "Preprocessing"
              href: guides/preprocessing/preprocessing.qmd
            - text: "Inference"
              href: guides/inference.qmd
            - text: "Modular Components"
              href: guides/model_components.qmd
            - text: "Postprocessing"
              href: guides/postprocessing.qmd
            - text: "Model summary"
              href: guides/summarization.qmd
        - section: "Concepts"
          contents:
            - text: "Overview"
              href: concepts/overview.qmd
            - text: "Multi-modal transcriptomics"
              href: concepts/multimodaltranscriptomics.qmd
            - text: "Dynamical systems theory"
              href: concepts/dynamicalsystems.qmd
            - text: "Probabilistic inference"
              href: concepts/probabilisticinference.qmd
            - text: "Models of gene expression"
              href: concepts/geneexpression.qmd
            - text: "Inference in dynamical systems"
              href: concepts/inferenceindynamicalsystems/index.qmd
        - section: "Development"
          contents:
            - text: "Overview"
              href: development/index.qmd
            - text: "Context"
              href: development/context.qmd
            - text: "Requirements"
              href: development/requirements.qmd
            - text: "Architecture"
              href: development/architecture.qmd
            - text: "Testing"
              href: development/testing.qmd
    - id: development
      title: "Development"
      style: "floating"
      contents:
        - text: "Overview"
          href: development/index.qmd
        - text: "Context"
          href: development/context.qmd
        - text: "Requirements"
          href: development/requirements.qmd
        - text: "Architecture"
          href: development/architecture.qmd
        - text: "Testing"
          href: development/testing.qmd
    - id: about
      title: "About"
      style: "floating"
      contents:
        - text: "Changelog"
          href: about/changelog.md
        - text: "Contributing"
          href: about/contributing.qmd
        - text: "Credits"
          href: about/credits.qmd

quartodoc:
  dir: reference
  parser: google
  package: pyrovelocity
  title: Reference
  sidebar: reference/_sidbar.yml
  render_interlinks: true
  options:
    signature_name: full
  sections:
    - title: Models
    - subtitle: Legacy Models
      desc: |
        The legacy implementation of PyroVelocity.
      contents:
        - name: models.PyroVelocity
          children: separate
          members:
            - __init__
            - train
            - setup_anndata
            - generate_posterior_samples
            - compute_statistics_from_posterior_samples
            - save_pyrovelocity_data
            - save_model
            - load_model
    - subtitle: Modular Models
      desc: |
        The modular implementation provides a flexible, composable architecture for
        RNA velocity modeling based on Protocol-First design.
      contents:
        - models.PyroVelocityModel
        - models.ModelState
        - models.create_standard_model
        - models.create_model
        - models.modular.create_model_from_config
    - subtitle: Component Interfaces
      desc: |
        Protocol interfaces that define the contracts for component implementations.
      contents:
        - models.DynamicsModel
        - models.PriorModel
        - models.LikelihoodModel
        - models.ObservationModel
        - models.InferenceGuide
    - subtitle: Component Implementations
      desc: |
        Specialized components that implement the core functionality of the modular architecture.
      contents:
        - models.StandardDynamicsModel
        - models.LegacyDynamicsModel
        - models.LogNormalPriorModel
        - models.PoissonLikelihoodModel
        - models.LegacyLikelihoodModel
        - models.StandardObservationModel
        - models.AutoGuideFactory
        - models.LegacyAutoGuideFactory
    - subtitle: Model Comparison and Selection
      desc: |
        Tools for Bayesian model comparison, criticism, and selection.
      contents:
        - models.BayesianModelComparison
        - models.ComparisonResult
        - models.ModelEnsemble
        - models.ModelSelection
        - models.SelectionCriterion
        - models.SelectionResult
        - models.select_best_model
    - title: Tasks
      desc: |
        Task-oriented utilities for common workflows
      contents:
        - tasks.data
        - tasks.preprocess
        - tasks.train
        - tasks.evaluate
        - tasks.postprocess
        - tasks.summarize
    - title: Plots
      desc: |
        Plotting functions and utilities
      contents:
        - plots.cluster_violin_plots
        - plots.extrapolate_prediction_sample_predictive
        - plots.get_posterior_sample_angle_uncertainty
        - plots.plot_gene_ranking
        - plots.plot_parameter_posterior_distributions
        - plots.plot_posterior_time
        - plots.plot_shared_time_uncertainty
        - plots.plot_state_uncertainty
        - plots.plot_t0_selection
        - plots.posterior_curve
        - plots.rainbowplot
        - plots.plot_vector_field_summary
        - plots.plot_gene_selection_summary
        - plots.plot_model_comparison
        - plots.plot_waic_loo_comparison
        - plots.plot_deterministic_simulation_phase_portrait
        - plots.plot_deterministic_simulation_trajectories
    - title: Analysis
      desc: |
        Analysis utilities for RNA velocity data
      contents:
        - analysis.align_trajectory_diff
        - analysis.get_clone_trajectory
        - analysis.cytotrace
        - analysis.transcriptome_properties
    - title: IO
      desc: |
        Input/output utilities
      contents:
        - io.CompressedPickle
        - io.datasets
    - subtitle: JAX Implementation
      desc: |
        The JAX/NumPyro implementation of PyroVelocity.
      contents:
        - models.jax.velocity_model
        - models.jax.create_standard_model
        - models.jax.prepare_anndata
        - models.jax.run_inference
    - subtitle: Experimental Models
      desc: |
        Experimental implementations and utilities for research and development.
      contents:
        - models.deterministic_transcription_splicing_probabilistic_model
        - models.solve_transcription_splicing_model
        - models.solve_transcription_splicing_model_analytical
